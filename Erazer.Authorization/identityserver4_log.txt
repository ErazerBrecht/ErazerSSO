2017-12-09 17:53:33.248 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-09 17:53:33.334 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-09 17:53:33.340 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-09 17:53:33.341 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-09 17:53:33.341 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-09 17:53:33.342 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-09 17:53:44.223 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-09 17:53:44.231 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-09 17:53:44.232 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-09 17:53:44.237 +01:00 [DBG] Start discovery request
2017-12-10 12:42:53.552 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 12:42:53.660 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 12:42:53.665 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 12:42:53.665 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 12:42:53.666 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 12:42:53.666 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 12:43:18.290 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 12:43:18.347 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 12:43:18.351 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 12:43:18.351 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 12:43:18.351 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 12:43:18.351 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 12:43:54.442 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 12:43:54.450 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 12:43:54.450 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 12:43:54.455 +01:00 [DBG] Start discovery request
2017-12-10 12:43:54.732 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 12:43:54.733 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 12:43:54.733 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 12:43:54.738 +01:00 [DBG] Start key discovery request
2017-12-10 12:43:54.855 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 12:43:54.861 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 12:43:54.861 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 12:43:54.866 +01:00 [DBG] Start authorize request
2017-12-10 12:43:54.881 +01:00 [DBG] No user present in authorize request
2017-12-10 12:43:54.886 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 12:43:54.911 +01:00 [ERR] Invalid redirect_uri: http://localhost:24705/signin-oidc
{
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:24705/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:24705/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485030348048505.N2QxMmZjMzUtZWExNC00YjNjLWE1ZTUtNmYxMmVmZjE0NWZjMTJmNTkyZmUtYjViYi00NjhkLTgyNWItZTY2MDVjMGQ1MTBj",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcNpLhjGz3wpp8iuGxxXNiovQ4fxX433Inwps4T-2vqcmqrmlRhQc0XZ0SEATu8_b3yy5iiD9Te1NPk8dieUhdrgHZz3y8pQAy7InjOS5jHLZ-NCbZl6lfgekqgSj_hGTDi2FtcHtuVMEb54YoP-BMCrCZ0x8Vw8w-PeGUE08WNyNpMthNjwV_ugYoiMZj_eDy8Ivc9MVouBpzMnuG8z85kOxnsgKS2xiHArcjuh9wH131YQ4Yanlerd5bhSKDpT-pkxgAA1awbFWsyY7j8nQXF_SN4u38HlAVc1MQtixPWS2EjGTj7ic96jXTLQgbeVkU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 12:43:54.916 +01:00 [ERR] Request validation failed
2017-12-10 12:43:54.918 +01:00 [INF] {
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:24705/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:24705/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485030348048505.N2QxMmZjMzUtZWExNC00YjNjLWE1ZTUtNmYxMmVmZjE0NWZjMTJmNTkyZmUtYjViYi00NjhkLTgyNWItZTY2MDVjMGQ1MTBj",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcNpLhjGz3wpp8iuGxxXNiovQ4fxX433Inwps4T-2vqcmqrmlRhQc0XZ0SEATu8_b3yy5iiD9Te1NPk8dieUhdrgHZz3y8pQAy7InjOS5jHLZ-NCbZl6lfgekqgSj_hGTDi2FtcHtuVMEb54YoP-BMCrCZ0x8Vw8w-PeGUE08WNyNpMthNjwV_ugYoiMZj_eDy8Ivc9MVouBpzMnuG8z85kOxnsgKS2xiHArcjuh9wH131YQ4Yanlerd5bhSKDpT-pkxgAA1awbFWsyY7j8nQXF_SN4u38HlAVc1MQtixPWS2EjGTj7ic96jXTLQgbeVkU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 12:43:54.961 +01:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:24705/signin-oidc",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ErrorDescription": "Invalid redirect_uri",
  "ActivityId": "0HL9VOCQL0VMJ:00000002",
  "TimeStamp": "2017-12-10T11:43:54Z",
  "ProcessId": 10232,
  "LocalIpAddress": "127.0.0.1:23540",
  "RemoteIpAddress": "::1"
}
2017-12-10 12:47:12.427 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 12:47:12.491 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 12:47:12.495 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 12:47:12.495 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 12:47:12.496 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 12:47:12.496 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 12:47:28.567 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 12:47:28.576 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 12:47:28.576 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 12:47:28.580 +01:00 [DBG] Start discovery request
2017-12-10 12:47:28.858 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 12:47:28.859 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 12:47:28.859 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 12:47:28.864 +01:00 [DBG] Start key discovery request
2017-12-10 12:47:28.968 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 12:47:28.973 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 12:47:28.973 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 12:47:28.979 +01:00 [DBG] Start authorize request
2017-12-10 12:47:28.994 +01:00 [DBG] No user present in authorize request
2017-12-10 12:47:29.000 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 12:47:29.014 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 12:47:29.015 +01:00 [DBG] No PKCE used.
2017-12-10 12:47:29.048 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 12:47:29.086 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfsi2zvtvSjT8RwLNKL8BXljnqAlKzso3gf40mncbJdknVrAVgMQ_lCuS2DEC6YKqT0rBEuWrey_54bT5r1pkaJb0iR-l8_otzU8BoAguvZ-VOAIJw8vMCPPRJd8OzwTMrsgGad1_fMhEkUwIKSduhT6v9cRr4G8PAXCCeMwCq-_d6eL-3cvZq944qe6Ac3_C5tDVQ0Ux7R0lRe_RvNxihTicE2XzXZYdjFqYH1WEar3jFczuIMtar8-9lVES9-ecb1RznYNc_f9R2vuViUXJSfEacxyiFTSczosfgHUGaZ1aX59QEBshfz6Msun15NtuU",
  "Nonce": "636485032489232093.YmRlYWFhOTYtYTIzNy00Zjk2LTg2ODQtMmEyZWViZTBkNjc3Y2U4Zjg5Y2ItMmFmYy00NDg3LWJhNTgtNWQxZjRkYzYxNzk1",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485032489232093.YmRlYWFhOTYtYTIzNy00Zjk2LTg2ODQtMmEyZWViZTBkNjc3Y2U4Zjg5Y2ItMmFmYy00NDg3LWJhNTgtNWQxZjRkYzYxNzk1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfsi2zvtvSjT8RwLNKL8BXljnqAlKzso3gf40mncbJdknVrAVgMQ_lCuS2DEC6YKqT0rBEuWrey_54bT5r1pkaJb0iR-l8_otzU8BoAguvZ-VOAIJw8vMCPPRJd8OzwTMrsgGad1_fMhEkUwIKSduhT6v9cRr4G8PAXCCeMwCq-_d6eL-3cvZq944qe6Ac3_C5tDVQ0Ux7R0lRe_RvNxihTicE2XzXZYdjFqYH1WEar3jFczuIMtar8-9lVES9-ecb1RznYNc_f9R2vuViUXJSfEacxyiFTSczosfgHUGaZ1aX59QEBshfz6Msun15NtuU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 12:47:29.096 +01:00 [INF] Showing login: User is not authenticated
2017-12-10 12:47:29.242 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 12:47:29.243 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 12:47:29.243 +01:00 [DBG] No PKCE used.
2017-12-10 12:47:29.243 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 12:53:25.388 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 12:53:25.455 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 12:53:25.458 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 12:53:25.458 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 12:53:25.459 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 12:53:25.460 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 12:59:47.501 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 12:59:47.561 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 12:59:47.566 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 12:59:47.566 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 12:59:47.566 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 12:59:47.567 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 13:06:50.526 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 13:06:50.583 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 13:06:50.587 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 13:06:50.587 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 13:06:50.587 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 13:06:50.588 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 13:08:00.924 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 13:08:00.933 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 13:08:00.933 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 13:08:00.938 +01:00 [DBG] Start discovery request
2017-12-10 13:08:01.213 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 13:08:01.213 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 13:08:01.214 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 13:08:01.218 +01:00 [DBG] Start key discovery request
2017-12-10 13:08:01.321 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 13:08:01.325 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 13:08:01.325 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 13:08:01.330 +01:00 [DBG] Start authorize request
2017-12-10 13:08:01.345 +01:00 [DBG] No user present in authorize request
2017-12-10 13:08:01.350 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:08:01.367 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:08:01.368 +01:00 [DBG] No PKCE used.
2017-12-10 13:08:01.401 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:08:01.414 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfr0740TIWTDGZeWzkVOTUPODSfU8c48hkD_qZc7LgA5hI2jsL8HyWKTSx4Qx-drU_eSmQzrTyFHw--fgVwi_ypQVTNnNOLlhTmvyCEc1Il2uK-cXooQGnjEqrsqKOI0_YJ3b58zVAKILGh1xgxld4WAS1KABJyXIlzfvkuH3Ae3esp1CStOo6rhMCCkGL_aK_UvMN7HWmdKUhveWu0pFFcGMfaFUDZ7vgE8mi61a_QBG9_VX3j6AK7nHUpYKWpFl3Tfq1cuf1bTuHMqXb7veVuyZjXdAwDPJC-Kr8kjrZTleU2AyNN9TEqrdtW5g7uVzY",
  "Nonce": "636485044812777424.MTg4MjllOWUtMjcyZC00ZGMxLTkyMzktNTY4YjNhN2RhMzYxNzc5OTRlNjQtYWYwYS00NzU2LThmZjgtOTk1ZDYzMzA5YjIy",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485044812777424.MTg4MjllOWUtMjcyZC00ZGMxLTkyMzktNTY4YjNhN2RhMzYxNzc5OTRlNjQtYWYwYS00NzU2LThmZjgtOTk1ZDYzMzA5YjIy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfr0740TIWTDGZeWzkVOTUPODSfU8c48hkD_qZc7LgA5hI2jsL8HyWKTSx4Qx-drU_eSmQzrTyFHw--fgVwi_ypQVTNnNOLlhTmvyCEc1Il2uK-cXooQGnjEqrsqKOI0_YJ3b58zVAKILGh1xgxld4WAS1KABJyXIlzfvkuH3Ae3esp1CStOo6rhMCCkGL_aK_UvMN7HWmdKUhveWu0pFFcGMfaFUDZ7vgE8mi61a_QBG9_VX3j6AK7nHUpYKWpFl3Tfq1cuf1bTuHMqXb7veVuyZjXdAwDPJC-Kr8kjrZTleU2AyNN9TEqrdtW5g7uVzY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:08:01.425 +01:00 [INF] Showing login: User is not authenticated
2017-12-10 13:08:01.564 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:08:01.565 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:08:01.565 +01:00 [DBG] No PKCE used.
2017-12-10 13:08:01.566 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:08:44.448 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:08:44.612 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HL9VOPVIO1OS:00000006",
  "TimeStamp": "2017-12-10T12:08:44Z",
  "ProcessId": 1484,
  "LocalIpAddress": "127.0.0.1:14759",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:08:44.630 +01:00 [DBG] Augmenting SignInContext
2017-12-10 13:08:44.666 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 13:08:44.692 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:08:44.694 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:08:44.696 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 13:08:44.696 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 13:08:44.696 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 13:08:44.704 +01:00 [DBG] Start authorize callback request
2017-12-10 13:08:44.709 +01:00 [DBG] User in authorize request: 818727
2017-12-10 13:08:44.709 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:08:44.709 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:08:44.709 +01:00 [DBG] No PKCE used.
2017-12-10 13:08:44.709 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:08:44.710 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfr0740TIWTDGZeWzkVOTUPODSfU8c48hkD_qZc7LgA5hI2jsL8HyWKTSx4Qx-drU_eSmQzrTyFHw--fgVwi_ypQVTNnNOLlhTmvyCEc1Il2uK-cXooQGnjEqrsqKOI0_YJ3b58zVAKILGh1xgxld4WAS1KABJyXIlzfvkuH3Ae3esp1CStOo6rhMCCkGL_aK_UvMN7HWmdKUhveWu0pFFcGMfaFUDZ7vgE8mi61a_QBG9_VX3j6AK7nHUpYKWpFl3Tfq1cuf1bTuHMqXb7veVuyZjXdAwDPJC-Kr8kjrZTleU2AyNN9TEqrdtW5g7uVzY",
  "Nonce": "636485044812777424.MTg4MjllOWUtMjcyZC00ZGMxLTkyMzktNTY4YjNhN2RhMzYxNzc5OTRlNjQtYWYwYS00NzU2LThmZjgtOTk1ZDYzMzA5YjIy",
  "SessionId": "6bad9258926f72eaf0f71c49fa4f5cd4",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485044812777424.MTg4MjllOWUtMjcyZC00ZGMxLTkyMzktNTY4YjNhN2RhMzYxNzc5OTRlNjQtYWYwYS00NzU2LThmZjgtOTk1ZDYzMzA5YjIy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfr0740TIWTDGZeWzkVOTUPODSfU8c48hkD_qZc7LgA5hI2jsL8HyWKTSx4Qx-drU_eSmQzrTyFHw--fgVwi_ypQVTNnNOLlhTmvyCEc1Il2uK-cXooQGnjEqrsqKOI0_YJ3b58zVAKILGh1xgxld4WAS1KABJyXIlzfvkuH3Ae3esp1CStOo6rhMCCkGL_aK_UvMN7HWmdKUhveWu0pFFcGMfaFUDZ7vgE8mi61a_QBG9_VX3j6AK7nHUpYKWpFl3Tfq1cuf1bTuHMqXb7veVuyZjXdAwDPJC-Kr8kjrZTleU2AyNN9TEqrdtW5g7uVzY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:08:44.714 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 13:08:44.723 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 13:08:44.723 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 13:08:44.731 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:08:44.732 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:08:44.744 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:08:44.744 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:08:44.744 +01:00 [DBG] No PKCE used.
2017-12-10 13:08:44.744 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:08:45.149 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:08:45.151 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:09:01.411 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:09:01.411 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:09:01.413 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:09:01.443 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:09:01.444 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:09:01.444 +01:00 [DBG] No PKCE used.
2017-12-10 13:09:01.444 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:09:01.468 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:09:01.470 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:09:01.471 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 13:09:01.471 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 13:09:01.472 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 13:09:01.473 +01:00 [DBG] Start authorize callback request
2017-12-10 13:09:01.503 +01:00 [DBG] User in authorize request: 818727
2017-12-10 13:09:01.503 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:09:01.503 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:09:01.503 +01:00 [DBG] No PKCE used.
2017-12-10 13:09:01.503 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:09:01.504 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfr0740TIWTDGZeWzkVOTUPODSfU8c48hkD_qZc7LgA5hI2jsL8HyWKTSx4Qx-drU_eSmQzrTyFHw--fgVwi_ypQVTNnNOLlhTmvyCEc1Il2uK-cXooQGnjEqrsqKOI0_YJ3b58zVAKILGh1xgxld4WAS1KABJyXIlzfvkuH3Ae3esp1CStOo6rhMCCkGL_aK_UvMN7HWmdKUhveWu0pFFcGMfaFUDZ7vgE8mi61a_QBG9_VX3j6AK7nHUpYKWpFl3Tfq1cuf1bTuHMqXb7veVuyZjXdAwDPJC-Kr8kjrZTleU2AyNN9TEqrdtW5g7uVzY",
  "Nonce": "636485044812777424.MTg4MjllOWUtMjcyZC00ZGMxLTkyMzktNTY4YjNhN2RhMzYxNzc5OTRlNjQtYWYwYS00NzU2LThmZjgtOTk1ZDYzMzA5YjIy",
  "SessionId": "6bad9258926f72eaf0f71c49fa4f5cd4",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485044812777424.MTg4MjllOWUtMjcyZC00ZGMxLTkyMzktNTY4YjNhN2RhMzYxNzc5OTRlNjQtYWYwYS00NzU2LThmZjgtOTk1ZDYzMzA5YjIy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfr0740TIWTDGZeWzkVOTUPODSfU8c48hkD_qZc7LgA5hI2jsL8HyWKTSx4Qx-drU_eSmQzrTyFHw--fgVwi_ypQVTNnNOLlhTmvyCEc1Il2uK-cXooQGnjEqrsqKOI0_YJ3b58zVAKILGh1xgxld4WAS1KABJyXIlzfvkuH3Ae3esp1CStOo6rhMCCkGL_aK_UvMN7HWmdKUhveWu0pFFcGMfaFUDZ7vgE8mi61a_QBG9_VX3j6AK7nHUpYKWpFl3Tfq1cuf1bTuHMqXb7veVuyZjXdAwDPJC-Kr8kjrZTleU2AyNN9TEqrdtW5g7uVzY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:09:01.506 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 13:09:01.507 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 13:09:01.517 +01:00 [INF] User consented to scopes: ["openid","profile","api1"]
2017-12-10 13:09:01.529 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 818727
2017-12-10 13:09:01.538 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 13:09:01.569 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 13:09:01.579 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 13:09:01.582 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 13:09:01.667 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****szyg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****45f1"
    }
  ],
  "ActivityId": "0HL9VOPVIO1OS:0000000B",
  "TimeStamp": "2017-12-10T12:09:01Z",
  "ProcessId": 1484,
  "LocalIpAddress": "127.0.0.1:14759",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:09:01.674 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfr0740TIWTDGZeWzkVOTUPODSfU8c48hkD_qZc7LgA5hI2jsL8HyWKTSx4Qx-drU_eSmQzrTyFHw--fgVwi_ypQVTNnNOLlhTmvyCEc1Il2uK-cXooQGnjEqrsqKOI0_YJ3b58zVAKILGh1xgxld4WAS1KABJyXIlzfvkuH3Ae3esp1CStOo6rhMCCkGL_aK_UvMN7HWmdKUhveWu0pFFcGMfaFUDZ7vgE8mi61a_QBG9_VX3j6AK7nHUpYKWpFl3Tfq1cuf1bTuHMqXb7veVuyZjXdAwDPJC-Kr8kjrZTleU2AyNN9TEqrdtW5g7uVzY",
  "Scope": "openid profile api1"
}
2017-12-10 13:09:01.695 +01:00 [DBG] Augmenting SignInContext
2017-12-10 13:09:01.695 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 13:09:01.939 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 13:09:01.942 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 13:09:01.942 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 13:09:01.950 +01:00 [DBG] Start token request.
2017-12-10 13:09:01.956 +01:00 [DBG] Start client validation
2017-12-10 13:09:01.960 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 13:09:01.963 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 13:09:01.964 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 13:09:01.964 +01:00 [DBG] Secret id found: legacy
2017-12-10 13:09:01.972 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 13:09:01.972 +01:00 [DBG] Client validation success
2017-12-10 13:09:01.977 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VOPVIO1OS:0000000C",
  "TimeStamp": "2017-12-10T12:09:01Z",
  "ProcessId": 1484,
  "LocalIpAddress": "127.0.0.1:14759",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:09:01.984 +01:00 [DBG] Start token request validation
2017-12-10 13:09:01.994 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 13:09:02.025 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 13:09:02.025 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 13:09:02.031 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "ffeabaa60745ec60accea046fa73d65935b3861ba37bbd9e6c4d0ffb029b45f1",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "ffeabaa60745ec60accea046fa73d65935b3861ba37bbd9e6c4d0ffb029b45f1",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 13:09:02.056 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 13:09:02.056 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 13:09:02.058 +01:00 [DBG] Get profile called for subject 818727 from client Legacy Client with claim types [] via ClaimsProviderAccessToken
2017-12-10 13:09:02.059 +01:00 [DBG] Issued claims: []
2017-12-10 13:09:02.064 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 13:09:02.064 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 13:09:02.069 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****bkcw"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****NTTg"
    }
  ],
  "ActivityId": "0HL9VOPVIO1OS:0000000C",
  "TimeStamp": "2017-12-10T12:09:02Z",
  "ProcessId": 1484,
  "LocalIpAddress": "127.0.0.1:14759",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:09:02.072 +01:00 [DBG] Token request success.
2017-12-10 13:09:02.098 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 13:09:02.100 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 13:09:02.100 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 13:09:02.107 +01:00 [DBG] Start userinfo request
2017-12-10 13:09:02.110 +01:00 [DBG] Bearer token found in header
2017-12-10 13:09:02.166 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 13:09:02.170 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512907742,
    "exp": 1512911342,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512907724,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1"
    ],
    "amr": "pwd"
  }
}
2017-12-10 13:09:02.171 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 13:09:02.177 +01:00 [DBG] Creating userinfo response
2017-12-10 13:09:02.181 +01:00 [DBG] Scopes in access token: openid profile api1
2017-12-10 13:09:02.184 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 13:09:02.184 +01:00 [DBG] Get profile called for subject 818727 from client Legacy Client with claim types ["sub","name","family_name","given_name","middle_name","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 13:09:02.185 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 13:09:02.185 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 13:09:02.187 +01:00 [DBG] End userinfo request
2017-12-10 13:09:27.709 +01:00 [INF] AuthenticationScheme: idsrv was challenged.
2017-12-10 13:09:54.079 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:09:54.082 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HL9VOPVIO1OS:00000012",
  "TimeStamp": "2017-12-10T12:09:54Z",
  "ProcessId": 1484,
  "LocalIpAddress": "127.0.0.1:14759",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:09:54.083 +01:00 [DBG] Augmenting SignInContext
2017-12-10 13:09:54.084 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 13:09:54.096 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:09:54.098 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:10:59.388 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:10:59.390 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:10:59.391 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 13:10:59.392 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 13:10:59.395 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 13:10:59.396 +01:00 [DBG] Start authorize request
2017-12-10 13:10:59.397 +01:00 [DBG] User in authorize request: 818727
2017-12-10 13:10:59.397 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:10:59.397 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:10:59.397 +01:00 [DBG] No PKCE used.
2017-12-10 13:10:59.397 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:10:59.397 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqekyIXsVuhYVYuLBzUiHMTp_OYmbIR7ZLw6zEbRlR8QO5pu5ucGkwaxZSYo-G83HZPk-va4iHgBF4btVJtEwANsenRLqUNmQOUgveh2mWGHNfdPKevhuZqxmP_6IpotHM5P5mxh7rP7807z4W7cipuePxa4ZWwCO-9mXZO_Ex8LhzTVOzaUJ20MDGczl403ia-yRZnRYJ3tskaA6AGad12qDDl_gNcY2-oUDseTuUTTz8hFXBBwELuq1QKKW58sEdJ3_jyHXmAygenBTNhTKCX3GJfhAh6CpoYVCgNzSEdhP1xFYwmdLOCIFF9_fJMnipA",
  "Nonce": "636485046593762652.ZmY0MDcyMTMtNDcyNi00YzE5LTkzNTAtYzI3MDM4ZGI3OWYyOTAyMGZlMmItN2M5ZC00Yzk0LTg5NDItNDkxMjBlNjZkZTcy",
  "SessionId": "6bad9258926f72eaf0f71c49fa4f5cd4",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485046593762652.ZmY0MDcyMTMtNDcyNi00YzE5LTkzNTAtYzI3MDM4ZGI3OWYyOTAyMGZlMmItN2M5ZC00Yzk0LTg5NDItNDkxMjBlNjZkZTcy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqekyIXsVuhYVYuLBzUiHMTp_OYmbIR7ZLw6zEbRlR8QO5pu5ucGkwaxZSYo-G83HZPk-va4iHgBF4btVJtEwANsenRLqUNmQOUgveh2mWGHNfdPKevhuZqxmP_6IpotHM5P5mxh7rP7807z4W7cipuePxa4ZWwCO-9mXZO_Ex8LhzTVOzaUJ20MDGczl403ia-yRZnRYJ3tskaA6AGad12qDDl_gNcY2-oUDseTuUTTz8hFXBBwELuq1QKKW58sEdJ3_jyHXmAygenBTNhTKCX3GJfhAh6CpoYVCgNzSEdhP1xFYwmdLOCIFF9_fJMnipA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:10:59.400 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 13:10:59.400 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 13:10:59.400 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 13:10:59.408 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:10:59.409 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:10:59.413 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:10:59.413 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:10:59.413 +01:00 [DBG] No PKCE used.
2017-12-10 13:10:59.413 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:11:13.923 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:13.925 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:16.197 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:11:16.197 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:16.199 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:16.226 +01:00 [INF] AuthenticationScheme: idsrv signed out.
2017-12-10 13:11:16.233 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HL9VOPVIO1OT:00000004",
  "TimeStamp": "2017-12-10T12:11:16Z",
  "ProcessId": 1484,
  "LocalIpAddress": "127.0.0.1:14759",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:11:20.166 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:20.168 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:20.171 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:11:20.171 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:11:20.172 +01:00 [DBG] No PKCE used.
2017-12-10 13:11:20.172 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:11:22.007 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:22.009 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:22.012 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:11:22.012 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:11:22.012 +01:00 [DBG] No PKCE used.
2017-12-10 13:11:22.012 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:11:22.733 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:22.735 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:22.738 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:11:22.738 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:11:22.738 +01:00 [DBG] No PKCE used.
2017-12-10 13:11:22.738 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:11:31.624 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:31.627 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:31.719 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:31.721 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:34.048 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:34.050 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:36.280 +01:00 [DBG] CORS request made for path: /Account/Logout from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:11:36.281 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:36.282 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:11:36.286 +01:00 [INF] AuthenticationScheme: idsrv signed out.
2017-12-10 13:11:36.288 +01:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "818727",
  "DisplayName": "alice",
  "ActivityId": "0HL9VOPVIO1OT:0000000B",
  "TimeStamp": "2017-12-10T12:11:36Z",
  "ProcessId": 1484,
  "LocalIpAddress": "127.0.0.1:14759",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:11:36.309 +01:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-12-10 13:11:36.336 +01:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-12-10 13:11:36.336 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-12-10 13:11:36.345 +01:00 [DBG] Processing signout callback request
2017-12-10 13:11:36.358 +01:00 [DBG] No client front-channel logout URLs
2017-12-10 13:11:36.358 +01:00 [DBG] No client back-channel logout URLs
2017-12-10 13:11:36.358 +01:00 [INF] Successful signout callback.
2017-12-10 13:11:36.359 +01:00 [DBG] No client front-channel iframe urls
2017-12-10 13:11:36.360 +01:00 [DBG] No client back-channel iframe urls
2017-12-10 13:11:38.217 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:11:38.217 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:11:38.217 +01:00 [DBG] No PKCE used.
2017-12-10 13:11:38.217 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:11:39.471 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:11:39.471 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:11:39.471 +01:00 [DBG] No PKCE used.
2017-12-10 13:11:39.471 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:11:40.205 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:11:40.205 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:11:40.205 +01:00 [DBG] No PKCE used.
2017-12-10 13:11:40.205 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:11:44.784 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:11:44.788 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:11:44.788 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:11:44.788 +01:00 [DBG] No PKCE used.
2017-12-10 13:11:44.788 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:11:44.883 +01:00 [ERR] An unhandled exception has occurred while executing the request
System.ArgumentNullException: User is not currently authenticated, and no subject id passed
Parameter name: subject
   at IdentityServer4.Services.DefaultIdentityServerInteractionService.<GrantConsentAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Quickstart.UI.ConsentService.<ProcessConsent>d__5.MoveNext() in D:\CSharp\ErazerSSO\Erazer.Authorization\Quickstart\Consent\ConsentService.cs:line 79
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at IdentityServer4.Quickstart.UI.ConsentController.<Index>d__3.MoveNext() in D:\CSharp\ErazerSSO\Erazer.Authorization\Quickstart\Consent\ConsentController.cs:line 54
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-12-10 13:11:53.233 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:11:53.233 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:11:53.233 +01:00 [DBG] No PKCE used.
2017-12-10 13:11:53.233 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:12:15.299 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 13:12:15.299 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 13:12:15.299 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 13:12:15.300 +01:00 [DBG] Start authorize request
2017-12-10 13:12:15.301 +01:00 [DBG] No user present in authorize request
2017-12-10 13:12:15.301 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:12:15.301 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:12:15.301 +01:00 [DBG] No PKCE used.
2017-12-10 13:12:15.301 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:12:15.301 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy Client",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqduYAtqlP6gvP5LtCIVJp_8IrR8CMJDdv-ECtFHqb8oNTDSCLYr6VYpkKqduiIYPbzYdHgTLXmZTWHj7gOqXBdW7zAfzECYGNW-UzF5OEjyGUpdY7wVjx4GveZ5Sr6Cue4A6hD5ukNQpiIEfUUWrtHNpZmu3ma8p9-yrs3tjRmiHBIaxBFzg5oMsrbfGECxO93JZTukMcShZDtBhLIttDfmFnGjrF9AUS_8MSV9uVbC01KZus07g6JAQyxvfjgTlx-RwA18rgQLlqQqaFlbrDi6-i-fqTOKnsia__kRrRcz7rcBm0QYx5YjV1NM6S3jDMU",
  "Nonce": "636485047352895421.NTY3M2I2NzItYjBhNC00OTJkLTkwYTAtZmU5OWY3MzI3MWMyMDg2NWQ5M2YtNDgzMi00ZTQyLWIyODUtNTlmYTFkZjg1MWI5",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485047352895421.NTY3M2I2NzItYjBhNC00OTJkLTkwYTAtZmU5OWY3MzI3MWMyMDg2NWQ5M2YtNDgzMi00ZTQyLWIyODUtNTlmYTFkZjg1MWI5",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqduYAtqlP6gvP5LtCIVJp_8IrR8CMJDdv-ECtFHqb8oNTDSCLYr6VYpkKqduiIYPbzYdHgTLXmZTWHj7gOqXBdW7zAfzECYGNW-UzF5OEjyGUpdY7wVjx4GveZ5Sr6Cue4A6hD5ukNQpiIEfUUWrtHNpZmu3ma8p9-yrs3tjRmiHBIaxBFzg5oMsrbfGECxO93JZTukMcShZDtBhLIttDfmFnGjrF9AUS_8MSV9uVbC01KZus07g6JAQyxvfjgTlx-RwA18rgQLlqQqaFlbrDi6-i-fqTOKnsia__kRrRcz7rcBm0QYx5YjV1NM6S3jDMU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:12:15.304 +01:00 [INF] Showing login: User is not authenticated
2017-12-10 13:12:15.313 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:12:15.313 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:12:15.314 +01:00 [DBG] No PKCE used.
2017-12-10 13:12:15.314 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:36:59.235 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 13:36:59.290 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 13:36:59.294 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 13:36:59.295 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 13:36:59.295 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 13:36:59.295 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 13:38:02.562 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 13:38:02.570 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 13:38:02.570 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 13:38:02.575 +01:00 [DBG] Start discovery request
2017-12-10 13:38:02.928 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 13:38:02.936 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 13:38:02.937 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 13:38:02.948 +01:00 [DBG] Start key discovery request
2017-12-10 13:38:03.056 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 13:38:03.061 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 13:38:03.062 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 13:38:03.067 +01:00 [DBG] Start authorize request
2017-12-10 13:38:03.081 +01:00 [DBG] No user present in authorize request
2017-12-10 13:38:03.087 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:38:03.114 +01:00 [ERR] Unknown client or not enabled: legacy
{
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485062830068677.MzgyZDBmZTUtYTZmNi00NDRhLWJlMmItM2Y3MWQwNWY3M2U2MDQ1MDAxYjYtNGZkZC00OGFmLWFiODUtODYwMGFmZDdlNDAz",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdSdXKJkyZdfU_eqvcciVWfZdk5AUGLiACByLLpRA7lU8KVWQfXjyBwDkv9d4iprAclTX1LbwIRAv0gwsBjnK85IqHZZRTa7nv6uisaJJngoIetme8LZiIO5GIOu6feO_oA3OrmzC8m3SjKKcWKyv8rnhDXgsAelmr0I9adqahpZ4UNHDOBBrdpWw00hGPusLGt8EJLKIy83Xey3tZeZuocvLd7Brz1if1qlHyfOJxsLMoOl4_YW15eRj-oOChJ_jr2EUxx_tRAtNDYLf0WKL9hTJ-nf8tTyh6Io-RpKQYyct-kM9ln5PzvWkoC5kTiyqY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:38:03.119 +01:00 [ERR] Request validation failed
2017-12-10 13:38:03.120 +01:00 [INF] {
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485062830068677.MzgyZDBmZTUtYTZmNi00NDRhLWJlMmItM2Y3MWQwNWY3M2U2MDQ1MDAxYjYtNGZkZC00OGFmLWFiODUtODYwMGFmZDdlNDAz",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdSdXKJkyZdfU_eqvcciVWfZdk5AUGLiACByLLpRA7lU8KVWQfXjyBwDkv9d4iprAclTX1LbwIRAv0gwsBjnK85IqHZZRTa7nv6uisaJJngoIetme8LZiIO5GIOu6feO_oA3OrmzC8m3SjKKcWKyv8rnhDXgsAelmr0I9adqahpZ4UNHDOBBrdpWw00hGPusLGt8EJLKIy83Xey3tZeZuocvLd7Brz1if1qlHyfOJxsLMoOl4_YW15eRj-oOChJ_jr2EUxx_tRAtNDYLf0WKL9hTJ-nf8tTyh6Io-RpKQYyct-kM9ln5PzvWkoC5kTiyqY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:38:03.161 +01:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ActivityId": "0HL9VPAQIVMBB:00000003",
  "TimeStamp": "2017-12-10T12:38:03Z",
  "ProcessId": 1448,
  "LocalIpAddress": "127.0.0.1:26757",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:47:47.234 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 13:47:47.289 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 13:47:47.292 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 13:47:47.293 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 13:47:47.293 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 13:47:47.293 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 13:48:03.116 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 13:48:03.123 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 13:48:03.123 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 13:48:03.128 +01:00 [DBG] Start discovery request
2017-12-10 13:48:03.476 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 13:48:03.481 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 13:48:03.482 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 13:48:03.489 +01:00 [DBG] Start key discovery request
2017-12-10 13:48:03.601 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 13:48:03.606 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 13:48:03.606 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 13:48:03.612 +01:00 [DBG] Start authorize request
2017-12-10 13:48:03.626 +01:00 [DBG] No user present in authorize request
2017-12-10 13:48:03.631 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:48:03.651 +01:00 [ERR] Unknown client or not enabled: legacy
{
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485068835459544.YmIwYWM3YTEtYTdjNS00NmJlLWJhNjktNTI1ZWNmZDg3MDFlYTM1ZTljOWQtNjE1My00NTc4LWIxZGQtYTVjMzUwYjk0ZmZl",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfq3qNCW9KxOmIWMgp1Qc2kCtLQDv0ipaHU8juDJAACn1Odtte0IrAYqPNYIPk6lvYegUZLCw59I6veKu9q0QUfwzNvwIw7ay3YFqxDTvKsbaORuj1w7rtnn4mbymvJ3BQglTO9D_FCoYYivNoaelGzjcRFfNTCMNrK1E7wK-yvNsTxQ3OOqGnObWStO2SkeaFP_usiDZ3GRHyJOPRwUdDABJtiPfZIznW8GGFPidXWlA-NG_ToUG2mdilSUUUjFPVXO3xjePDByzVvfqWC9cQ3DtL5yUeG0kI3sUovqV6zQfAJbPBLMFiGg4wLXaHwWFY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:48:03.656 +01:00 [ERR] Request validation failed
2017-12-10 13:48:03.657 +01:00 [INF] {
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "SubjectId": "anonymous",
  "RequestedScopes": "",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485068835459544.YmIwYWM3YTEtYTdjNS00NmJlLWJhNjktNTI1ZWNmZDg3MDFlYTM1ZTljOWQtNjE1My00NTc4LWIxZGQtYTVjMzUwYjk0ZmZl",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqfq3qNCW9KxOmIWMgp1Qc2kCtLQDv0ipaHU8juDJAACn1Odtte0IrAYqPNYIPk6lvYegUZLCw59I6veKu9q0QUfwzNvwIw7ay3YFqxDTvKsbaORuj1w7rtnn4mbymvJ3BQglTO9D_FCoYYivNoaelGzjcRFfNTCMNrK1E7wK-yvNsTxQ3OOqGnObWStO2SkeaFP_usiDZ3GRHyJOPRwUdDABJtiPfZIznW8GGFPidXWlA-NG_ToUG2mdilSUUUjFPVXO3xjePDByzVvfqWC9cQ3DtL5yUeG0kI3sUovqV6zQfAJbPBLMFiGg4wLXaHwWFY",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:48:03.700 +01:00 [INF] {
  "Name": "Token Issued Failure",
  "Category": "Token",
  "EventType": "Failure",
  "Id": 2001,
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "Scopes": "",
  "Error": "unauthorized_client",
  "ActivityId": "0HL9VPGRN6COF:00000003",
  "TimeStamp": "2017-12-10T12:48:03Z",
  "ProcessId": 10704,
  "LocalIpAddress": "127.0.0.1:13086",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:49:37.305 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 13:49:37.357 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 13:49:37.360 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 13:49:37.360 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 13:49:37.360 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 13:49:37.361 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 13:49:49.332 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 13:49:49.340 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 13:49:49.340 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 13:49:49.345 +01:00 [DBG] Start discovery request
2017-12-10 13:49:49.684 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 13:49:49.690 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 13:49:49.690 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 13:49:49.698 +01:00 [DBG] Start key discovery request
2017-12-10 13:49:49.851 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 13:49:49.857 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 13:49:49.857 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 13:49:49.863 +01:00 [DBG] Start authorize request
2017-12-10 13:49:49.877 +01:00 [DBG] No user present in authorize request
2017-12-10 13:49:49.882 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:49:49.895 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:49:49.896 +01:00 [DBG] No PKCE used.
2017-12-10 13:49:49.931 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:49:49.945 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf2CYhisa-qLFo6IFi6DiUS2PjRiDsJARNrOzsyc6ziNKJcH7hg7K5Qu7pKYdzIszFaOLvQ4M_HhdePJTffTuAcilpvfn6mxShlyvPL_qVPwjxdqoYD67ayAO2hBUc4cp7XXf34BHafD101npnwK8OVqv6FqgkKmWmVgXb0TaNgXy28HKeSkEusIAqDgaKDjIwhaFpNitOPluJcshxOJJwbjc4yBOPdNfR1JcXmWJs25mOENT6vFjKOFVaQjeZdswslIbQiAdpMl2MH9Pg6lPx3lpn_QXDAQzYSVon_dL-2o5I7Ns_7IfKk4DB4XhoDY6k",
  "Nonce": "636485069897563454.ZjcyZDhmZmEtZmU0MC00Y2JmLWI0NTctMTY3YThkMGYyODJiMDk2ZWZkMzEtYzc5ZS00ODFmLTllNTktYjgwYjIxZGVmYWQ1",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485069897563454.ZjcyZDhmZmEtZmU0MC00Y2JmLWI0NTctMTY3YThkMGYyODJiMDk2ZWZkMzEtYzc5ZS00ODFmLTllNTktYjgwYjIxZGVmYWQ1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf2CYhisa-qLFo6IFi6DiUS2PjRiDsJARNrOzsyc6ziNKJcH7hg7K5Qu7pKYdzIszFaOLvQ4M_HhdePJTffTuAcilpvfn6mxShlyvPL_qVPwjxdqoYD67ayAO2hBUc4cp7XXf34BHafD101npnwK8OVqv6FqgkKmWmVgXb0TaNgXy28HKeSkEusIAqDgaKDjIwhaFpNitOPluJcshxOJJwbjc4yBOPdNfR1JcXmWJs25mOENT6vFjKOFVaQjeZdswslIbQiAdpMl2MH9Pg6lPx3lpn_QXDAQzYSVon_dL-2o5I7Ns_7IfKk4DB4XhoDY6k",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:49:49.956 +01:00 [INF] Showing login: User is not authenticated
2017-12-10 13:49:50.357 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:49:50.359 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:49:50.359 +01:00 [DBG] No PKCE used.
2017-12-10 13:49:50.359 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:49:58.151 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:49:58.312 +01:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "alice",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HL9VPHSH4CH6:00000005",
  "TimeStamp": "2017-12-10T12:49:58Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:49:58.317 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:49:58.317 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:49:58.317 +01:00 [DBG] No PKCE used.
2017-12-10 13:49:58.317 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:50:03.901 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:50:03.912 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HL9VPHSH4CH6:00000006",
  "TimeStamp": "2017-12-10T12:50:03Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:50:03.930 +01:00 [DBG] Augmenting SignInContext
2017-12-10 13:50:03.962 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 13:50:03.984 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:50:03.987 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:50:03.989 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 13:50:03.990 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 13:50:03.990 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 13:50:03.998 +01:00 [DBG] Start authorize callback request
2017-12-10 13:50:04.003 +01:00 [DBG] User in authorize request: 818727
2017-12-10 13:50:04.004 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:50:04.004 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:50:04.004 +01:00 [DBG] No PKCE used.
2017-12-10 13:50:04.004 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:50:04.004 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf2CYhisa-qLFo6IFi6DiUS2PjRiDsJARNrOzsyc6ziNKJcH7hg7K5Qu7pKYdzIszFaOLvQ4M_HhdePJTffTuAcilpvfn6mxShlyvPL_qVPwjxdqoYD67ayAO2hBUc4cp7XXf34BHafD101npnwK8OVqv6FqgkKmWmVgXb0TaNgXy28HKeSkEusIAqDgaKDjIwhaFpNitOPluJcshxOJJwbjc4yBOPdNfR1JcXmWJs25mOENT6vFjKOFVaQjeZdswslIbQiAdpMl2MH9Pg6lPx3lpn_QXDAQzYSVon_dL-2o5I7Ns_7IfKk4DB4XhoDY6k",
  "Nonce": "636485069897563454.ZjcyZDhmZmEtZmU0MC00Y2JmLWI0NTctMTY3YThkMGYyODJiMDk2ZWZkMzEtYzc5ZS00ODFmLTllNTktYjgwYjIxZGVmYWQ1",
  "SessionId": "56b42a98495e380b93ddf005c9f82405",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485069897563454.ZjcyZDhmZmEtZmU0MC00Y2JmLWI0NTctMTY3YThkMGYyODJiMDk2ZWZkMzEtYzc5ZS00ODFmLTllNTktYjgwYjIxZGVmYWQ1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf2CYhisa-qLFo6IFi6DiUS2PjRiDsJARNrOzsyc6ziNKJcH7hg7K5Qu7pKYdzIszFaOLvQ4M_HhdePJTffTuAcilpvfn6mxShlyvPL_qVPwjxdqoYD67ayAO2hBUc4cp7XXf34BHafD101npnwK8OVqv6FqgkKmWmVgXb0TaNgXy28HKeSkEusIAqDgaKDjIwhaFpNitOPluJcshxOJJwbjc4yBOPdNfR1JcXmWJs25mOENT6vFjKOFVaQjeZdswslIbQiAdpMl2MH9Pg6lPx3lpn_QXDAQzYSVon_dL-2o5I7Ns_7IfKk4DB4XhoDY6k",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:50:04.008 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 13:50:04.019 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 13:50:04.019 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 13:50:04.028 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:50:04.030 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:50:04.041 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:50:04.041 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:50:04.041 +01:00 [DBG] No PKCE used.
2017-12-10 13:50:04.042 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:50:15.596 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:50:15.597 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:50:15.598 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:50:15.626 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:50:15.626 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:50:15.627 +01:00 [DBG] No PKCE used.
2017-12-10 13:50:15.627 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:50:15.650 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:50:15.651 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:50:15.653 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 13:50:15.653 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 13:50:15.653 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 13:50:15.655 +01:00 [DBG] Start authorize callback request
2017-12-10 13:50:15.681 +01:00 [DBG] User in authorize request: 818727
2017-12-10 13:50:15.681 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:50:15.682 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:50:15.682 +01:00 [DBG] No PKCE used.
2017-12-10 13:50:15.682 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:50:15.682 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf2CYhisa-qLFo6IFi6DiUS2PjRiDsJARNrOzsyc6ziNKJcH7hg7K5Qu7pKYdzIszFaOLvQ4M_HhdePJTffTuAcilpvfn6mxShlyvPL_qVPwjxdqoYD67ayAO2hBUc4cp7XXf34BHafD101npnwK8OVqv6FqgkKmWmVgXb0TaNgXy28HKeSkEusIAqDgaKDjIwhaFpNitOPluJcshxOJJwbjc4yBOPdNfR1JcXmWJs25mOENT6vFjKOFVaQjeZdswslIbQiAdpMl2MH9Pg6lPx3lpn_QXDAQzYSVon_dL-2o5I7Ns_7IfKk4DB4XhoDY6k",
  "Nonce": "636485069897563454.ZjcyZDhmZmEtZmU0MC00Y2JmLWI0NTctMTY3YThkMGYyODJiMDk2ZWZkMzEtYzc5ZS00ODFmLTllNTktYjgwYjIxZGVmYWQ1",
  "SessionId": "56b42a98495e380b93ddf005c9f82405",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485069897563454.ZjcyZDhmZmEtZmU0MC00Y2JmLWI0NTctMTY3YThkMGYyODJiMDk2ZWZkMzEtYzc5ZS00ODFmLTllNTktYjgwYjIxZGVmYWQ1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf2CYhisa-qLFo6IFi6DiUS2PjRiDsJARNrOzsyc6ziNKJcH7hg7K5Qu7pKYdzIszFaOLvQ4M_HhdePJTffTuAcilpvfn6mxShlyvPL_qVPwjxdqoYD67ayAO2hBUc4cp7XXf34BHafD101npnwK8OVqv6FqgkKmWmVgXb0TaNgXy28HKeSkEusIAqDgaKDjIwhaFpNitOPluJcshxOJJwbjc4yBOPdNfR1JcXmWJs25mOENT6vFjKOFVaQjeZdswslIbQiAdpMl2MH9Pg6lPx3lpn_QXDAQzYSVon_dL-2o5I7Ns_7IfKk4DB4XhoDY6k",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:50:15.685 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 13:50:15.685 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 13:50:15.697 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 13:50:15.710 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 13:50:15.713 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 13:50:15.729 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 13:50:15.754 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 13:50:15.763 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 13:50:15.765 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 13:50:15.840 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Xh7w"
    },
    {
      "TokenType": "code",
      "TokenValue": "****940b"
    }
  ],
  "ActivityId": "0HL9VPHSH4CH6:0000000A",
  "TimeStamp": "2017-12-10T12:50:15Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:50:15.846 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf2CYhisa-qLFo6IFi6DiUS2PjRiDsJARNrOzsyc6ziNKJcH7hg7K5Qu7pKYdzIszFaOLvQ4M_HhdePJTffTuAcilpvfn6mxShlyvPL_qVPwjxdqoYD67ayAO2hBUc4cp7XXf34BHafD101npnwK8OVqv6FqgkKmWmVgXb0TaNgXy28HKeSkEusIAqDgaKDjIwhaFpNitOPluJcshxOJJwbjc4yBOPdNfR1JcXmWJs25mOENT6vFjKOFVaQjeZdswslIbQiAdpMl2MH9Pg6lPx3lpn_QXDAQzYSVon_dL-2o5I7Ns_7IfKk4DB4XhoDY6k",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 13:50:15.865 +01:00 [DBG] Augmenting SignInContext
2017-12-10 13:50:15.866 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 13:50:16.080 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 13:50:16.083 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 13:50:16.083 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 13:50:16.091 +01:00 [DBG] Start token request.
2017-12-10 13:50:16.096 +01:00 [DBG] Start client validation
2017-12-10 13:50:16.101 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 13:50:16.104 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 13:50:16.104 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 13:50:16.104 +01:00 [DBG] Secret id found: legacy
2017-12-10 13:50:16.114 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 13:50:16.114 +01:00 [DBG] Client validation success
2017-12-10 13:50:16.119 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VPHSH4CH6:0000000B",
  "TimeStamp": "2017-12-10T12:50:16Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:50:16.126 +01:00 [DBG] Start token request validation
2017-12-10 13:50:16.136 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 13:50:16.163 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 13:50:16.163 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 13:50:16.168 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "749d4cef8575203038fe1951c42dcf185202594740bd6c213fb19ea4970c940b",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "749d4cef8575203038fe1951c42dcf185202594740bd6c213fb19ea4970c940b",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 13:50:16.191 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 13:50:16.191 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 13:50:16.193 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 13:50:16.194 +01:00 [DBG] Issued claims: []
2017-12-10 13:50:16.202 +01:00 [DBG] Creating refresh token
2017-12-10 13:50:16.202 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 13:50:16.217 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 13:50:16.217 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 13:50:16.222 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****6ukA"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****e238"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****SKag"
    }
  ],
  "ActivityId": "0HL9VPHSH4CH6:0000000B",
  "TimeStamp": "2017-12-10T12:50:16Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:50:16.226 +01:00 [DBG] Token request success.
2017-12-10 13:50:16.255 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 13:50:16.257 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 13:50:16.257 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 13:50:16.264 +01:00 [DBG] Start userinfo request
2017-12-10 13:50:16.267 +01:00 [DBG] Bearer token found in header
2017-12-10 13:50:16.324 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 13:50:16.328 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512910216,
    "exp": 1512912016,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512910203,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 13:50:16.329 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 13:50:16.335 +01:00 [DBG] Creating userinfo response
2017-12-10 13:50:16.340 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 13:50:16.343 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 13:50:16.343 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 13:50:16.344 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 13:50:16.344 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 13:50:16.346 +01:00 [DBG] End userinfo request
2017-12-10 13:56:38.634 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:56:38.636 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:56:38.638 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 13:56:38.639 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 13:56:38.639 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 13:56:38.641 +01:00 [DBG] Start authorize request
2017-12-10 13:56:38.641 +01:00 [DBG] User in authorize request: 818727
2017-12-10 13:56:38.641 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:56:38.641 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:56:38.641 +01:00 [DBG] No PKCE used.
2017-12-10 13:56:38.641 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:56:38.641 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqffgYndhmVPjfquz61thk4tV7jiHvcot208_8D21rk0b3bvpI2beWAuCObXhyG4M7nMEBo5ZvTaHtodYOVmLT4XCrM_e7vBwdrDepfBlsgrRDF69PgPsq70dLLRdwHQ6nFRWRX6EcbLrnG85I5U-JMUFyYLJAQQE_IY14tNIkxfnsTmo2vzP0_hfZd58fD8YzSxJnh0OpQE_6eTB46lLRsVwSCncvbKowFUdoQVfw4BusOOLCFN0Nqi5IE6XhsjwPITBaZ9b2vWCLIwPvl94UCGapQeQs3X4eUThbd-YpKUpEAzh6wfP6LN_DhKrrikUKs",
  "Nonce": "636485073986172637.MGFkMDY1MTEtYmY0OS00OGQyLWJhYTAtZWYxOTdhMmMyZjY1YmE5ODJjNzQtYzEyYi00NjU3LWEwNGMtOWNjZTQwYzA5ZGQy",
  "SessionId": "56b42a98495e380b93ddf005c9f82405",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485073986172637.MGFkMDY1MTEtYmY0OS00OGQyLWJhYTAtZWYxOTdhMmMyZjY1YmE5ODJjNzQtYzEyYi00NjU3LWEwNGMtOWNjZTQwYzA5ZGQy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqffgYndhmVPjfquz61thk4tV7jiHvcot208_8D21rk0b3bvpI2beWAuCObXhyG4M7nMEBo5ZvTaHtodYOVmLT4XCrM_e7vBwdrDepfBlsgrRDF69PgPsq70dLLRdwHQ6nFRWRX6EcbLrnG85I5U-JMUFyYLJAQQE_IY14tNIkxfnsTmo2vzP0_hfZd58fD8YzSxJnh0OpQE_6eTB46lLRsVwSCncvbKowFUdoQVfw4BusOOLCFN0Nqi5IE6XhsjwPITBaZ9b2vWCLIwPvl94UCGapQeQs3X4eUThbd-YpKUpEAzh6wfP6LN_DhKrrikUKs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:56:38.645 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 13:56:38.645 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 13:56:38.645 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 13:56:38.653 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:56:38.654 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:56:38.658 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:56:38.659 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:56:38.659 +01:00 [DBG] No PKCE used.
2017-12-10 13:56:38.659 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:56:41.592 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 13:56:41.593 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:56:41.595 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:56:41.598 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:56:41.598 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:56:41.598 +01:00 [DBG] No PKCE used.
2017-12-10 13:56:41.599 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:56:41.609 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:56:41.611 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 13:56:41.612 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 13:56:41.613 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 13:56:41.613 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 13:56:41.614 +01:00 [DBG] Start authorize callback request
2017-12-10 13:56:41.614 +01:00 [DBG] User in authorize request: 818727
2017-12-10 13:56:41.615 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 13:56:41.615 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 13:56:41.615 +01:00 [DBG] No PKCE used.
2017-12-10 13:56:41.615 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 13:56:41.615 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqffgYndhmVPjfquz61thk4tV7jiHvcot208_8D21rk0b3bvpI2beWAuCObXhyG4M7nMEBo5ZvTaHtodYOVmLT4XCrM_e7vBwdrDepfBlsgrRDF69PgPsq70dLLRdwHQ6nFRWRX6EcbLrnG85I5U-JMUFyYLJAQQE_IY14tNIkxfnsTmo2vzP0_hfZd58fD8YzSxJnh0OpQE_6eTB46lLRsVwSCncvbKowFUdoQVfw4BusOOLCFN0Nqi5IE6XhsjwPITBaZ9b2vWCLIwPvl94UCGapQeQs3X4eUThbd-YpKUpEAzh6wfP6LN_DhKrrikUKs",
  "Nonce": "636485073986172637.MGFkMDY1MTEtYmY0OS00OGQyLWJhYTAtZWYxOTdhMmMyZjY1YmE5ODJjNzQtYzEyYi00NjU3LWEwNGMtOWNjZTQwYzA5ZGQy",
  "SessionId": "56b42a98495e380b93ddf005c9f82405",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485073986172637.MGFkMDY1MTEtYmY0OS00OGQyLWJhYTAtZWYxOTdhMmMyZjY1YmE5ODJjNzQtYzEyYi00NjU3LWEwNGMtOWNjZTQwYzA5ZGQy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqffgYndhmVPjfquz61thk4tV7jiHvcot208_8D21rk0b3bvpI2beWAuCObXhyG4M7nMEBo5ZvTaHtodYOVmLT4XCrM_e7vBwdrDepfBlsgrRDF69PgPsq70dLLRdwHQ6nFRWRX6EcbLrnG85I5U-JMUFyYLJAQQE_IY14tNIkxfnsTmo2vzP0_hfZd58fD8YzSxJnh0OpQE_6eTB46lLRsVwSCncvbKowFUdoQVfw4BusOOLCFN0Nqi5IE6XhsjwPITBaZ9b2vWCLIwPvl94UCGapQeQs3X4eUThbd-YpKUpEAzh6wfP6LN_DhKrrikUKs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 13:56:41.618 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 13:56:41.618 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 13:56:41.618 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 13:56:41.621 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 13:56:41.621 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 13:56:41.626 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 13:56:41.636 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 13:56:41.636 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 13:56:41.636 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 13:56:41.640 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****SeCQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****2145"
    }
  ],
  "ActivityId": "0HL9VPHSH4CH7:00000004",
  "TimeStamp": "2017-12-10T12:56:41Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:56:41.642 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqffgYndhmVPjfquz61thk4tV7jiHvcot208_8D21rk0b3bvpI2beWAuCObXhyG4M7nMEBo5ZvTaHtodYOVmLT4XCrM_e7vBwdrDepfBlsgrRDF69PgPsq70dLLRdwHQ6nFRWRX6EcbLrnG85I5U-JMUFyYLJAQQE_IY14tNIkxfnsTmo2vzP0_hfZd58fD8YzSxJnh0OpQE_6eTB46lLRsVwSCncvbKowFUdoQVfw4BusOOLCFN0Nqi5IE6XhsjwPITBaZ9b2vWCLIwPvl94UCGapQeQs3X4eUThbd-YpKUpEAzh6wfP6LN_DhKrrikUKs",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 13:56:41.688 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 13:56:41.688 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 13:56:41.688 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 13:56:41.691 +01:00 [DBG] Start token request.
2017-12-10 13:56:41.692 +01:00 [DBG] Start client validation
2017-12-10 13:56:41.692 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 13:56:41.692 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 13:56:41.692 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 13:56:41.692 +01:00 [DBG] Secret id found: legacy
2017-12-10 13:56:41.693 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 13:56:41.693 +01:00 [DBG] Client validation success
2017-12-10 13:56:41.693 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VPHSH4CH7:00000005",
  "TimeStamp": "2017-12-10T12:56:41Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:56:41.694 +01:00 [DBG] Start token request validation
2017-12-10 13:56:41.695 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 13:56:41.711 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 13:56:41.711 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 13:56:41.712 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "1988922659e0ff5e800461a6c9e5556099d1f84a4664d52faf1fb194bba72145",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "1988922659e0ff5e800461a6c9e5556099d1f84a4664d52faf1fb194bba72145",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 13:56:41.713 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 13:56:41.713 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 13:56:41.713 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 13:56:41.713 +01:00 [DBG] Issued claims: []
2017-12-10 13:56:41.717 +01:00 [DBG] Creating refresh token
2017-12-10 13:56:41.718 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 13:56:41.728 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 13:56:41.728 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 13:56:41.731 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****2byg"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****d608"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****lREg"
    }
  ],
  "ActivityId": "0HL9VPHSH4CH7:00000005",
  "TimeStamp": "2017-12-10T12:56:41Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 13:56:41.733 +01:00 [DBG] Token request success.
2017-12-10 13:56:41.740 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 13:56:41.740 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 13:56:41.741 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 13:56:41.742 +01:00 [DBG] Start userinfo request
2017-12-10 13:56:41.742 +01:00 [DBG] Bearer token found in header
2017-12-10 13:56:41.745 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 13:56:41.746 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512910601,
    "exp": 1512912401,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512910203,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 13:56:41.746 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 13:56:41.746 +01:00 [DBG] Creating userinfo response
2017-12-10 13:56:41.746 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 13:56:41.746 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 13:56:41.746 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 13:56:41.746 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 13:56:41.746 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 13:56:41.748 +01:00 [DBG] End userinfo request
2017-12-10 14:10:03.510 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 14:10:03.511 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 14:10:03.513 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 14:10:03.513 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 14:10:03.513 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 14:10:03.515 +01:00 [DBG] Start authorize request
2017-12-10 14:10:03.515 +01:00 [DBG] User in authorize request: 818727
2017-12-10 14:10:03.515 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 14:10:03.515 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 14:10:03.515 +01:00 [DBG] No PKCE used.
2017-12-10 14:10:03.515 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 14:10:03.515 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdmCFaMCgMidgj4jgXlWeUDcvSd0ZbXPMp9bcqC4wQVuCBKOpO6hsTJ1e6pZJ1J3TjY-y5HXmh_9jWo8-CWPIafaPxXLjaUFYEU4jfGNmHcjuZdHXQXxk1mblU7IsoaBbE0_DwGQtGpIhh4kFlabW-VSwaLCMounGO1KD9jwA3IL6c3o1hzRALJP9VO_XorIVHn99wTWUNwsbI6nAq--Of486o6VQWQozUtqhDfkV6X_oCY5wZ5ebmnhU4f593jZogocFWc6Ii1daebLj0-h3yauN5AMdHgZ10jPX6s8URbBnAuvgjo4-pTjgbUGY4DffA",
  "Nonce": "636485082034976446.ODk5YjcyMjgtODViMi00OGNmLWEzYmMtNzUwNjMyMDQxZGYyYzg0MjNhNWQtODBlMC00ODBlLWE1Y2UtN2NiYjk4NWM3MWVl",
  "SessionId": "56b42a98495e380b93ddf005c9f82405",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485082034976446.ODk5YjcyMjgtODViMi00OGNmLWEzYmMtNzUwNjMyMDQxZGYyYzg0MjNhNWQtODBlMC00ODBlLWE1Y2UtN2NiYjk4NWM3MWVl",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdmCFaMCgMidgj4jgXlWeUDcvSd0ZbXPMp9bcqC4wQVuCBKOpO6hsTJ1e6pZJ1J3TjY-y5HXmh_9jWo8-CWPIafaPxXLjaUFYEU4jfGNmHcjuZdHXQXxk1mblU7IsoaBbE0_DwGQtGpIhh4kFlabW-VSwaLCMounGO1KD9jwA3IL6c3o1hzRALJP9VO_XorIVHn99wTWUNwsbI6nAq--Of486o6VQWQozUtqhDfkV6X_oCY5wZ5ebmnhU4f593jZogocFWc6Ii1daebLj0-h3yauN5AMdHgZ10jPX6s8URbBnAuvgjo4-pTjgbUGY4DffA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 14:10:03.518 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 14:10:03.518 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 14:10:03.518 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 14:10:03.526 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 14:10:03.527 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 14:10:03.531 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 14:10:03.531 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 14:10:03.531 +01:00 [DBG] No PKCE used.
2017-12-10 14:10:03.531 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 14:10:11.407 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 14:10:11.407 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 14:10:11.408 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 14:10:11.413 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 14:10:11.413 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 14:10:11.413 +01:00 [DBG] No PKCE used.
2017-12-10 14:10:11.413 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 14:10:11.421 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 14:10:11.422 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 14:10:11.424 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 14:10:11.424 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 14:10:11.424 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 14:10:11.426 +01:00 [DBG] Start authorize callback request
2017-12-10 14:10:11.426 +01:00 [DBG] User in authorize request: 818727
2017-12-10 14:10:11.426 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 14:10:11.426 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 14:10:11.426 +01:00 [DBG] No PKCE used.
2017-12-10 14:10:11.426 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 14:10:11.427 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdmCFaMCgMidgj4jgXlWeUDcvSd0ZbXPMp9bcqC4wQVuCBKOpO6hsTJ1e6pZJ1J3TjY-y5HXmh_9jWo8-CWPIafaPxXLjaUFYEU4jfGNmHcjuZdHXQXxk1mblU7IsoaBbE0_DwGQtGpIhh4kFlabW-VSwaLCMounGO1KD9jwA3IL6c3o1hzRALJP9VO_XorIVHn99wTWUNwsbI6nAq--Of486o6VQWQozUtqhDfkV6X_oCY5wZ5ebmnhU4f593jZogocFWc6Ii1daebLj0-h3yauN5AMdHgZ10jPX6s8URbBnAuvgjo4-pTjgbUGY4DffA",
  "Nonce": "636485082034976446.ODk5YjcyMjgtODViMi00OGNmLWEzYmMtNzUwNjMyMDQxZGYyYzg0MjNhNWQtODBlMC00ODBlLWE1Y2UtN2NiYjk4NWM3MWVl",
  "SessionId": "56b42a98495e380b93ddf005c9f82405",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485082034976446.ODk5YjcyMjgtODViMi00OGNmLWEzYmMtNzUwNjMyMDQxZGYyYzg0MjNhNWQtODBlMC00ODBlLWE1Y2UtN2NiYjk4NWM3MWVl",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdmCFaMCgMidgj4jgXlWeUDcvSd0ZbXPMp9bcqC4wQVuCBKOpO6hsTJ1e6pZJ1J3TjY-y5HXmh_9jWo8-CWPIafaPxXLjaUFYEU4jfGNmHcjuZdHXQXxk1mblU7IsoaBbE0_DwGQtGpIhh4kFlabW-VSwaLCMounGO1KD9jwA3IL6c3o1hzRALJP9VO_XorIVHn99wTWUNwsbI6nAq--Of486o6VQWQozUtqhDfkV6X_oCY5wZ5ebmnhU4f593jZogocFWc6Ii1daebLj0-h3yauN5AMdHgZ10jPX6s8URbBnAuvgjo4-pTjgbUGY4DffA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 14:10:11.430 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 14:10:11.430 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 14:10:11.430 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 14:10:11.432 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 14:10:11.432 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 14:10:11.437 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 14:10:11.448 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 14:10:11.448 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 14:10:11.448 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 14:10:11.452 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****1Utg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****67e8"
    }
  ],
  "ActivityId": "0HL9VPHSH4CH8:00000004",
  "TimeStamp": "2017-12-10T13:10:11Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 14:10:11.453 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdmCFaMCgMidgj4jgXlWeUDcvSd0ZbXPMp9bcqC4wQVuCBKOpO6hsTJ1e6pZJ1J3TjY-y5HXmh_9jWo8-CWPIafaPxXLjaUFYEU4jfGNmHcjuZdHXQXxk1mblU7IsoaBbE0_DwGQtGpIhh4kFlabW-VSwaLCMounGO1KD9jwA3IL6c3o1hzRALJP9VO_XorIVHn99wTWUNwsbI6nAq--Of486o6VQWQozUtqhDfkV6X_oCY5wZ5ebmnhU4f593jZogocFWc6Ii1daebLj0-h3yauN5AMdHgZ10jPX6s8URbBnAuvgjo4-pTjgbUGY4DffA",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 14:10:11.501 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 14:10:11.501 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 14:10:11.502 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 14:10:11.503 +01:00 [DBG] Start token request.
2017-12-10 14:10:11.503 +01:00 [DBG] Start client validation
2017-12-10 14:10:11.503 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 14:10:11.503 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 14:10:11.503 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 14:10:11.503 +01:00 [DBG] Secret id found: legacy
2017-12-10 14:10:11.503 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 14:10:11.503 +01:00 [DBG] Client validation success
2017-12-10 14:10:11.503 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VPHSH4CH8:00000005",
  "TimeStamp": "2017-12-10T13:10:11Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 14:10:11.505 +01:00 [DBG] Start token request validation
2017-12-10 14:10:11.505 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 14:10:11.525 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 14:10:11.525 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 14:10:11.525 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "d751fe4a2e9f1590d7ba37ef225a66dd2eefd0844446b7c97634e2ac41c567e8",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "d751fe4a2e9f1590d7ba37ef225a66dd2eefd0844446b7c97634e2ac41c567e8",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 14:10:11.527 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 14:10:11.527 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 14:10:11.527 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 14:10:11.528 +01:00 [DBG] Issued claims: []
2017-12-10 14:10:11.533 +01:00 [DBG] Creating refresh token
2017-12-10 14:10:11.533 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 14:10:11.542 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 14:10:11.542 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 14:10:11.546 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****tUUA"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****e49c"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****LoNw"
    }
  ],
  "ActivityId": "0HL9VPHSH4CH8:00000005",
  "TimeStamp": "2017-12-10T13:10:11Z",
  "ProcessId": 12276,
  "LocalIpAddress": "127.0.0.1:12159",
  "RemoteIpAddress": "::1"
}
2017-12-10 14:10:11.547 +01:00 [DBG] Token request success.
2017-12-10 14:10:11.554 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 14:10:11.554 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 14:10:11.555 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 14:10:11.556 +01:00 [DBG] Start userinfo request
2017-12-10 14:10:11.556 +01:00 [DBG] Bearer token found in header
2017-12-10 14:10:11.559 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 14:10:11.559 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512911411,
    "exp": 1512913211,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512910203,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 14:10:11.559 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 14:10:11.559 +01:00 [DBG] Creating userinfo response
2017-12-10 14:10:11.559 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 14:10:11.559 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 14:10:11.559 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 14:10:11.559 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 14:10:11.559 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 14:10:11.561 +01:00 [DBG] End userinfo request
2017-12-10 15:57:07.923 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 15:57:07.976 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 15:57:07.979 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 15:57:07.980 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 15:57:07.980 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 15:57:07.980 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 15:58:00.878 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 15:58:00.930 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 15:58:00.933 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 15:58:00.933 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 15:58:00.934 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 15:58:00.934 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 15:59:22.863 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 15:59:22.914 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 15:59:22.917 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 15:59:22.917 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 15:59:22.918 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 15:59:22.918 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:00:48.992 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:00:49.052 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:00:49.055 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:00:49.055 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:00:49.055 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:00:49.056 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:02:48.915 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:02:48.923 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:02:48.923 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:02:48.928 +01:00 [DBG] Start discovery request
2017-12-10 16:02:49.293 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:02:49.303 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:02:49.303 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:02:49.308 +01:00 [DBG] Start key discovery request
2017-12-10 16:02:49.429 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:02:49.436 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:02:49.436 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:02:49.442 +01:00 [DBG] Start authorize request
2017-12-10 16:02:49.463 +01:00 [DBG] No user present in authorize request
2017-12-10 16:02:49.469 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:02:49.482 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:02:49.483 +01:00 [DBG] No PKCE used.
2017-12-10 16:02:49.517 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:02:49.532 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqcgjui19jldAPB7tTs2XaXudwsz3kwQ8qWaSMXEy4QiCSPP16ZAkLQAAl8CknEGjxFZEWmk9813N7I9-imaD9qrberdUxS2sKxjhHqlT2Nxp1FuEyYExXL43p4YihDC80b7_S5q0IJFDNkJID5fj7hzFp8sV0O1daFxkmujQh_Xg8zmXNMyGXYddeGLWh3yRaU1DFomma050BjqVEduTLyQMeZ-ME4LX9Ytfq2ErkEpT8ny1rQoC0KePrXIYojMjIsRy2RehzedoHl9jZEpyFhJQi8F8o3w5pCx2RKwZ7pwq7xBYxot6RHl2Vmjam9MG3k",
  "Nonce": "636485149693672309.OTg3NDU5ZGMtMTIxZS00YjE1LWIwODgtY2UzYjVkNGJiYWEwMmY0ZWNkZDEtY2IxYi00ZmY2LWFmMmItMzUwNWJjY2E3YzRh",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485149693672309.OTg3NDU5ZGMtMTIxZS00YjE1LWIwODgtY2UzYjVkNGJiYWEwMmY0ZWNkZDEtY2IxYi00ZmY2LWFmMmItMzUwNWJjY2E3YzRh",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqcgjui19jldAPB7tTs2XaXudwsz3kwQ8qWaSMXEy4QiCSPP16ZAkLQAAl8CknEGjxFZEWmk9813N7I9-imaD9qrberdUxS2sKxjhHqlT2Nxp1FuEyYExXL43p4YihDC80b7_S5q0IJFDNkJID5fj7hzFp8sV0O1daFxkmujQh_Xg8zmXNMyGXYddeGLWh3yRaU1DFomma050BjqVEduTLyQMeZ-ME4LX9Ytfq2ErkEpT8ny1rQoC0KePrXIYojMjIsRy2RehzedoHl9jZEpyFhJQi8F8o3w5pCx2RKwZ7pwq7xBYxot6RHl2Vmjam9MG3k",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:02:49.545 +01:00 [INF] Showing login: User is not authenticated
2017-12-10 16:02:49.965 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:02:49.966 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:02:49.966 +01:00 [DBG] No PKCE used.
2017-12-10 16:02:49.966 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:02:58.427 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:02:58.588 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HL9VRR6E2BRS:00000005",
  "TimeStamp": "2017-12-10T15:02:58Z",
  "ProcessId": 14308,
  "LocalIpAddress": "127.0.0.1:26391",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:02:58.606 +01:00 [DBG] Augmenting SignInContext
2017-12-10 16:02:58.639 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 16:02:58.670 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:02:58.675 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:02:58.678 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:02:58.679 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:02:58.679 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:02:58.686 +01:00 [DBG] Start authorize callback request
2017-12-10 16:02:58.690 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:02:58.690 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:02:58.690 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:02:58.690 +01:00 [DBG] No PKCE used.
2017-12-10 16:02:58.690 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:02:58.690 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqcgjui19jldAPB7tTs2XaXudwsz3kwQ8qWaSMXEy4QiCSPP16ZAkLQAAl8CknEGjxFZEWmk9813N7I9-imaD9qrberdUxS2sKxjhHqlT2Nxp1FuEyYExXL43p4YihDC80b7_S5q0IJFDNkJID5fj7hzFp8sV0O1daFxkmujQh_Xg8zmXNMyGXYddeGLWh3yRaU1DFomma050BjqVEduTLyQMeZ-ME4LX9Ytfq2ErkEpT8ny1rQoC0KePrXIYojMjIsRy2RehzedoHl9jZEpyFhJQi8F8o3w5pCx2RKwZ7pwq7xBYxot6RHl2Vmjam9MG3k",
  "Nonce": "636485149693672309.OTg3NDU5ZGMtMTIxZS00YjE1LWIwODgtY2UzYjVkNGJiYWEwMmY0ZWNkZDEtY2IxYi00ZmY2LWFmMmItMzUwNWJjY2E3YzRh",
  "SessionId": "8f5cdfd0ca4b16785ef13682edb16bb3",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485149693672309.OTg3NDU5ZGMtMTIxZS00YjE1LWIwODgtY2UzYjVkNGJiYWEwMmY0ZWNkZDEtY2IxYi00ZmY2LWFmMmItMzUwNWJjY2E3YzRh",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqcgjui19jldAPB7tTs2XaXudwsz3kwQ8qWaSMXEy4QiCSPP16ZAkLQAAl8CknEGjxFZEWmk9813N7I9-imaD9qrberdUxS2sKxjhHqlT2Nxp1FuEyYExXL43p4YihDC80b7_S5q0IJFDNkJID5fj7hzFp8sV0O1daFxkmujQh_Xg8zmXNMyGXYddeGLWh3yRaU1DFomma050BjqVEduTLyQMeZ-ME4LX9Ytfq2ErkEpT8ny1rQoC0KePrXIYojMjIsRy2RehzedoHl9jZEpyFhJQi8F8o3w5pCx2RKwZ7pwq7xBYxot6RHl2Vmjam9MG3k",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:02:58.694 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:02:58.704 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:02:58.705 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:02:58.713 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:02:58.714 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:02:58.730 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:02:58.730 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:02:58.730 +01:00 [DBG] No PKCE used.
2017-12-10 16:02:58.730 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:03:00.877 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:03:00.877 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:03:00.879 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:03:00.912 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:03:00.912 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:03:00.912 +01:00 [DBG] No PKCE used.
2017-12-10 16:03:00.913 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:03:00.940 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:03:00.942 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:03:00.943 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:03:00.943 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:03:00.943 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:03:00.945 +01:00 [DBG] Start authorize callback request
2017-12-10 16:03:00.973 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:03:00.973 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:03:00.973 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:03:00.973 +01:00 [DBG] No PKCE used.
2017-12-10 16:03:00.973 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:03:00.973 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqcgjui19jldAPB7tTs2XaXudwsz3kwQ8qWaSMXEy4QiCSPP16ZAkLQAAl8CknEGjxFZEWmk9813N7I9-imaD9qrberdUxS2sKxjhHqlT2Nxp1FuEyYExXL43p4YihDC80b7_S5q0IJFDNkJID5fj7hzFp8sV0O1daFxkmujQh_Xg8zmXNMyGXYddeGLWh3yRaU1DFomma050BjqVEduTLyQMeZ-ME4LX9Ytfq2ErkEpT8ny1rQoC0KePrXIYojMjIsRy2RehzedoHl9jZEpyFhJQi8F8o3w5pCx2RKwZ7pwq7xBYxot6RHl2Vmjam9MG3k",
  "Nonce": "636485149693672309.OTg3NDU5ZGMtMTIxZS00YjE1LWIwODgtY2UzYjVkNGJiYWEwMmY0ZWNkZDEtY2IxYi00ZmY2LWFmMmItMzUwNWJjY2E3YzRh",
  "SessionId": "8f5cdfd0ca4b16785ef13682edb16bb3",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485149693672309.OTg3NDU5ZGMtMTIxZS00YjE1LWIwODgtY2UzYjVkNGJiYWEwMmY0ZWNkZDEtY2IxYi00ZmY2LWFmMmItMzUwNWJjY2E3YzRh",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqcgjui19jldAPB7tTs2XaXudwsz3kwQ8qWaSMXEy4QiCSPP16ZAkLQAAl8CknEGjxFZEWmk9813N7I9-imaD9qrberdUxS2sKxjhHqlT2Nxp1FuEyYExXL43p4YihDC80b7_S5q0IJFDNkJID5fj7hzFp8sV0O1daFxkmujQh_Xg8zmXNMyGXYddeGLWh3yRaU1DFomma050BjqVEduTLyQMeZ-ME4LX9Ytfq2ErkEpT8ny1rQoC0KePrXIYojMjIsRy2RehzedoHl9jZEpyFhJQi8F8o3w5pCx2RKwZ7pwq7xBYxot6RHl2Vmjam9MG3k",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:03:00.976 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:03:00.976 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:03:00.988 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:03:01.000 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:03:01.004 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:03:01.025 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:03:01.053 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:03:01.064 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:03:01.066 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:03:01.140 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****dvYA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****cf8b"
    }
  ],
  "ActivityId": "0HL9VRR6E2BRS:00000009",
  "TimeStamp": "2017-12-10T15:03:01Z",
  "ProcessId": 14308,
  "LocalIpAddress": "127.0.0.1:26391",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:03:01.145 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqcgjui19jldAPB7tTs2XaXudwsz3kwQ8qWaSMXEy4QiCSPP16ZAkLQAAl8CknEGjxFZEWmk9813N7I9-imaD9qrberdUxS2sKxjhHqlT2Nxp1FuEyYExXL43p4YihDC80b7_S5q0IJFDNkJID5fj7hzFp8sV0O1daFxkmujQh_Xg8zmXNMyGXYddeGLWh3yRaU1DFomma050BjqVEduTLyQMeZ-ME4LX9Ytfq2ErkEpT8ny1rQoC0KePrXIYojMjIsRy2RehzedoHl9jZEpyFhJQi8F8o3w5pCx2RKwZ7pwq7xBYxot6RHl2Vmjam9MG3k",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:03:01.171 +01:00 [DBG] Augmenting SignInContext
2017-12-10 16:03:01.171 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 16:03:01.372 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:03:01.375 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:03:01.375 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:03:01.383 +01:00 [DBG] Start token request.
2017-12-10 16:03:01.389 +01:00 [DBG] Start client validation
2017-12-10 16:03:01.393 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:03:01.396 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:03:01.396 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:03:01.396 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:03:01.408 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:03:01.408 +01:00 [DBG] Client validation success
2017-12-10 16:03:01.416 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VRR6E2BRS:0000000A",
  "TimeStamp": "2017-12-10T15:03:01Z",
  "ProcessId": 14308,
  "LocalIpAddress": "127.0.0.1:26391",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:03:01.426 +01:00 [DBG] Start token request validation
2017-12-10 16:03:01.436 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:03:01.469 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:03:01.469 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:03:01.474 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "c95e84a7f3cc8e73c10a10a5b8bf0832e2e1c6ba244f5abb2639b3bfbb34cf8b",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "c95e84a7f3cc8e73c10a10a5b8bf0832e2e1c6ba244f5abb2639b3bfbb34cf8b",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:03:01.499 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:03:01.499 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:03:01.501 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:03:01.503 +01:00 [DBG] Issued claims: []
2017-12-10 16:03:01.510 +01:00 [DBG] Creating refresh token
2017-12-10 16:03:01.510 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:03:01.526 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:03:01.526 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:03:01.530 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****SUMQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****b591"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****JUwA"
    }
  ],
  "ActivityId": "0HL9VRR6E2BRS:0000000A",
  "TimeStamp": "2017-12-10T15:03:01Z",
  "ProcessId": 14308,
  "LocalIpAddress": "127.0.0.1:26391",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:03:01.533 +01:00 [DBG] Token request success.
2017-12-10 16:03:01.560 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:03:01.561 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:03:01.561 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:03:01.569 +01:00 [DBG] Start userinfo request
2017-12-10 16:03:01.572 +01:00 [DBG] Bearer token found in header
2017-12-10 16:03:01.629 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:03:01.633 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512918181,
    "exp": 1512919981,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918178,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:03:01.634 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:03:01.640 +01:00 [DBG] Creating userinfo response
2017-12-10 16:03:01.645 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:03:01.649 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:03:01.649 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:03:01.651 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:03:01.651 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:03:01.654 +01:00 [DBG] End userinfo request
2017-12-10 16:04:57.104 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:04:57.159 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:04:57.163 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:04:57.163 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:04:57.164 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:04:57.164 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:05:19.652 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:05:19.660 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:05:19.661 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:05:19.665 +01:00 [DBG] Start discovery request
2017-12-10 16:05:20.011 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:05:20.020 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:05:20.020 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:05:20.046 +01:00 [DBG] Start key discovery request
2017-12-10 16:05:20.155 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:05:20.162 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:05:20.162 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:05:20.167 +01:00 [DBG] Start authorize request
2017-12-10 16:05:20.182 +01:00 [DBG] No user present in authorize request
2017-12-10 16:05:20.186 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:05:20.200 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:05:20.201 +01:00 [DBG] No PKCE used.
2017-12-10 16:05:20.237 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:05:20.250 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcMzdvtFoE6ZEC1q8UOPbSvpgm_ceY-cN8BJhw89YDV55IIyVRl-qsabdn-u0ZS8LrTYNAW9N3wpuzMsbQ0B2rMq-EVuSNh1haxc43BtePvjINvX1hWwGTCCb0mzz3thm_ZyiINm4wtqPcYwctSxDmlyPnaTm6jOUk_MnwfYHK-3jl2-EeIq8Xgcxlf4RXIU7TKn7r-6PlygV1kGq-_Iyi6jKtkQyAVO5S72yiuZv6Ig7DDWwV3v8kapfq6YbrP_uNDoiYHunFaS0QIGXCjwxnHMkvo2P9-ZTNtKm-_eRgno3kUln2MmZ01sde6tg5b_3Y",
  "Nonce": "636485151201079157.ZmU1MThlZmEtNzgyNi00MDY3LWE0YTEtZGM2OTNlMzlmYWMzNTk5NGRiNTAtMzAyZi00OWNjLWJkZjUtZjIyYzUwMjE0Y2Qy",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485151201079157.ZmU1MThlZmEtNzgyNi00MDY3LWE0YTEtZGM2OTNlMzlmYWMzNTk5NGRiNTAtMzAyZi00OWNjLWJkZjUtZjIyYzUwMjE0Y2Qy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcMzdvtFoE6ZEC1q8UOPbSvpgm_ceY-cN8BJhw89YDV55IIyVRl-qsabdn-u0ZS8LrTYNAW9N3wpuzMsbQ0B2rMq-EVuSNh1haxc43BtePvjINvX1hWwGTCCb0mzz3thm_ZyiINm4wtqPcYwctSxDmlyPnaTm6jOUk_MnwfYHK-3jl2-EeIq8Xgcxlf4RXIU7TKn7r-6PlygV1kGq-_Iyi6jKtkQyAVO5S72yiuZv6Ig7DDWwV3v8kapfq6YbrP_uNDoiYHunFaS0QIGXCjwxnHMkvo2P9-ZTNtKm-_eRgno3kUln2MmZ01sde6tg5b_3Y",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:05:20.262 +01:00 [INF] Showing login: User is not authenticated
2017-12-10 16:05:20.667 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:05:20.669 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:05:20.669 +01:00 [DBG] No PKCE used.
2017-12-10 16:05:20.669 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:05:31.364 +01:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:05:31.520 +01:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "818727",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HL9VRTGE0LO2:00000005",
  "TimeStamp": "2017-12-10T15:05:31Z",
  "ProcessId": 7808,
  "LocalIpAddress": "127.0.0.1:18841",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:05:31.536 +01:00 [DBG] Augmenting SignInContext
2017-12-10 16:05:31.570 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 16:05:31.599 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:05:31.602 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:05:31.603 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:05:31.604 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:05:31.604 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:05:31.611 +01:00 [DBG] Start authorize callback request
2017-12-10 16:05:31.614 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:05:31.614 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:05:31.615 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:05:31.615 +01:00 [DBG] No PKCE used.
2017-12-10 16:05:31.615 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:05:31.615 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcMzdvtFoE6ZEC1q8UOPbSvpgm_ceY-cN8BJhw89YDV55IIyVRl-qsabdn-u0ZS8LrTYNAW9N3wpuzMsbQ0B2rMq-EVuSNh1haxc43BtePvjINvX1hWwGTCCb0mzz3thm_ZyiINm4wtqPcYwctSxDmlyPnaTm6jOUk_MnwfYHK-3jl2-EeIq8Xgcxlf4RXIU7TKn7r-6PlygV1kGq-_Iyi6jKtkQyAVO5S72yiuZv6Ig7DDWwV3v8kapfq6YbrP_uNDoiYHunFaS0QIGXCjwxnHMkvo2P9-ZTNtKm-_eRgno3kUln2MmZ01sde6tg5b_3Y",
  "Nonce": "636485151201079157.ZmU1MThlZmEtNzgyNi00MDY3LWE0YTEtZGM2OTNlMzlmYWMzNTk5NGRiNTAtMzAyZi00OWNjLWJkZjUtZjIyYzUwMjE0Y2Qy",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485151201079157.ZmU1MThlZmEtNzgyNi00MDY3LWE0YTEtZGM2OTNlMzlmYWMzNTk5NGRiNTAtMzAyZi00OWNjLWJkZjUtZjIyYzUwMjE0Y2Qy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcMzdvtFoE6ZEC1q8UOPbSvpgm_ceY-cN8BJhw89YDV55IIyVRl-qsabdn-u0ZS8LrTYNAW9N3wpuzMsbQ0B2rMq-EVuSNh1haxc43BtePvjINvX1hWwGTCCb0mzz3thm_ZyiINm4wtqPcYwctSxDmlyPnaTm6jOUk_MnwfYHK-3jl2-EeIq8Xgcxlf4RXIU7TKn7r-6PlygV1kGq-_Iyi6jKtkQyAVO5S72yiuZv6Ig7DDWwV3v8kapfq6YbrP_uNDoiYHunFaS0QIGXCjwxnHMkvo2P9-ZTNtKm-_eRgno3kUln2MmZ01sde6tg5b_3Y",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:05:31.619 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:05:31.630 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:05:31.630 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:05:31.638 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:05:31.639 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:05:31.650 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:05:31.650 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:05:31.650 +01:00 [DBG] No PKCE used.
2017-12-10 16:05:31.650 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:05:34.659 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:05:34.659 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:05:34.661 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:05:34.698 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:05:34.698 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:05:34.698 +01:00 [DBG] No PKCE used.
2017-12-10 16:05:34.698 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:05:34.723 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:05:34.725 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:05:34.727 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:05:34.727 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:05:34.727 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:05:34.729 +01:00 [DBG] Start authorize callback request
2017-12-10 16:05:34.767 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:05:34.767 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:05:34.767 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:05:34.767 +01:00 [DBG] No PKCE used.
2017-12-10 16:05:34.767 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:05:34.767 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcMzdvtFoE6ZEC1q8UOPbSvpgm_ceY-cN8BJhw89YDV55IIyVRl-qsabdn-u0ZS8LrTYNAW9N3wpuzMsbQ0B2rMq-EVuSNh1haxc43BtePvjINvX1hWwGTCCb0mzz3thm_ZyiINm4wtqPcYwctSxDmlyPnaTm6jOUk_MnwfYHK-3jl2-EeIq8Xgcxlf4RXIU7TKn7r-6PlygV1kGq-_Iyi6jKtkQyAVO5S72yiuZv6Ig7DDWwV3v8kapfq6YbrP_uNDoiYHunFaS0QIGXCjwxnHMkvo2P9-ZTNtKm-_eRgno3kUln2MmZ01sde6tg5b_3Y",
  "Nonce": "636485151201079157.ZmU1MThlZmEtNzgyNi00MDY3LWE0YTEtZGM2OTNlMzlmYWMzNTk5NGRiNTAtMzAyZi00OWNjLWJkZjUtZjIyYzUwMjE0Y2Qy",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485151201079157.ZmU1MThlZmEtNzgyNi00MDY3LWE0YTEtZGM2OTNlMzlmYWMzNTk5NGRiNTAtMzAyZi00OWNjLWJkZjUtZjIyYzUwMjE0Y2Qy",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcMzdvtFoE6ZEC1q8UOPbSvpgm_ceY-cN8BJhw89YDV55IIyVRl-qsabdn-u0ZS8LrTYNAW9N3wpuzMsbQ0B2rMq-EVuSNh1haxc43BtePvjINvX1hWwGTCCb0mzz3thm_ZyiINm4wtqPcYwctSxDmlyPnaTm6jOUk_MnwfYHK-3jl2-EeIq8Xgcxlf4RXIU7TKn7r-6PlygV1kGq-_Iyi6jKtkQyAVO5S72yiuZv6Ig7DDWwV3v8kapfq6YbrP_uNDoiYHunFaS0QIGXCjwxnHMkvo2P9-ZTNtKm-_eRgno3kUln2MmZ01sde6tg5b_3Y",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:05:34.770 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:05:34.771 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:05:34.784 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:05:34.800 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:05:34.804 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:05:34.822 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:05:34.856 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:05:34.867 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:05:34.870 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:05:34.954 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****XDkg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****5772"
    }
  ],
  "ActivityId": "0HL9VRTGE0LO2:00000009",
  "TimeStamp": "2017-12-10T15:05:34Z",
  "ProcessId": 7808,
  "LocalIpAddress": "127.0.0.1:18841",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:05:34.960 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcMzdvtFoE6ZEC1q8UOPbSvpgm_ceY-cN8BJhw89YDV55IIyVRl-qsabdn-u0ZS8LrTYNAW9N3wpuzMsbQ0B2rMq-EVuSNh1haxc43BtePvjINvX1hWwGTCCb0mzz3thm_ZyiINm4wtqPcYwctSxDmlyPnaTm6jOUk_MnwfYHK-3jl2-EeIq8Xgcxlf4RXIU7TKn7r-6PlygV1kGq-_Iyi6jKtkQyAVO5S72yiuZv6Ig7DDWwV3v8kapfq6YbrP_uNDoiYHunFaS0QIGXCjwxnHMkvo2P9-ZTNtKm-_eRgno3kUln2MmZ01sde6tg5b_3Y",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:05:34.979 +01:00 [DBG] Augmenting SignInContext
2017-12-10 16:05:34.980 +01:00 [INF] AuthenticationScheme: idsrv signed in.
2017-12-10 16:05:35.243 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:05:35.247 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:05:35.247 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:05:35.256 +01:00 [DBG] Start token request.
2017-12-10 16:05:35.261 +01:00 [DBG] Start client validation
2017-12-10 16:05:35.266 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:05:35.270 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:05:35.271 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:05:35.271 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:05:35.280 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:05:35.280 +01:00 [DBG] Client validation success
2017-12-10 16:05:35.285 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VRTGE0LO2:0000000A",
  "TimeStamp": "2017-12-10T15:05:35Z",
  "ProcessId": 7808,
  "LocalIpAddress": "127.0.0.1:18841",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:05:35.294 +01:00 [DBG] Start token request validation
2017-12-10 16:05:35.307 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:05:35.343 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:05:35.343 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:05:35.350 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "1908d64cac06e2e1c3f701636deebcc9bcb2493cfd3f12379c2cc0604e195772",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "1908d64cac06e2e1c3f701636deebcc9bcb2493cfd3f12379c2cc0604e195772",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:05:35.373 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:05:35.374 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:05:35.376 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:05:35.377 +01:00 [DBG] Issued claims: []
2017-12-10 16:05:35.388 +01:00 [DBG] Creating refresh token
2017-12-10 16:05:35.388 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:05:35.402 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:05:35.402 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:05:35.407 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****mr3A"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****d989"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****S0fg"
    }
  ],
  "ActivityId": "0HL9VRTGE0LO2:0000000A",
  "TimeStamp": "2017-12-10T15:05:35Z",
  "ProcessId": 7808,
  "LocalIpAddress": "127.0.0.1:18841",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:05:35.410 +01:00 [DBG] Token request success.
2017-12-10 16:05:35.442 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:05:35.443 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:05:35.443 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:05:35.450 +01:00 [DBG] Start userinfo request
2017-12-10 16:05:35.454 +01:00 [DBG] Bearer token found in header
2017-12-10 16:05:35.513 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:05:35.517 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512918335,
    "exp": 1512920135,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:05:35.518 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:05:35.524 +01:00 [DBG] Creating userinfo response
2017-12-10 16:05:35.528 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:05:35.531 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:05:35.531 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:05:35.532 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:05:35.533 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:05:35.534 +01:00 [DBG] End userinfo request
2017-12-10 16:06:41.604 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:06:41.657 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:06:41.660 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:06:41.660 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:06:41.660 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:06:41.660 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:06:49.794 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:06:49.802 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:06:49.802 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:06:49.807 +01:00 [DBG] Start discovery request
2017-12-10 16:06:50.163 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:06:50.165 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:06:50.167 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:06:50.173 +01:00 [DBG] Start key discovery request
2017-12-10 16:06:50.352 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:06:50.355 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:06:50.368 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:06:50.373 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:06:50.373 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:06:50.379 +01:00 [DBG] Start authorize request
2017-12-10 16:06:50.394 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:06:50.398 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:06:50.410 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:06:50.411 +01:00 [DBG] No PKCE used.
2017-12-10 16:06:50.443 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:06:50.456 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
  "Nonce": "636485152102316219.ZTcxMDQ0ZjEtNDRjZi00NGNjLWJhNWEtOGM4ZTFlYmRiYTY3OGJjYzZkZjAtYWQ2ZS00MzBiLWJmNWEtYjhiZWZkODJhYWU1",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485152102316219.ZTcxMDQ0ZjEtNDRjZi00NGNjLWJhNWEtOGM4ZTFlYmRiYTY3OGJjYzZkZjAtYWQ2ZS00MzBiLWJmNWEtYjhiZWZkODJhYWU1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:06:50.468 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:06:50.478 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:06:50.478 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:06:50.496 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:06:50.498 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:06:50.895 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:06:50.896 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:06:50.896 +01:00 [DBG] No PKCE used.
2017-12-10 16:06:50.896 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:06:57.187 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:06:57.188 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:06:57.191 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:06:57.331 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:06:57.332 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:06:57.332 +01:00 [DBG] No PKCE used.
2017-12-10 16:06:57.332 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:06:57.375 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:06:57.377 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:06:57.379 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:06:57.380 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:06:57.380 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:06:57.388 +01:00 [DBG] Start authorize callback request
2017-12-10 16:06:57.420 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:06:57.420 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:06:57.420 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:06:57.420 +01:00 [DBG] No PKCE used.
2017-12-10 16:06:57.420 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:06:57.420 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
  "Nonce": "636485152102316219.ZTcxMDQ0ZjEtNDRjZi00NGNjLWJhNWEtOGM4ZTFlYmRiYTY3OGJjYzZkZjAtYWQ2ZS00MzBiLWJmNWEtYjhiZWZkODJhYWU1",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485152102316219.ZTcxMDQ0ZjEtNDRjZi00NGNjLWJhNWEtOGM4ZTFlYmRiYTY3OGJjYzZkZjAtYWQ2ZS00MzBiLWJmNWEtYjhiZWZkODJhYWU1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:06:57.424 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:06:57.424 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:06:57.435 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:06:57.449 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:06:57.453 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:06:57.472 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:06:57.502 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:06:57.512 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:06:57.514 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:06:57.617 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****uhrA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****b5e5"
    }
  ],
  "ActivityId": "0HL9VRUFI8EG7:00000006",
  "TimeStamp": "2017-12-10T15:06:57Z",
  "ProcessId": 17488,
  "LocalIpAddress": "127.0.0.1:32260",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:06:57.623 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:06:57.850 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:06:57.854 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:06:57.854 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:06:57.862 +01:00 [DBG] Start token request.
2017-12-10 16:06:57.867 +01:00 [DBG] Start client validation
2017-12-10 16:06:57.872 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:06:57.875 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:06:57.876 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:06:57.876 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:06:57.885 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:06:57.885 +01:00 [DBG] Client validation success
2017-12-10 16:06:57.890 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VRUFI8EG7:00000007",
  "TimeStamp": "2017-12-10T15:06:57Z",
  "ProcessId": 17488,
  "LocalIpAddress": "127.0.0.1:32260",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:06:57.898 +01:00 [DBG] Start token request validation
2017-12-10 16:06:57.908 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:06:57.935 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:06:57.935 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:06:57.941 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "60236ef65a024fb124ac49a814510ee25f16341b3a32240dae6c05ba5860b5e5",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "60236ef65a024fb124ac49a814510ee25f16341b3a32240dae6c05ba5860b5e5",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:06:57.964 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:06:57.965 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:06:57.966 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:06:57.968 +01:00 [DBG] Issued claims: []
2017-12-10 16:06:57.976 +01:00 [DBG] Creating refresh token
2017-12-10 16:06:57.976 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:06:57.991 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:06:57.991 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:06:57.997 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****1Jww"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****239a"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****2DQQ"
    }
  ],
  "ActivityId": "0HL9VRUFI8EG7:00000007",
  "TimeStamp": "2017-12-10T15:06:57Z",
  "ProcessId": 17488,
  "LocalIpAddress": "127.0.0.1:32260",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:06:58.001 +01:00 [DBG] Token request success.
2017-12-10 16:06:58.040 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:06:58.041 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:06:58.042 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:06:58.049 +01:00 [DBG] Start userinfo request
2017-12-10 16:06:58.052 +01:00 [DBG] Bearer token found in header
2017-12-10 16:06:58.108 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:06:58.112 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512918417,
    "exp": 1512920217,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:06:58.114 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:06:58.120 +01:00 [DBG] Creating userinfo response
2017-12-10 16:06:58.124 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:06:58.127 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:06:58.127 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:06:58.128 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:06:58.128 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:06:58.129 +01:00 [DBG] End userinfo request
2017-12-10 16:08:33.251 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:08:33.253 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:08:33.255 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:08:33.258 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:08:33.258 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:08:33.259 +01:00 [DBG] Start authorize callback request
2017-12-10 16:08:33.260 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:08:33.260 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:08:33.260 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:08:33.260 +01:00 [DBG] No PKCE used.
2017-12-10 16:08:33.260 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:08:33.260 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
  "Nonce": "636485152102316219.ZTcxMDQ0ZjEtNDRjZi00NGNjLWJhNWEtOGM4ZTFlYmRiYTY3OGJjYzZkZjAtYWQ2ZS00MzBiLWJmNWEtYjhiZWZkODJhYWU1",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485152102316219.ZTcxMDQ0ZjEtNDRjZi00NGNjLWJhNWEtOGM4ZTFlYmRiYTY3OGJjYzZkZjAtYWQ2ZS00MzBiLWJmNWEtYjhiZWZkODJhYWU1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:08:33.264 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:08:33.264 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:08:33.264 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:08:33.276 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:08:33.280 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:08:33.288 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:08:33.288 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:08:33.288 +01:00 [DBG] No PKCE used.
2017-12-10 16:08:33.288 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:08:38.747 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:08:38.747 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:08:38.749 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:08:38.753 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:08:38.753 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:08:38.753 +01:00 [DBG] No PKCE used.
2017-12-10 16:08:38.753 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:08:38.761 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:08:38.763 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:08:38.765 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:08:38.765 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:08:38.765 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:08:38.767 +01:00 [DBG] Start authorize callback request
2017-12-10 16:08:38.767 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:08:38.767 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:08:38.767 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:08:38.767 +01:00 [DBG] No PKCE used.
2017-12-10 16:08:38.767 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:08:38.768 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
  "Nonce": "636485152102316219.ZTcxMDQ0ZjEtNDRjZi00NGNjLWJhNWEtOGM4ZTFlYmRiYTY3OGJjYzZkZjAtYWQ2ZS00MzBiLWJmNWEtYjhiZWZkODJhYWU1",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485152102316219.ZTcxMDQ0ZjEtNDRjZi00NGNjLWJhNWEtOGM4ZTFlYmRiYTY3OGJjYzZkZjAtYWQ2ZS00MzBiLWJmNWEtYjhiZWZkODJhYWU1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:08:38.771 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:08:38.772 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:08:38.772 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:08:38.773 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:08:38.774 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:08:38.779 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:08:38.789 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:08:38.789 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:08:38.789 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:08:38.793 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****HkwA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****df62"
    }
  ],
  "ActivityId": "0HL9VRUFI8EG8:00000004",
  "TimeStamp": "2017-12-10T15:08:38Z",
  "ProcessId": 17488,
  "LocalIpAddress": "127.0.0.1:32260",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:08:38.795 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfNNKSlIvVe7o5mvc6YlkiN-sVn7GO0I3yeSr1458h-P9g7JpR641BBtLQEN-K6xsxHNZqgTsFKmoL4YUGnIbgNwOp3Qy4TI0vRzhcfj6UFlE3zlb5yl79A6MI5YWStz0ImptHe7_u9haPJHzHqlpDyoGaSMiYGSjDC5zLX7cVfU0EPCEHjq977j0IUynNF6gueydTDGx0cK8Iu-bKxMq6XtNrwrVcJTg7QR5LV8EWNkRsOGq2oHRp8sT3iN6NlKONkqlUKxmRPn6whn55AehsyH2alq2J3-VIt8VBwwyuIfC9pvCM2WN--_O-kub0BA3E",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:09:09.696 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:09:09.698 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:10:32.955 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:10:33.006 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:10:33.010 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:10:33.010 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:10:33.010 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:10:33.011 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:11:02.765 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:11:02.774 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:11:02.774 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:11:02.778 +01:00 [DBG] Start discovery request
2017-12-10 16:11:03.130 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:11:03.131 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:11:03.131 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:11:03.137 +01:00 [DBG] Start key discovery request
2017-12-10 16:11:03.323 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:11:03.326 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:11:03.339 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:11:03.343 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:11:03.343 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:11:03.349 +01:00 [DBG] Start authorize request
2017-12-10 16:11:03.364 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:11:03.368 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:11:03.380 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:11:03.381 +01:00 [DBG] No PKCE used.
2017-12-10 16:11:03.419 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:11:03.433 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
  "Nonce": "636485154632059065.MGZiZGY2ZjYtODMxZC00NzczLWE2ZjAtOTdmMDNmMmQxNmIwNjk2MjgzNzUtOTBjZS00YWM3LWI2NDctMGVmZTc4NDQzNDc0",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485154632059065.MGZiZGY2ZjYtODMxZC00NzczLWE2ZjAtOTdmMDNmMmQxNmIwNjk2MjgzNzUtOTBjZS00YWM3LWI2NDctMGVmZTc4NDQzNDc0",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:11:03.445 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:11:03.453 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:11:03.453 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:11:03.466 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:11:03.468 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:11:03.866 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:11:03.867 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:11:03.867 +01:00 [DBG] No PKCE used.
2017-12-10 16:11:03.867 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:11:09.575 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:11:09.576 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:11:09.577 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:11:09.711 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:11:09.711 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:11:09.711 +01:00 [DBG] No PKCE used.
2017-12-10 16:11:09.711 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:11:09.747 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:11:09.749 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:11:09.750 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:11:09.751 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:11:09.751 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:11:09.759 +01:00 [DBG] Start authorize callback request
2017-12-10 16:11:09.790 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:11:09.791 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:11:09.791 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:11:09.791 +01:00 [DBG] No PKCE used.
2017-12-10 16:11:09.791 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:11:09.791 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
  "Nonce": "636485154632059065.MGZiZGY2ZjYtODMxZC00NzczLWE2ZjAtOTdmMDNmMmQxNmIwNjk2MjgzNzUtOTBjZS00YWM3LWI2NDctMGVmZTc4NDQzNDc0",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485154632059065.MGZiZGY2ZjYtODMxZC00NzczLWE2ZjAtOTdmMDNmMmQxNmIwNjk2MjgzNzUtOTBjZS00YWM3LWI2NDctMGVmZTc4NDQzNDc0",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:11:09.794 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:11:09.794 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:11:09.805 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:11:09.816 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:11:09.819 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:11:09.838 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:11:09.866 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:11:09.875 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:11:09.877 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:11:09.978 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****_gtg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****e453"
    }
  ],
  "ActivityId": "0HL9VS0KEKCNV:00000006",
  "TimeStamp": "2017-12-10T15:11:09Z",
  "ProcessId": 17924,
  "LocalIpAddress": "127.0.0.1:1503",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:11:09.984 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:11:10.244 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:11:10.248 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:11:10.248 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:11:10.259 +01:00 [DBG] Start token request.
2017-12-10 16:11:10.266 +01:00 [DBG] Start client validation
2017-12-10 16:11:10.272 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:11:10.275 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:11:10.276 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:11:10.276 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:11:10.286 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:11:10.286 +01:00 [DBG] Client validation success
2017-12-10 16:11:10.290 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VS0KEKCNV:00000007",
  "TimeStamp": "2017-12-10T15:11:10Z",
  "ProcessId": 17924,
  "LocalIpAddress": "127.0.0.1:1503",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:11:10.299 +01:00 [DBG] Start token request validation
2017-12-10 16:11:10.309 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:11:10.337 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:11:10.337 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:11:10.343 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "275c300c8492ff67ebf676127e7dc8c7b8b141e15b34bd610658411a91f8e453",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "275c300c8492ff67ebf676127e7dc8c7b8b141e15b34bd610658411a91f8e453",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:11:10.368 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:11:10.369 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:11:10.371 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:11:10.372 +01:00 [DBG] Issued claims: []
2017-12-10 16:11:10.380 +01:00 [DBG] Creating refresh token
2017-12-10 16:11:10.380 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:11:10.396 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:11:10.396 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:11:10.401 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Q1zw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****1eb5"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****3qZg"
    }
  ],
  "ActivityId": "0HL9VS0KEKCNV:00000007",
  "TimeStamp": "2017-12-10T15:11:10Z",
  "ProcessId": 17924,
  "LocalIpAddress": "127.0.0.1:1503",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:11:10.403 +01:00 [DBG] Token request success.
2017-12-10 16:11:10.441 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:11:10.442 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:11:10.442 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:11:10.450 +01:00 [DBG] Start userinfo request
2017-12-10 16:11:10.453 +01:00 [DBG] Bearer token found in header
2017-12-10 16:11:10.508 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:11:10.512 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512918670,
    "exp": 1512920470,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:11:10.513 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:11:10.519 +01:00 [DBG] Creating userinfo response
2017-12-10 16:11:10.523 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:11:10.526 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:11:10.526 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:11:10.527 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:11:10.527 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:11:10.529 +01:00 [DBG] End userinfo request
2017-12-10 16:14:02.684 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:14:02.686 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:14:02.687 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:14:02.688 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:14:02.688 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:14:02.694 +01:00 [DBG] Start authorize callback request
2017-12-10 16:14:02.694 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:14:02.694 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:14:02.694 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:14:02.694 +01:00 [DBG] No PKCE used.
2017-12-10 16:14:02.695 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:14:02.695 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
  "Nonce": "636485154632059065.MGZiZGY2ZjYtODMxZC00NzczLWE2ZjAtOTdmMDNmMmQxNmIwNjk2MjgzNzUtOTBjZS00YWM3LWI2NDctMGVmZTc4NDQzNDc0",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485154632059065.MGZiZGY2ZjYtODMxZC00NzczLWE2ZjAtOTdmMDNmMmQxNmIwNjk2MjgzNzUtOTBjZS00YWM3LWI2NDctMGVmZTc4NDQzNDc0",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:14:02.698 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:14:02.698 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:14:02.698 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:14:02.708 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:14:02.710 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:14:02.715 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:14:02.715 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:14:02.715 +01:00 [DBG] No PKCE used.
2017-12-10 16:14:02.715 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:14:04.928 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:14:04.928 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:14:04.930 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:14:04.933 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:14:04.933 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:14:04.933 +01:00 [DBG] No PKCE used.
2017-12-10 16:14:04.933 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:14:04.942 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:14:04.945 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:14:04.947 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:14:04.947 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:14:04.947 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:14:04.948 +01:00 [DBG] Start authorize callback request
2017-12-10 16:14:04.949 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:14:04.949 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:14:04.949 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:14:04.949 +01:00 [DBG] No PKCE used.
2017-12-10 16:14:04.949 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:14:04.949 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
  "Nonce": "636485154632059065.MGZiZGY2ZjYtODMxZC00NzczLWE2ZjAtOTdmMDNmMmQxNmIwNjk2MjgzNzUtOTBjZS00YWM3LWI2NDctMGVmZTc4NDQzNDc0",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485154632059065.MGZiZGY2ZjYtODMxZC00NzczLWE2ZjAtOTdmMDNmMmQxNmIwNjk2MjgzNzUtOTBjZS00YWM3LWI2NDctMGVmZTc4NDQzNDc0",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:14:04.953 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:14:04.953 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:14:04.953 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:14:04.954 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:14:04.955 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:14:04.961 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:14:04.970 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:14:04.971 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:14:04.971 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:14:04.974 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****gtng"
    },
    {
      "TokenType": "code",
      "TokenValue": "****a108"
    }
  ],
  "ActivityId": "0HL9VS0KEKCO0:00000004",
  "TimeStamp": "2017-12-10T15:14:04Z",
  "ProcessId": 17924,
  "LocalIpAddress": "127.0.0.1:1503",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:14:04.976 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcP2SttFxZTnWX9wCO9koqM4TjBXvB7AIms3uCppvtIAs8NDEZ1tQ-ICZNkx43O7-OUVD6wn8PosbxVgRmdyNHpfQbAlKNmu4VQe2cSr5I_pWn_9aWILM-GREfZur7pOd8fVx7BA1iAPaCaGSeauXIXpQjSH2uink0fk_rkTHS0OS672m8ZxPGR9Dde3HTwbC_ZcbjP0VTW1Q86YAlkPeFp-IgGOljE-FcIXX5KXwkZUjDQxs2oC2BZzYBLvBWJ9qStnkxHtCgzrp3hVWS_mxyCImROc6_-m7k-HF1UbSALYylqHpeYPrP8IQk80SeimAU",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:14:44.699 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:14:44.765 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:14:44.769 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:14:44.769 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:14:44.769 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:14:44.769 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:15:41.072 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:15:41.126 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:15:41.129 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:15:41.129 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:15:41.130 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:15:41.130 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:16:23.035 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:16:23.044 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:16:23.044 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:16:23.049 +01:00 [DBG] Start discovery request
2017-12-10 16:16:23.401 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:16:23.405 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:16:23.405 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:16:23.411 +01:00 [DBG] Start key discovery request
2017-12-10 16:16:23.586 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:16:23.588 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:16:23.602 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:16:23.607 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:16:23.607 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:16:23.613 +01:00 [DBG] Start authorize request
2017-12-10 16:16:23.633 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:16:23.637 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:16:23.650 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:16:23.651 +01:00 [DBG] No PKCE used.
2017-12-10 16:16:23.683 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:16:23.696 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqciR9XP7XwnRQKtJjluMXeMbF8CD1vM9xswXOHLQiNdVIaI_stE_vtR2jDfD0zz37zracbKdjsA1VzhZ-rVxtwqCdyLjwewYkfL6uA86ZVBCaF8pQ1KVv9Hc0QtbnyZKerdywA1gtRxBmuGbogqYEc6Htq-HBdIsweJvOabzs4ziKorqP4OXEfVhUcIBpcKPGVFJUK4VsB2GuwVj22PhrQHceBh9lP5RWZUOMwIISpBrspvl2REukfS0bk7D4OOKjmb0O7Pu2Zna__WUE_JPPYDIq-pJHUDiQjcIZNRD3j17tqoe5xd8b7xM0bUQTtqQJc",
  "Nonce": "636485157834702366.NDlmMjllNjUtNDY2Ny00ZTVmLWJlN2EtYjFmZDU3NTA2NWI4YjYwMDhhMGItM2NlYy00OTI4LTkxM2EtOTJiNjE5MTY1MGE5",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485157834702366.NDlmMjllNjUtNDY2Ny00ZTVmLWJlN2EtYjFmZDU3NTA2NWI4YjYwMDhhMGItM2NlYy00OTI4LTkxM2EtOTJiNjE5MTY1MGE5",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqciR9XP7XwnRQKtJjluMXeMbF8CD1vM9xswXOHLQiNdVIaI_stE_vtR2jDfD0zz37zracbKdjsA1VzhZ-rVxtwqCdyLjwewYkfL6uA86ZVBCaF8pQ1KVv9Hc0QtbnyZKerdywA1gtRxBmuGbogqYEc6Htq-HBdIsweJvOabzs4ziKorqP4OXEfVhUcIBpcKPGVFJUK4VsB2GuwVj22PhrQHceBh9lP5RWZUOMwIISpBrspvl2REukfS0bk7D4OOKjmb0O7Pu2Zna__WUE_JPPYDIq-pJHUDiQjcIZNRD3j17tqoe5xd8b7xM0bUQTtqQJc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:16:23.708 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:16:23.716 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:16:23.716 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:16:23.730 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:16:23.731 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:16:24.118 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:16:24.119 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:16:24.119 +01:00 [DBG] No PKCE used.
2017-12-10 16:16:24.120 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:16:34.385 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:16:34.386 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:16:34.387 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:16:34.516 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:16:34.517 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:16:34.517 +01:00 [DBG] No PKCE used.
2017-12-10 16:16:34.517 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:16:34.555 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:16:34.557 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:16:34.558 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:16:34.559 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:16:34.559 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:16:34.566 +01:00 [DBG] Start authorize callback request
2017-12-10 16:16:34.594 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:16:34.594 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:16:34.594 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:16:34.594 +01:00 [DBG] No PKCE used.
2017-12-10 16:16:34.594 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:16:34.594 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqciR9XP7XwnRQKtJjluMXeMbF8CD1vM9xswXOHLQiNdVIaI_stE_vtR2jDfD0zz37zracbKdjsA1VzhZ-rVxtwqCdyLjwewYkfL6uA86ZVBCaF8pQ1KVv9Hc0QtbnyZKerdywA1gtRxBmuGbogqYEc6Htq-HBdIsweJvOabzs4ziKorqP4OXEfVhUcIBpcKPGVFJUK4VsB2GuwVj22PhrQHceBh9lP5RWZUOMwIISpBrspvl2REukfS0bk7D4OOKjmb0O7Pu2Zna__WUE_JPPYDIq-pJHUDiQjcIZNRD3j17tqoe5xd8b7xM0bUQTtqQJc",
  "Nonce": "636485157834702366.NDlmMjllNjUtNDY2Ny00ZTVmLWJlN2EtYjFmZDU3NTA2NWI4YjYwMDhhMGItM2NlYy00OTI4LTkxM2EtOTJiNjE5MTY1MGE5",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485157834702366.NDlmMjllNjUtNDY2Ny00ZTVmLWJlN2EtYjFmZDU3NTA2NWI4YjYwMDhhMGItM2NlYy00OTI4LTkxM2EtOTJiNjE5MTY1MGE5",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqciR9XP7XwnRQKtJjluMXeMbF8CD1vM9xswXOHLQiNdVIaI_stE_vtR2jDfD0zz37zracbKdjsA1VzhZ-rVxtwqCdyLjwewYkfL6uA86ZVBCaF8pQ1KVv9Hc0QtbnyZKerdywA1gtRxBmuGbogqYEc6Htq-HBdIsweJvOabzs4ziKorqP4OXEfVhUcIBpcKPGVFJUK4VsB2GuwVj22PhrQHceBh9lP5RWZUOMwIISpBrspvl2REukfS0bk7D4OOKjmb0O7Pu2Zna__WUE_JPPYDIq-pJHUDiQjcIZNRD3j17tqoe5xd8b7xM0bUQTtqQJc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:16:34.597 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:16:34.597 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:16:34.609 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:16:34.620 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:16:34.624 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:16:34.642 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:16:34.670 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:16:34.679 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:16:34.681 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:16:34.790 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****6BGA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****731b"
    }
  ],
  "ActivityId": "0HL9VS3G9AE7J:00000006",
  "TimeStamp": "2017-12-10T15:16:34Z",
  "ProcessId": 17600,
  "LocalIpAddress": "127.0.0.1:24722",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:16:34.797 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqciR9XP7XwnRQKtJjluMXeMbF8CD1vM9xswXOHLQiNdVIaI_stE_vtR2jDfD0zz37zracbKdjsA1VzhZ-rVxtwqCdyLjwewYkfL6uA86ZVBCaF8pQ1KVv9Hc0QtbnyZKerdywA1gtRxBmuGbogqYEc6Htq-HBdIsweJvOabzs4ziKorqP4OXEfVhUcIBpcKPGVFJUK4VsB2GuwVj22PhrQHceBh9lP5RWZUOMwIISpBrspvl2REukfS0bk7D4OOKjmb0O7Pu2Zna__WUE_JPPYDIq-pJHUDiQjcIZNRD3j17tqoe5xd8b7xM0bUQTtqQJc",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:16:35.014 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:16:35.018 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:16:35.018 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:16:35.028 +01:00 [DBG] Start token request.
2017-12-10 16:16:35.033 +01:00 [DBG] Start client validation
2017-12-10 16:16:35.038 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:16:35.041 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:16:35.041 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:16:35.041 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:16:35.050 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:16:35.050 +01:00 [DBG] Client validation success
2017-12-10 16:16:35.055 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VS3G9AE7J:00000007",
  "TimeStamp": "2017-12-10T15:16:35Z",
  "ProcessId": 17600,
  "LocalIpAddress": "127.0.0.1:24722",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:16:35.064 +01:00 [DBG] Start token request validation
2017-12-10 16:16:35.077 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:16:35.106 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:16:35.107 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:16:35.112 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "896184ed0e1a319a1de7f20efa902caaf10664c649bb072ce390b466fe32731b",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "896184ed0e1a319a1de7f20efa902caaf10664c649bb072ce390b466fe32731b",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:16:35.135 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:16:35.136 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:16:35.137 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:16:35.139 +01:00 [DBG] Issued claims: []
2017-12-10 16:16:35.146 +01:00 [DBG] Creating refresh token
2017-12-10 16:16:35.146 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:16:35.164 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:16:35.164 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:16:35.171 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****ZKzg"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****0faa"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****6RHw"
    }
  ],
  "ActivityId": "0HL9VS3G9AE7J:00000007",
  "TimeStamp": "2017-12-10T15:16:35Z",
  "ProcessId": 17600,
  "LocalIpAddress": "127.0.0.1:24722",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:16:35.174 +01:00 [DBG] Token request success.
2017-12-10 16:16:35.204 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:16:35.205 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:16:35.206 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:16:35.213 +01:00 [DBG] Start userinfo request
2017-12-10 16:16:35.216 +01:00 [DBG] Bearer token found in header
2017-12-10 16:16:35.271 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:16:35.276 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512918995,
    "exp": 1512920795,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:16:35.278 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:16:35.282 +01:00 [DBG] Creating userinfo response
2017-12-10 16:16:35.286 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:16:35.290 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:16:35.290 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:16:35.291 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:16:35.291 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:16:35.293 +01:00 [DBG] End userinfo request
2017-12-10 16:18:27.762 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:18:27.816 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:18:27.819 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:18:27.819 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:18:27.819 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:18:27.820 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:18:50.620 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:18:50.627 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:18:50.628 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:18:50.632 +01:00 [DBG] Start discovery request
2017-12-10 16:18:50.975 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:18:50.979 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:18:50.979 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:18:50.984 +01:00 [DBG] Start key discovery request
2017-12-10 16:18:51.104 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:18:51.107 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:18:51.120 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:18:51.125 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:18:51.125 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:18:51.131 +01:00 [DBG] Start authorize request
2017-12-10 16:18:51.148 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:18:51.153 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:18:51.165 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:18:51.166 +01:00 [DBG] No PKCE used.
2017-12-10 16:18:51.199 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:18:51.212 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfbB1A8Fpvup-dwnlXAJwDxZP0FkWP-KT6dQ_IgBKKkhb09f1YIN264PFKope4wJT1zGHC0EgJirIFkdnv9BCPRVSw4ZYZoec7S4yHTl6hcVTmCaDHDJI2RJfduwcpEYtoCFUiwthipSQfxUWjAEZ5EB8BDutKalHscERCdE3IeDjB4JjagFAlbSpnsW_XUgU3S_H95VpzgnisOZTJtp0IfDUCRbg4Hyx42eHLE5HKHjQvUPn7rD9JLE3rhW_-4REHJnyBqMF2cVoyVLMHlFRjq0bA97bwuV1whXRCQbfTuFoVpaqu0_09VS3uyp56tXFg",
  "Nonce": "636485159310420721.MmNhYzJkMjEtZGE1ZS00N2YwLWJhYmUtZDQ5MmUyYWE2MGI0NTRkMjI4YWEtNDM2My00Y2IxLTgzNTEtYzk0ZDBiZmU1ZTkx",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485159310420721.MmNhYzJkMjEtZGE1ZS00N2YwLWJhYmUtZDQ5MmUyYWE2MGI0NTRkMjI4YWEtNDM2My00Y2IxLTgzNTEtYzk0ZDBiZmU1ZTkx",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfbB1A8Fpvup-dwnlXAJwDxZP0FkWP-KT6dQ_IgBKKkhb09f1YIN264PFKope4wJT1zGHC0EgJirIFkdnv9BCPRVSw4ZYZoec7S4yHTl6hcVTmCaDHDJI2RJfduwcpEYtoCFUiwthipSQfxUWjAEZ5EB8BDutKalHscERCdE3IeDjB4JjagFAlbSpnsW_XUgU3S_H95VpzgnisOZTJtp0IfDUCRbg4Hyx42eHLE5HKHjQvUPn7rD9JLE3rhW_-4REHJnyBqMF2cVoyVLMHlFRjq0bA97bwuV1whXRCQbfTuFoVpaqu0_09VS3uyp56tXFg",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:18:51.224 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:18:51.236 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:18:51.236 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:18:51.249 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:18:51.251 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:18:51.649 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:18:51.650 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:18:51.650 +01:00 [DBG] No PKCE used.
2017-12-10 16:18:51.651 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:18:57.526 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:18:57.526 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:18:57.528 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:18:57.659 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:18:57.659 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:18:57.659 +01:00 [DBG] No PKCE used.
2017-12-10 16:18:57.659 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:18:57.693 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:18:57.695 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:18:57.696 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:18:57.697 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:18:57.697 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:18:57.704 +01:00 [DBG] Start authorize callback request
2017-12-10 16:18:57.731 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:18:57.731 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:18:57.731 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:18:57.731 +01:00 [DBG] No PKCE used.
2017-12-10 16:18:57.732 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:18:57.732 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfbB1A8Fpvup-dwnlXAJwDxZP0FkWP-KT6dQ_IgBKKkhb09f1YIN264PFKope4wJT1zGHC0EgJirIFkdnv9BCPRVSw4ZYZoec7S4yHTl6hcVTmCaDHDJI2RJfduwcpEYtoCFUiwthipSQfxUWjAEZ5EB8BDutKalHscERCdE3IeDjB4JjagFAlbSpnsW_XUgU3S_H95VpzgnisOZTJtp0IfDUCRbg4Hyx42eHLE5HKHjQvUPn7rD9JLE3rhW_-4REHJnyBqMF2cVoyVLMHlFRjq0bA97bwuV1whXRCQbfTuFoVpaqu0_09VS3uyp56tXFg",
  "Nonce": "636485159310420721.MmNhYzJkMjEtZGE1ZS00N2YwLWJhYmUtZDQ5MmUyYWE2MGI0NTRkMjI4YWEtNDM2My00Y2IxLTgzNTEtYzk0ZDBiZmU1ZTkx",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485159310420721.MmNhYzJkMjEtZGE1ZS00N2YwLWJhYmUtZDQ5MmUyYWE2MGI0NTRkMjI4YWEtNDM2My00Y2IxLTgzNTEtYzk0ZDBiZmU1ZTkx",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfbB1A8Fpvup-dwnlXAJwDxZP0FkWP-KT6dQ_IgBKKkhb09f1YIN264PFKope4wJT1zGHC0EgJirIFkdnv9BCPRVSw4ZYZoec7S4yHTl6hcVTmCaDHDJI2RJfduwcpEYtoCFUiwthipSQfxUWjAEZ5EB8BDutKalHscERCdE3IeDjB4JjagFAlbSpnsW_XUgU3S_H95VpzgnisOZTJtp0IfDUCRbg4Hyx42eHLE5HKHjQvUPn7rD9JLE3rhW_-4REHJnyBqMF2cVoyVLMHlFRjq0bA97bwuV1whXRCQbfTuFoVpaqu0_09VS3uyp56tXFg",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:18:57.734 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:18:57.734 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:18:57.744 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:18:57.757 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:18:57.760 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:18:57.782 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:18:57.824 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:18:57.833 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:18:57.835 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:18:57.932 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****EQSw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****27da"
    }
  ],
  "ActivityId": "0HL9VS51VA6FN:00000006",
  "TimeStamp": "2017-12-10T15:18:57Z",
  "ProcessId": 17708,
  "LocalIpAddress": "127.0.0.1:12149",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:18:57.939 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfbB1A8Fpvup-dwnlXAJwDxZP0FkWP-KT6dQ_IgBKKkhb09f1YIN264PFKope4wJT1zGHC0EgJirIFkdnv9BCPRVSw4ZYZoec7S4yHTl6hcVTmCaDHDJI2RJfduwcpEYtoCFUiwthipSQfxUWjAEZ5EB8BDutKalHscERCdE3IeDjB4JjagFAlbSpnsW_XUgU3S_H95VpzgnisOZTJtp0IfDUCRbg4Hyx42eHLE5HKHjQvUPn7rD9JLE3rhW_-4REHJnyBqMF2cVoyVLMHlFRjq0bA97bwuV1whXRCQbfTuFoVpaqu0_09VS3uyp56tXFg",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:18:58.164 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:18:58.168 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:18:58.168 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:18:58.176 +01:00 [DBG] Start token request.
2017-12-10 16:18:58.181 +01:00 [DBG] Start client validation
2017-12-10 16:18:58.186 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:18:58.189 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:18:58.190 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:18:58.190 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:18:58.199 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:18:58.199 +01:00 [DBG] Client validation success
2017-12-10 16:18:58.204 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VS51VA6FN:00000007",
  "TimeStamp": "2017-12-10T15:18:58Z",
  "ProcessId": 17708,
  "LocalIpAddress": "127.0.0.1:12149",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:18:58.212 +01:00 [DBG] Start token request validation
2017-12-10 16:18:58.221 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:18:58.250 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:18:58.250 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:18:58.255 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "2d303ca40bd7401d4fb824d6e230bb23c4993a06e88ba923386b18dceee827da",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "2d303ca40bd7401d4fb824d6e230bb23c4993a06e88ba923386b18dceee827da",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:18:58.278 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:18:58.278 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:18:58.281 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:18:58.282 +01:00 [DBG] Issued claims: []
2017-12-10 16:18:58.290 +01:00 [DBG] Creating refresh token
2017-12-10 16:18:58.290 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:18:58.304 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:18:58.304 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:18:58.309 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****AZdQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****d23b"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****IpzA"
    }
  ],
  "ActivityId": "0HL9VS51VA6FN:00000007",
  "TimeStamp": "2017-12-10T15:18:58Z",
  "ProcessId": 17708,
  "LocalIpAddress": "127.0.0.1:12149",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:18:58.312 +01:00 [DBG] Token request success.
2017-12-10 16:18:58.341 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:18:58.342 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:18:58.342 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:18:58.351 +01:00 [DBG] Start userinfo request
2017-12-10 16:18:58.354 +01:00 [DBG] Bearer token found in header
2017-12-10 16:18:58.411 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:18:58.415 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512919138,
    "exp": 1512920938,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:18:58.417 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:18:58.422 +01:00 [DBG] Creating userinfo response
2017-12-10 16:18:58.426 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:18:58.429 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:18:58.429 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:18:58.430 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:18:58.431 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:18:58.432 +01:00 [DBG] End userinfo request
2017-12-10 16:33:02.460 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:33:02.520 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:33:02.523 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:33:02.523 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:33:02.524 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:33:02.524 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:33:22.520 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:33:22.528 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:33:22.528 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:33:22.533 +01:00 [DBG] Start discovery request
2017-12-10 16:33:22.866 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:33:22.871 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:33:22.872 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:33:22.879 +01:00 [DBG] Start key discovery request
2017-12-10 16:33:23.000 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:33:23.003 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:33:23.016 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:33:23.021 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:33:23.021 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:33:23.028 +01:00 [DBG] Start authorize request
2017-12-10 16:33:23.046 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:33:23.051 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:33:23.063 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:33:23.064 +01:00 [DBG] No PKCE used.
2017-12-10 16:33:23.096 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:33:23.110 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfnWVqBKE2zGGDAkrCn36JgVNDgJyDP0GXFG6IkduqjKRo6ByPhs5dWSiGJqlrX4JTiwINbgfJplb5GdQnk9VGZS2agsoXL0wciH4KQZw8vIdAvRJGN26E8K5nT9z7-rXPU6C2VXfT3AG8VXnJ8hEOcHpcJa8tlMH-aCJurabe7Gjq_fcYBtGGl-ttHrmvaycj25XUTDL5V-bWsYcCcGyN0dcYjbok8Cdtl5RCgOOcs118uw0a5uvsE16pgaE0IITa-y5qtcJy8ztJGHRFZuCxanrFCad1ZuPABbiqPj8LCQHjFEsvdqo4x07z7Ui8jkPo",
  "Nonce": "636485168029382260.M2EzYjI4Y2UtMzcxYy00ODcwLWFiN2QtMGFlMGNiN2RmZWFjMmMyOTU1MDktMzg0Yi00OTMxLTlkMDYtYTEzYjljYzM5M2M2",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485168029382260.M2EzYjI4Y2UtMzcxYy00ODcwLWFiN2QtMGFlMGNiN2RmZWFjMmMyOTU1MDktMzg0Yi00OTMxLTlkMDYtYTEzYjljYzM5M2M2",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfnWVqBKE2zGGDAkrCn36JgVNDgJyDP0GXFG6IkduqjKRo6ByPhs5dWSiGJqlrX4JTiwINbgfJplb5GdQnk9VGZS2agsoXL0wciH4KQZw8vIdAvRJGN26E8K5nT9z7-rXPU6C2VXfT3AG8VXnJ8hEOcHpcJa8tlMH-aCJurabe7Gjq_fcYBtGGl-ttHrmvaycj25XUTDL5V-bWsYcCcGyN0dcYjbok8Cdtl5RCgOOcs118uw0a5uvsE16pgaE0IITa-y5qtcJy8ztJGHRFZuCxanrFCad1ZuPABbiqPj8LCQHjFEsvdqo4x07z7Ui8jkPo",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:33:23.123 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:33:23.130 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:33:23.131 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:33:23.147 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:33:23.148 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:33:23.533 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:33:23.535 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:33:23.535 +01:00 [DBG] No PKCE used.
2017-12-10 16:33:23.535 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:33:29.623 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:33:29.624 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:33:29.626 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:33:29.751 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:33:29.752 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:33:29.752 +01:00 [DBG] No PKCE used.
2017-12-10 16:33:29.752 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:33:29.787 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:33:29.788 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:33:29.790 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:33:29.791 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:33:29.791 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:33:29.798 +01:00 [DBG] Start authorize callback request
2017-12-10 16:33:29.830 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:33:29.830 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:33:29.830 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:33:29.830 +01:00 [DBG] No PKCE used.
2017-12-10 16:33:29.830 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:33:29.830 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfnWVqBKE2zGGDAkrCn36JgVNDgJyDP0GXFG6IkduqjKRo6ByPhs5dWSiGJqlrX4JTiwINbgfJplb5GdQnk9VGZS2agsoXL0wciH4KQZw8vIdAvRJGN26E8K5nT9z7-rXPU6C2VXfT3AG8VXnJ8hEOcHpcJa8tlMH-aCJurabe7Gjq_fcYBtGGl-ttHrmvaycj25XUTDL5V-bWsYcCcGyN0dcYjbok8Cdtl5RCgOOcs118uw0a5uvsE16pgaE0IITa-y5qtcJy8ztJGHRFZuCxanrFCad1ZuPABbiqPj8LCQHjFEsvdqo4x07z7Ui8jkPo",
  "Nonce": "636485168029382260.M2EzYjI4Y2UtMzcxYy00ODcwLWFiN2QtMGFlMGNiN2RmZWFjMmMyOTU1MDktMzg0Yi00OTMxLTlkMDYtYTEzYjljYzM5M2M2",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485168029382260.M2EzYjI4Y2UtMzcxYy00ODcwLWFiN2QtMGFlMGNiN2RmZWFjMmMyOTU1MDktMzg0Yi00OTMxLTlkMDYtYTEzYjljYzM5M2M2",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfnWVqBKE2zGGDAkrCn36JgVNDgJyDP0GXFG6IkduqjKRo6ByPhs5dWSiGJqlrX4JTiwINbgfJplb5GdQnk9VGZS2agsoXL0wciH4KQZw8vIdAvRJGN26E8K5nT9z7-rXPU6C2VXfT3AG8VXnJ8hEOcHpcJa8tlMH-aCJurabe7Gjq_fcYBtGGl-ttHrmvaycj25XUTDL5V-bWsYcCcGyN0dcYjbok8Cdtl5RCgOOcs118uw0a5uvsE16pgaE0IITa-y5qtcJy8ztJGHRFZuCxanrFCad1ZuPABbiqPj8LCQHjFEsvdqo4x07z7Ui8jkPo",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:33:29.833 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:33:29.834 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:33:29.845 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:33:29.859 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:33:29.863 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:33:29.881 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:33:29.909 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:33:29.918 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:33:29.920 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:33:30.017 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****17xg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****3833"
    }
  ],
  "ActivityId": "0HL9VSD6MTUR6:00000006",
  "TimeStamp": "2017-12-10T15:33:29Z",
  "ProcessId": 10628,
  "LocalIpAddress": "127.0.0.1:18359",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:33:30.024 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfnWVqBKE2zGGDAkrCn36JgVNDgJyDP0GXFG6IkduqjKRo6ByPhs5dWSiGJqlrX4JTiwINbgfJplb5GdQnk9VGZS2agsoXL0wciH4KQZw8vIdAvRJGN26E8K5nT9z7-rXPU6C2VXfT3AG8VXnJ8hEOcHpcJa8tlMH-aCJurabe7Gjq_fcYBtGGl-ttHrmvaycj25XUTDL5V-bWsYcCcGyN0dcYjbok8Cdtl5RCgOOcs118uw0a5uvsE16pgaE0IITa-y5qtcJy8ztJGHRFZuCxanrFCad1ZuPABbiqPj8LCQHjFEsvdqo4x07z7Ui8jkPo",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:33:30.276 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:33:30.279 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:33:30.279 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:33:30.288 +01:00 [DBG] Start token request.
2017-12-10 16:33:30.294 +01:00 [DBG] Start client validation
2017-12-10 16:33:30.298 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:33:30.301 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:33:30.302 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:33:30.302 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:33:30.310 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:33:30.310 +01:00 [DBG] Client validation success
2017-12-10 16:33:30.316 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VSD6MTUR6:00000007",
  "TimeStamp": "2017-12-10T15:33:30Z",
  "ProcessId": 10628,
  "LocalIpAddress": "127.0.0.1:18359",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:33:30.323 +01:00 [DBG] Start token request validation
2017-12-10 16:33:30.332 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:33:30.361 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:33:30.361 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:33:30.366 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "f4c4f680688d2c15a2f6585e52b2d17bef3717117db762459728b02fe97b3833",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "f4c4f680688d2c15a2f6585e52b2d17bef3717117db762459728b02fe97b3833",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:33:30.390 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:33:30.390 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:33:30.392 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:33:30.393 +01:00 [DBG] Issued claims: []
2017-12-10 16:33:30.401 +01:00 [DBG] Creating refresh token
2017-12-10 16:33:30.401 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:33:30.415 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:33:30.415 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:33:30.420 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****BvYg"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****0e1e"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****Xsjw"
    }
  ],
  "ActivityId": "0HL9VSD6MTUR6:00000007",
  "TimeStamp": "2017-12-10T15:33:30Z",
  "ProcessId": 10628,
  "LocalIpAddress": "127.0.0.1:18359",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:33:30.423 +01:00 [DBG] Token request success.
2017-12-10 16:33:30.452 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:33:30.454 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:33:30.454 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:33:30.462 +01:00 [DBG] Start userinfo request
2017-12-10 16:33:30.465 +01:00 [DBG] Bearer token found in header
2017-12-10 16:33:30.523 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:33:30.527 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512920010,
    "exp": 1512921810,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:33:30.529 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:33:30.536 +01:00 [DBG] Creating userinfo response
2017-12-10 16:33:30.541 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:33:30.546 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:33:30.546 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:33:30.547 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:33:30.547 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:33:30.549 +01:00 [DBG] End userinfo request
2017-12-10 16:38:09.630 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:38:09.687 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:38:09.690 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:38:09.691 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:38:09.691 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:38:09.691 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:38:22.486 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:38:22.494 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:38:22.494 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:38:22.499 +01:00 [DBG] Start discovery request
2017-12-10 16:38:22.842 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:38:22.848 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:38:22.848 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:38:22.854 +01:00 [DBG] Start key discovery request
2017-12-10 16:38:22.975 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:38:22.978 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:38:22.997 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:38:23.005 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:38:23.005 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:38:23.012 +01:00 [DBG] Start authorize request
2017-12-10 16:38:23.034 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:38:23.039 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:38:23.051 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:38:23.052 +01:00 [DBG] No PKCE used.
2017-12-10 16:38:23.085 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:38:23.099 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeEomHj71gstYXAxiYD7jzgONVgkXJTObmv2MOk35rOvWCHxz6i9fARH7OYf8L476G2EeoHHZ0-InfbM0Hz9zFUNDvPB1EYstsT0uMIU7yf5QBhTsh6BhzuHQcmcUzsWa03QIcXHfCtyrQVZyFJO9ZNomXTCRLqoRcSAL-faDokFhE1JsgQxYc-n_JgzVGH1KkzeiTqmKyf-EL_wvT9w3GM9-PoS8-PxDnapIwEAZdr6nq1_XD0uNXyXCFND4XgNcWngBqVgJVvjLkD5moDhgXZyIqD3OJAD5QAO0kWxXLFRlZBOwxG9IgeP3SvErKOiGw",
  "Nonce": "636485171029130024.YzlkYTk3ZTgtZTViOC00MDcwLTg2ZDItMGM4YzRjZjAzZDhjNTQ4NzFjMjItMWEyZS00ZDc1LWE5YmEtZGRjNWViMmQ4ZjRm",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485171029130024.YzlkYTk3ZTgtZTViOC00MDcwLTg2ZDItMGM4YzRjZjAzZDhjNTQ4NzFjMjItMWEyZS00ZDc1LWE5YmEtZGRjNWViMmQ4ZjRm",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeEomHj71gstYXAxiYD7jzgONVgkXJTObmv2MOk35rOvWCHxz6i9fARH7OYf8L476G2EeoHHZ0-InfbM0Hz9zFUNDvPB1EYstsT0uMIU7yf5QBhTsh6BhzuHQcmcUzsWa03QIcXHfCtyrQVZyFJO9ZNomXTCRLqoRcSAL-faDokFhE1JsgQxYc-n_JgzVGH1KkzeiTqmKyf-EL_wvT9w3GM9-PoS8-PxDnapIwEAZdr6nq1_XD0uNXyXCFND4XgNcWngBqVgJVvjLkD5moDhgXZyIqD3OJAD5QAO0kWxXLFRlZBOwxG9IgeP3SvErKOiGw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:38:23.110 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:38:23.118 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:38:23.118 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:38:23.133 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:38:23.134 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:38:23.518 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:38:23.519 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:38:23.519 +01:00 [DBG] No PKCE used.
2017-12-10 16:38:23.520 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:38:29.662 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:38:29.663 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:38:29.664 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:38:29.790 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:38:29.790 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:38:29.790 +01:00 [DBG] No PKCE used.
2017-12-10 16:38:29.790 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:38:29.830 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:38:29.832 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:38:29.833 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:38:29.834 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:38:29.834 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:38:29.842 +01:00 [DBG] Start authorize callback request
2017-12-10 16:38:29.871 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:38:29.871 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:38:29.871 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:38:29.871 +01:00 [DBG] No PKCE used.
2017-12-10 16:38:29.871 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:38:29.871 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeEomHj71gstYXAxiYD7jzgONVgkXJTObmv2MOk35rOvWCHxz6i9fARH7OYf8L476G2EeoHHZ0-InfbM0Hz9zFUNDvPB1EYstsT0uMIU7yf5QBhTsh6BhzuHQcmcUzsWa03QIcXHfCtyrQVZyFJO9ZNomXTCRLqoRcSAL-faDokFhE1JsgQxYc-n_JgzVGH1KkzeiTqmKyf-EL_wvT9w3GM9-PoS8-PxDnapIwEAZdr6nq1_XD0uNXyXCFND4XgNcWngBqVgJVvjLkD5moDhgXZyIqD3OJAD5QAO0kWxXLFRlZBOwxG9IgeP3SvErKOiGw",
  "Nonce": "636485171029130024.YzlkYTk3ZTgtZTViOC00MDcwLTg2ZDItMGM4YzRjZjAzZDhjNTQ4NzFjMjItMWEyZS00ZDc1LWE5YmEtZGRjNWViMmQ4ZjRm",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485171029130024.YzlkYTk3ZTgtZTViOC00MDcwLTg2ZDItMGM4YzRjZjAzZDhjNTQ4NzFjMjItMWEyZS00ZDc1LWE5YmEtZGRjNWViMmQ4ZjRm",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeEomHj71gstYXAxiYD7jzgONVgkXJTObmv2MOk35rOvWCHxz6i9fARH7OYf8L476G2EeoHHZ0-InfbM0Hz9zFUNDvPB1EYstsT0uMIU7yf5QBhTsh6BhzuHQcmcUzsWa03QIcXHfCtyrQVZyFJO9ZNomXTCRLqoRcSAL-faDokFhE1JsgQxYc-n_JgzVGH1KkzeiTqmKyf-EL_wvT9w3GM9-PoS8-PxDnapIwEAZdr6nq1_XD0uNXyXCFND4XgNcWngBqVgJVvjLkD5moDhgXZyIqD3OJAD5QAO0kWxXLFRlZBOwxG9IgeP3SvErKOiGw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:38:29.875 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:38:29.875 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:38:29.885 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:38:29.900 +01:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: 818727
2017-12-10 16:38:29.909 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:38:29.947 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:38:29.957 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:38:29.959 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:38:30.069 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****0dwg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****59d9"
    }
  ],
  "ActivityId": "0HL9VSG25UO0A:00000006",
  "TimeStamp": "2017-12-10T15:38:30Z",
  "ProcessId": 17660,
  "LocalIpAddress": "127.0.0.1:4777",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:38:30.075 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeEomHj71gstYXAxiYD7jzgONVgkXJTObmv2MOk35rOvWCHxz6i9fARH7OYf8L476G2EeoHHZ0-InfbM0Hz9zFUNDvPB1EYstsT0uMIU7yf5QBhTsh6BhzuHQcmcUzsWa03QIcXHfCtyrQVZyFJO9ZNomXTCRLqoRcSAL-faDokFhE1JsgQxYc-n_JgzVGH1KkzeiTqmKyf-EL_wvT9w3GM9-PoS8-PxDnapIwEAZdr6nq1_XD0uNXyXCFND4XgNcWngBqVgJVvjLkD5moDhgXZyIqD3OJAD5QAO0kWxXLFRlZBOwxG9IgeP3SvErKOiGw",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:38:30.304 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:38:30.308 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:38:30.309 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:38:30.323 +01:00 [DBG] Start token request.
2017-12-10 16:38:30.329 +01:00 [DBG] Start client validation
2017-12-10 16:38:30.334 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:38:30.338 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:38:30.338 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:38:30.338 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:38:30.347 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:38:30.347 +01:00 [DBG] Client validation success
2017-12-10 16:38:30.351 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VSG25UO0A:00000007",
  "TimeStamp": "2017-12-10T15:38:30Z",
  "ProcessId": 17660,
  "LocalIpAddress": "127.0.0.1:4777",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:38:30.359 +01:00 [DBG] Start token request validation
2017-12-10 16:38:30.368 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:38:30.393 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:38:30.393 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:38:30.398 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "d9998389bc3199a612ca0bb3bb9708749d9b3ec41365ccc9ccdb41a44c5859d9",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "d9998389bc3199a612ca0bb3bb9708749d9b3ec41365ccc9ccdb41a44c5859d9",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:38:30.422 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:38:30.423 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:38:30.425 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:38:30.427 +01:00 [DBG] Issued claims: []
2017-12-10 16:38:30.434 +01:00 [DBG] Creating refresh token
2017-12-10 16:38:30.434 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:38:30.448 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:38:30.449 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:38:30.453 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****MFmQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****cf66"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****1yPA"
    }
  ],
  "ActivityId": "0HL9VSG25UO0A:00000007",
  "TimeStamp": "2017-12-10T15:38:30Z",
  "ProcessId": 17660,
  "LocalIpAddress": "127.0.0.1:4777",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:38:30.457 +01:00 [DBG] Token request success.
2017-12-10 16:38:30.485 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:38:30.486 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:38:30.486 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:38:30.494 +01:00 [DBG] Start userinfo request
2017-12-10 16:38:30.497 +01:00 [DBG] Bearer token found in header
2017-12-10 16:38:30.558 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:38:30.561 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512920310,
    "exp": 1512922110,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:38:30.563 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:38:30.568 +01:00 [DBG] Creating userinfo response
2017-12-10 16:38:30.573 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:38:30.576 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:38:30.576 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:38:30.577 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:38:30.577 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:38:30.579 +01:00 [DBG] End userinfo request
2017-12-10 16:39:42.642 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:39:42.644 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:39:42.645 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:39:42.646 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:39:42.646 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:39:42.647 +01:00 [DBG] Start authorize request
2017-12-10 16:39:42.648 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:39:42.648 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:39:42.648 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:39:42.648 +01:00 [DBG] No PKCE used.
2017-12-10 16:39:42.648 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:39:42.648 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf7bt8Lu8L-xPC0YiKnW6qXk8MdJHaD9O72FwneuS0UJUcQFAa-FGc1qDKBEJ2QhIXIhGLxDq5xfTmnlnXYz8oASyhyPfcd7cq-iSnqWor9218hOJpRnrDgs601SOBzfW9h5jH-4oxe5b6eyAElazFNBcguGMnTpkyaSlOU6COhD29mjIwmUnrjwjXLq3RGV_Gz6T2Tous1u4OIIYkOdBmIAEYRESVJAyjqX8ggQsaNvaRDolcuRKJnrXjO-P80uk0ilqOYlBnccvBSx1SNDgrjuHgTemCpH3AWkzC1wRiHGUySfCsze1QUIOv5NiW1rmI",
  "Nonce": "636485171826293873.Yjc1NTY3ZjgtZTg1Ni00ZmFkLWE4MjUtNDNiN2ViYjFmMWIyMWFiZGQ5YTUtN2M1YS00ODUyLWEyZDYtOGRmODNhNDcyMjVj",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485171826293873.Yjc1NTY3ZjgtZTg1Ni00ZmFkLWE4MjUtNDNiN2ViYjFmMWIyMWFiZGQ5YTUtN2M1YS00ODUyLWEyZDYtOGRmODNhNDcyMjVj",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf7bt8Lu8L-xPC0YiKnW6qXk8MdJHaD9O72FwneuS0UJUcQFAa-FGc1qDKBEJ2QhIXIhGLxDq5xfTmnlnXYz8oASyhyPfcd7cq-iSnqWor9218hOJpRnrDgs601SOBzfW9h5jH-4oxe5b6eyAElazFNBcguGMnTpkyaSlOU6COhD29mjIwmUnrjwjXLq3RGV_Gz6T2Tous1u4OIIYkOdBmIAEYRESVJAyjqX8ggQsaNvaRDolcuRKJnrXjO-P80uk0ilqOYlBnccvBSx1SNDgrjuHgTemCpH3AWkzC1wRiHGUySfCsze1QUIOv5NiW1rmI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:39:42.651 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:39:42.652 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:39:42.652 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:39:42.659 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:39:42.661 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:39:42.666 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:39:42.666 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:39:42.666 +01:00 [DBG] No PKCE used.
2017-12-10 16:39:42.666 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:39:45.623 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:39:45.623 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:39:45.625 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:39:45.628 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:39:45.628 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:39:45.628 +01:00 [DBG] No PKCE used.
2017-12-10 16:39:45.629 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:39:45.641 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:39:45.643 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:39:45.645 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:39:45.645 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:39:45.645 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:39:45.648 +01:00 [DBG] Start authorize callback request
2017-12-10 16:39:45.650 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:39:45.650 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:39:45.650 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:39:45.650 +01:00 [DBG] No PKCE used.
2017-12-10 16:39:45.650 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:39:45.650 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf7bt8Lu8L-xPC0YiKnW6qXk8MdJHaD9O72FwneuS0UJUcQFAa-FGc1qDKBEJ2QhIXIhGLxDq5xfTmnlnXYz8oASyhyPfcd7cq-iSnqWor9218hOJpRnrDgs601SOBzfW9h5jH-4oxe5b6eyAElazFNBcguGMnTpkyaSlOU6COhD29mjIwmUnrjwjXLq3RGV_Gz6T2Tous1u4OIIYkOdBmIAEYRESVJAyjqX8ggQsaNvaRDolcuRKJnrXjO-P80uk0ilqOYlBnccvBSx1SNDgrjuHgTemCpH3AWkzC1wRiHGUySfCsze1QUIOv5NiW1rmI",
  "Nonce": "636485171826293873.Yjc1NTY3ZjgtZTg1Ni00ZmFkLWE4MjUtNDNiN2ViYjFmMWIyMWFiZGQ5YTUtN2M1YS00ODUyLWEyZDYtOGRmODNhNDcyMjVj",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485171826293873.Yjc1NTY3ZjgtZTg1Ni00ZmFkLWE4MjUtNDNiN2ViYjFmMWIyMWFiZGQ5YTUtN2M1YS00ODUyLWEyZDYtOGRmODNhNDcyMjVj",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf7bt8Lu8L-xPC0YiKnW6qXk8MdJHaD9O72FwneuS0UJUcQFAa-FGc1qDKBEJ2QhIXIhGLxDq5xfTmnlnXYz8oASyhyPfcd7cq-iSnqWor9218hOJpRnrDgs601SOBzfW9h5jH-4oxe5b6eyAElazFNBcguGMnTpkyaSlOU6COhD29mjIwmUnrjwjXLq3RGV_Gz6T2Tous1u4OIIYkOdBmIAEYRESVJAyjqX8ggQsaNvaRDolcuRKJnrXjO-P80uk0ilqOYlBnccvBSx1SNDgrjuHgTemCpH3AWkzC1wRiHGUySfCsze1QUIOv5NiW1rmI",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:39:45.654 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:39:45.654 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:39:45.654 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:39:45.656 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:39:45.656 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:39:45.663 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:39:45.676 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:39:45.676 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:39:45.676 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:39:45.680 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****mIjQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****3a25"
    }
  ],
  "ActivityId": "0HL9VSG25UO0B:00000004",
  "TimeStamp": "2017-12-10T15:39:45Z",
  "ProcessId": 17660,
  "LocalIpAddress": "127.0.0.1:4777",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:39:45.682 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf7bt8Lu8L-xPC0YiKnW6qXk8MdJHaD9O72FwneuS0UJUcQFAa-FGc1qDKBEJ2QhIXIhGLxDq5xfTmnlnXYz8oASyhyPfcd7cq-iSnqWor9218hOJpRnrDgs601SOBzfW9h5jH-4oxe5b6eyAElazFNBcguGMnTpkyaSlOU6COhD29mjIwmUnrjwjXLq3RGV_Gz6T2Tous1u4OIIYkOdBmIAEYRESVJAyjqX8ggQsaNvaRDolcuRKJnrXjO-P80uk0ilqOYlBnccvBSx1SNDgrjuHgTemCpH3AWkzC1wRiHGUySfCsze1QUIOv5NiW1rmI",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:39:45.728 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:39:45.729 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:39:45.729 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:39:45.733 +01:00 [DBG] Start token request.
2017-12-10 16:39:45.733 +01:00 [DBG] Start client validation
2017-12-10 16:39:45.733 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:39:45.733 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:39:45.734 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:39:45.734 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:39:45.735 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:39:45.735 +01:00 [DBG] Client validation success
2017-12-10 16:39:45.735 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VSG25UO0B:00000005",
  "TimeStamp": "2017-12-10T15:39:45Z",
  "ProcessId": 17660,
  "LocalIpAddress": "127.0.0.1:4777",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:39:45.738 +01:00 [DBG] Start token request validation
2017-12-10 16:39:45.738 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:39:45.759 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:39:45.759 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:39:45.759 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "4ebe61e4512a4ec5ffdfbf4ef4f49aa64575aee7687c95873522af894c213a25",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "4ebe61e4512a4ec5ffdfbf4ef4f49aa64575aee7687c95873522af894c213a25",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:39:45.761 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:39:45.761 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:39:45.761 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:39:45.761 +01:00 [DBG] Issued claims: []
2017-12-10 16:39:45.765 +01:00 [DBG] Creating refresh token
2017-12-10 16:39:45.765 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:39:45.779 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:39:45.779 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:39:45.783 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Fj5g"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****4d35"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****60-w"
    }
  ],
  "ActivityId": "0HL9VSG25UO0B:00000005",
  "TimeStamp": "2017-12-10T15:39:45Z",
  "ProcessId": 17660,
  "LocalIpAddress": "127.0.0.1:4777",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:39:45.787 +01:00 [DBG] Token request success.
2017-12-10 16:39:45.795 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:39:45.795 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:39:45.796 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:39:45.798 +01:00 [DBG] Start userinfo request
2017-12-10 16:39:45.798 +01:00 [DBG] Bearer token found in header
2017-12-10 16:39:45.801 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:39:45.801 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512920385,
    "exp": 1512922185,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:39:45.801 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:39:45.801 +01:00 [DBG] Creating userinfo response
2017-12-10 16:39:45.801 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:39:45.801 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:39:45.801 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:39:45.802 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:39:45.802 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:39:45.803 +01:00 [DBG] End userinfo request
2017-12-10 16:43:01.248 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:43:01.315 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:43:01.319 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:43:01.320 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:43:01.320 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:43:01.320 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:43:14.589 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:43:14.597 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:43:14.597 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:43:14.602 +01:00 [DBG] Start discovery request
2017-12-10 16:43:14.951 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:43:14.957 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:43:14.958 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:43:14.964 +01:00 [DBG] Start key discovery request
2017-12-10 16:43:15.087 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:43:15.090 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:43:15.104 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:43:15.109 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:43:15.109 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:43:15.114 +01:00 [DBG] Start authorize request
2017-12-10 16:43:15.128 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:43:15.134 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:43:15.152 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:43:15.154 +01:00 [DBG] No PKCE used.
2017-12-10 16:43:15.201 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:43:15.215 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf0ARuyKp7j7QNQqngst9POclRTr4LnVMEPkHPwcszRzm6o729ZFePh-EPpSSQa39mV3e-S7Tuyd4zCt28U9ePdiiyaqrFNLs7sV5pOhL2G4QnPl31lNfdcFecCiqbD7QJu85Kubin_vqPaulr38qY3sS3GREcnYdqIWH5aCWO0RENfSvcDVpP4y4ktFhDiv-teEBgm_MO80w-gIZmHCGsmXTmSLexG7z-MZXqG-dmwHdroZtQwIyaeQOKvflDZZREn0UQuBLD3aFfHHYqutFKiMPML-VtJwKQbCIqLw8obaJANKsM9p7l5irp1Qu2hVQk",
  "Nonce": "636485173950267100.YTNmYTNiNjktOWUxMC00YjI5LWExYzUtODQ0NWQyMGIwNWRhOTU3MWJmZTEtOGIwMS00ZjQ3LWE0NmYtOWI3MWM0YzhhYzQx",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485173950267100.YTNmYTNiNjktOWUxMC00YjI5LWExYzUtODQ0NWQyMGIwNWRhOTU3MWJmZTEtOGIwMS00ZjQ3LWE0NmYtOWI3MWM0YzhhYzQx",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf0ARuyKp7j7QNQqngst9POclRTr4LnVMEPkHPwcszRzm6o729ZFePh-EPpSSQa39mV3e-S7Tuyd4zCt28U9ePdiiyaqrFNLs7sV5pOhL2G4QnPl31lNfdcFecCiqbD7QJu85Kubin_vqPaulr38qY3sS3GREcnYdqIWH5aCWO0RENfSvcDVpP4y4ktFhDiv-teEBgm_MO80w-gIZmHCGsmXTmSLexG7z-MZXqG-dmwHdroZtQwIyaeQOKvflDZZREn0UQuBLD3aFfHHYqutFKiMPML-VtJwKQbCIqLw8obaJANKsM9p7l5irp1Qu2hVQk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:43:15.231 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:43:15.239 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:43:15.239 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:43:15.252 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:43:15.254 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:43:15.651 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:43:15.652 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:43:15.652 +01:00 [DBG] No PKCE used.
2017-12-10 16:43:15.652 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:43:23.847 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:43:23.847 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:43:23.849 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:43:23.974 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:43:23.974 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:43:23.975 +01:00 [DBG] No PKCE used.
2017-12-10 16:43:23.975 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:43:24.011 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:43:24.013 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:43:24.014 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:43:24.015 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:43:24.015 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:43:24.023 +01:00 [DBG] Start authorize callback request
2017-12-10 16:43:24.051 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:43:24.051 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:43:24.051 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:43:24.051 +01:00 [DBG] No PKCE used.
2017-12-10 16:43:24.051 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:43:24.051 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf0ARuyKp7j7QNQqngst9POclRTr4LnVMEPkHPwcszRzm6o729ZFePh-EPpSSQa39mV3e-S7Tuyd4zCt28U9ePdiiyaqrFNLs7sV5pOhL2G4QnPl31lNfdcFecCiqbD7QJu85Kubin_vqPaulr38qY3sS3GREcnYdqIWH5aCWO0RENfSvcDVpP4y4ktFhDiv-teEBgm_MO80w-gIZmHCGsmXTmSLexG7z-MZXqG-dmwHdroZtQwIyaeQOKvflDZZREn0UQuBLD3aFfHHYqutFKiMPML-VtJwKQbCIqLw8obaJANKsM9p7l5irp1Qu2hVQk",
  "Nonce": "636485173950267100.YTNmYTNiNjktOWUxMC00YjI5LWExYzUtODQ0NWQyMGIwNWRhOTU3MWJmZTEtOGIwMS00ZjQ3LWE0NmYtOWI3MWM0YzhhYzQx",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485173950267100.YTNmYTNiNjktOWUxMC00YjI5LWExYzUtODQ0NWQyMGIwNWRhOTU3MWJmZTEtOGIwMS00ZjQ3LWE0NmYtOWI3MWM0YzhhYzQx",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf0ARuyKp7j7QNQqngst9POclRTr4LnVMEPkHPwcszRzm6o729ZFePh-EPpSSQa39mV3e-S7Tuyd4zCt28U9ePdiiyaqrFNLs7sV5pOhL2G4QnPl31lNfdcFecCiqbD7QJu85Kubin_vqPaulr38qY3sS3GREcnYdqIWH5aCWO0RENfSvcDVpP4y4ktFhDiv-teEBgm_MO80w-gIZmHCGsmXTmSLexG7z-MZXqG-dmwHdroZtQwIyaeQOKvflDZZREn0UQuBLD3aFfHHYqutFKiMPML-VtJwKQbCIqLw8obaJANKsM9p7l5irp1Qu2hVQk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:43:24.054 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:43:24.054 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:43:24.067 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:43:24.084 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:43:24.089 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:43:24.108 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:43:24.136 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:43:24.146 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:43:24.149 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:43:24.251 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****yy0g"
    },
    {
      "TokenType": "code",
      "TokenValue": "****1989"
    }
  ],
  "ActivityId": "0HL9VSIP56U3K:00000006",
  "TimeStamp": "2017-12-10T15:43:24Z",
  "ProcessId": 12456,
  "LocalIpAddress": "127.0.0.1:7544",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:43:24.257 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqf0ARuyKp7j7QNQqngst9POclRTr4LnVMEPkHPwcszRzm6o729ZFePh-EPpSSQa39mV3e-S7Tuyd4zCt28U9ePdiiyaqrFNLs7sV5pOhL2G4QnPl31lNfdcFecCiqbD7QJu85Kubin_vqPaulr38qY3sS3GREcnYdqIWH5aCWO0RENfSvcDVpP4y4ktFhDiv-teEBgm_MO80w-gIZmHCGsmXTmSLexG7z-MZXqG-dmwHdroZtQwIyaeQOKvflDZZREn0UQuBLD3aFfHHYqutFKiMPML-VtJwKQbCIqLw8obaJANKsM9p7l5irp1Qu2hVQk",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:43:24.471 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:43:24.475 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:43:24.475 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:43:24.487 +01:00 [DBG] Start token request.
2017-12-10 16:43:24.494 +01:00 [DBG] Start client validation
2017-12-10 16:43:24.499 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:43:24.502 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:43:24.503 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:43:24.503 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:43:24.513 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:43:24.513 +01:00 [DBG] Client validation success
2017-12-10 16:43:24.518 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VSIP56U3K:00000007",
  "TimeStamp": "2017-12-10T15:43:24Z",
  "ProcessId": 12456,
  "LocalIpAddress": "127.0.0.1:7544",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:43:24.526 +01:00 [DBG] Start token request validation
2017-12-10 16:43:24.535 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:43:24.562 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:43:24.562 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:43:24.567 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "ca78aef3ad1a9fa3e9e03224d275f89e16a1682e03c187bed5b13188f2691989",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "ca78aef3ad1a9fa3e9e03224d275f89e16a1682e03c187bed5b13188f2691989",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:43:24.590 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:43:24.591 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:43:24.593 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:43:24.594 +01:00 [DBG] Issued claims: []
2017-12-10 16:43:24.602 +01:00 [DBG] Creating refresh token
2017-12-10 16:43:24.602 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:43:24.617 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:43:24.618 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:43:24.622 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Yfsw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****7009"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****EQjg"
    }
  ],
  "ActivityId": "0HL9VSIP56U3K:00000007",
  "TimeStamp": "2017-12-10T15:43:24Z",
  "ProcessId": 12456,
  "LocalIpAddress": "127.0.0.1:7544",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:43:24.625 +01:00 [DBG] Token request success.
2017-12-10 16:43:24.653 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:43:24.655 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:43:24.655 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:43:24.663 +01:00 [DBG] Start userinfo request
2017-12-10 16:43:24.666 +01:00 [DBG] Bearer token found in header
2017-12-10 16:43:24.725 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:43:24.729 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512920604,
    "exp": 1512922404,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:43:24.730 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:43:24.736 +01:00 [DBG] Creating userinfo response
2017-12-10 16:43:24.742 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:43:24.746 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:43:24.747 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:43:24.748 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:43:24.748 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:43:24.750 +01:00 [DBG] End userinfo request
2017-12-10 16:46:07.589 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:46:07.661 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:46:07.664 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:46:07.664 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:46:07.664 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:46:07.665 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:48:03.933 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:48:03.991 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:48:03.994 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:48:03.995 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:48:03.995 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:48:03.995 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:48:41.482 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:48:41.490 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:48:41.490 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:48:41.495 +01:00 [DBG] Start discovery request
2017-12-10 16:48:41.841 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:48:41.847 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:48:41.848 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:48:41.853 +01:00 [DBG] Start key discovery request
2017-12-10 16:48:41.983 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:48:41.986 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:48:41.999 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:48:42.004 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:48:42.004 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:48:42.009 +01:00 [DBG] Start authorize request
2017-12-10 16:48:42.024 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:48:42.028 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:48:42.040 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:48:42.042 +01:00 [DBG] No PKCE used.
2017-12-10 16:48:42.074 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:48:42.087 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfDu8YtsDXYFOiHYn9AgqsSdQ3hPLLgTrlfcCOM9f2fhNk3DXQHNBRCMlt_qx_7f1iPNXNpG_m-jfXckle0-K2qhfRE2qJ0zbcCtYZ1xlHPzQsO-glqLjIH8JFzokGLOseat9-CxrzxSr2oxYlSY2Nv035GhT296UszWtzXKH05ucdkPzGiLPm1Kb1bkEhyiCT1cUf3ErgLAmhGZlRZN_tpcwTeSSvy28nr7lwxoPukVWbKa2X5MhFYzvI9DHPXVKVHvQuYDnk2sZdxLAUwkWf2djxoHNYiSuUKYXXC8ZgfQn_7mnhpz_kp9oTF-faqlVQ",
  "Nonce": "636485177219116686.MmJhMzk2MzgtMjY0Mi00YjBhLTk4ZTUtODhhOWMxZDM1MzYxM2NjZjFiY2ItYmYwMS00MjdhLThiYjAtZmY0Y2I4Zjg1MmM2",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485177219116686.MmJhMzk2MzgtMjY0Mi00YjBhLTk4ZTUtODhhOWMxZDM1MzYxM2NjZjFiY2ItYmYwMS00MjdhLThiYjAtZmY0Y2I4Zjg1MmM2",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfDu8YtsDXYFOiHYn9AgqsSdQ3hPLLgTrlfcCOM9f2fhNk3DXQHNBRCMlt_qx_7f1iPNXNpG_m-jfXckle0-K2qhfRE2qJ0zbcCtYZ1xlHPzQsO-glqLjIH8JFzokGLOseat9-CxrzxSr2oxYlSY2Nv035GhT296UszWtzXKH05ucdkPzGiLPm1Kb1bkEhyiCT1cUf3ErgLAmhGZlRZN_tpcwTeSSvy28nr7lwxoPukVWbKa2X5MhFYzvI9DHPXVKVHvQuYDnk2sZdxLAUwkWf2djxoHNYiSuUKYXXC8ZgfQn_7mnhpz_kp9oTF-faqlVQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:48:42.100 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:48:42.107 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:48:42.107 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:48:42.121 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:48:42.123 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:48:42.524 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:48:42.525 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:48:42.525 +01:00 [DBG] No PKCE used.
2017-12-10 16:48:42.525 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:48:56.931 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:48:56.931 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:48:56.933 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:48:57.074 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:48:57.074 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:48:57.074 +01:00 [DBG] No PKCE used.
2017-12-10 16:48:57.074 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:48:57.109 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:48:57.110 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:48:57.112 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:48:57.113 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:48:57.113 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:48:57.120 +01:00 [DBG] Start authorize callback request
2017-12-10 16:48:57.149 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:48:57.149 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:48:57.149 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:48:57.149 +01:00 [DBG] No PKCE used.
2017-12-10 16:48:57.149 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:48:57.149 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfDu8YtsDXYFOiHYn9AgqsSdQ3hPLLgTrlfcCOM9f2fhNk3DXQHNBRCMlt_qx_7f1iPNXNpG_m-jfXckle0-K2qhfRE2qJ0zbcCtYZ1xlHPzQsO-glqLjIH8JFzokGLOseat9-CxrzxSr2oxYlSY2Nv035GhT296UszWtzXKH05ucdkPzGiLPm1Kb1bkEhyiCT1cUf3ErgLAmhGZlRZN_tpcwTeSSvy28nr7lwxoPukVWbKa2X5MhFYzvI9DHPXVKVHvQuYDnk2sZdxLAUwkWf2djxoHNYiSuUKYXXC8ZgfQn_7mnhpz_kp9oTF-faqlVQ",
  "Nonce": "636485177219116686.MmJhMzk2MzgtMjY0Mi00YjBhLTk4ZTUtODhhOWMxZDM1MzYxM2NjZjFiY2ItYmYwMS00MjdhLThiYjAtZmY0Y2I4Zjg1MmM2",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485177219116686.MmJhMzk2MzgtMjY0Mi00YjBhLTk4ZTUtODhhOWMxZDM1MzYxM2NjZjFiY2ItYmYwMS00MjdhLThiYjAtZmY0Y2I4Zjg1MmM2",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfDu8YtsDXYFOiHYn9AgqsSdQ3hPLLgTrlfcCOM9f2fhNk3DXQHNBRCMlt_qx_7f1iPNXNpG_m-jfXckle0-K2qhfRE2qJ0zbcCtYZ1xlHPzQsO-glqLjIH8JFzokGLOseat9-CxrzxSr2oxYlSY2Nv035GhT296UszWtzXKH05ucdkPzGiLPm1Kb1bkEhyiCT1cUf3ErgLAmhGZlRZN_tpcwTeSSvy28nr7lwxoPukVWbKa2X5MhFYzvI9DHPXVKVHvQuYDnk2sZdxLAUwkWf2djxoHNYiSuUKYXXC8ZgfQn_7mnhpz_kp9oTF-faqlVQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:48:57.152 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:48:57.152 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:48:57.164 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:48:57.177 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:48:57.182 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:48:57.205 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:48:57.249 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:48:57.259 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:48:57.261 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:48:57.358 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****veCQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****3e02"
    }
  ],
  "ActivityId": "0HL9VSLJ9JN53:00000006",
  "TimeStamp": "2017-12-10T15:48:57Z",
  "ProcessId": 2144,
  "LocalIpAddress": "127.0.0.1:12136",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:48:57.365 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqfDu8YtsDXYFOiHYn9AgqsSdQ3hPLLgTrlfcCOM9f2fhNk3DXQHNBRCMlt_qx_7f1iPNXNpG_m-jfXckle0-K2qhfRE2qJ0zbcCtYZ1xlHPzQsO-glqLjIH8JFzokGLOseat9-CxrzxSr2oxYlSY2Nv035GhT296UszWtzXKH05ucdkPzGiLPm1Kb1bkEhyiCT1cUf3ErgLAmhGZlRZN_tpcwTeSSvy28nr7lwxoPukVWbKa2X5MhFYzvI9DHPXVKVHvQuYDnk2sZdxLAUwkWf2djxoHNYiSuUKYXXC8ZgfQn_7mnhpz_kp9oTF-faqlVQ",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:48:57.593 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:48:57.597 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:48:57.597 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:48:57.606 +01:00 [DBG] Start token request.
2017-12-10 16:48:57.611 +01:00 [DBG] Start client validation
2017-12-10 16:48:57.617 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:48:57.620 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:48:57.621 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:48:57.621 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:48:57.629 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:48:57.629 +01:00 [DBG] Client validation success
2017-12-10 16:48:57.634 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VSLJ9JN53:00000007",
  "TimeStamp": "2017-12-10T15:48:57Z",
  "ProcessId": 2144,
  "LocalIpAddress": "127.0.0.1:12136",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:48:57.641 +01:00 [DBG] Start token request validation
2017-12-10 16:48:57.651 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:48:57.679 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:48:57.679 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:48:57.684 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "c8a8874572c5fa8833e1dd3e6f6c771cc78076a82808f068db3f06d58b713e02",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "c8a8874572c5fa8833e1dd3e6f6c771cc78076a82808f068db3f06d58b713e02",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:48:57.709 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:48:57.709 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:48:57.711 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:48:57.713 +01:00 [DBG] Issued claims: []
2017-12-10 16:48:57.720 +01:00 [DBG] Creating refresh token
2017-12-10 16:48:57.720 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:48:57.738 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:48:57.738 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:48:57.744 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****MCIw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****e09a"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****NTtA"
    }
  ],
  "ActivityId": "0HL9VSLJ9JN53:00000007",
  "TimeStamp": "2017-12-10T15:48:57Z",
  "ProcessId": 2144,
  "LocalIpAddress": "127.0.0.1:12136",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:48:57.748 +01:00 [DBG] Token request success.
2017-12-10 16:48:57.781 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:48:57.783 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:48:57.783 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:48:57.791 +01:00 [DBG] Start userinfo request
2017-12-10 16:48:57.794 +01:00 [DBG] Bearer token found in header
2017-12-10 16:48:57.853 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:48:57.857 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512920937,
    "exp": 1512922737,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:48:57.858 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:48:57.864 +01:00 [DBG] Creating userinfo response
2017-12-10 16:48:57.868 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:48:57.870 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:48:57.871 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:48:57.871 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:48:57.872 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:48:57.873 +01:00 [DBG] End userinfo request
2017-12-10 16:51:26.454 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:51:26.512 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:51:26.516 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:51:26.516 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:51:26.516 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:51:26.516 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:51:44.012 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:51:44.020 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:51:44.021 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:51:44.026 +01:00 [DBG] Start discovery request
2017-12-10 16:51:44.379 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:51:44.383 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:51:44.383 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:51:44.389 +01:00 [DBG] Start key discovery request
2017-12-10 16:51:44.509 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:51:44.512 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:51:44.531 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:51:44.538 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:51:44.538 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:51:44.550 +01:00 [DBG] Start authorize request
2017-12-10 16:51:44.567 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:51:44.573 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:51:44.584 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:51:44.585 +01:00 [DBG] No PKCE used.
2017-12-10 16:51:44.618 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:51:44.633 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcThsZtjzo_jaT4U68XNGMyIXTTzs8qHkJ9m3S-jhs6s2Z2D1_cJylW8s-Z6X_vywfNB_2UFhOlvz3IbCEv2o8RMNE92vKA1R3Yp5IRpyp_kYsA8rUndC_8Ne_FYIl1uYTVkUEYVXRYG7VnIUaHVE_m0mcYNanxjRtx-Z-IC6PlHLGX0bqWpjs64yz7Rk5BzZBtrSe_BWQ-y8YpBmheoNFAy5XJvkXi7BhNqMFaK2gUNdcgD-IlbwTZEnbfqTDz2QTpspO5fLXO4PqFTrzTaqmk6ltBnG8SE5MMGeXh9FkykQuN8T5Vr61GWHcVKRH95k4",
  "Nonce": "636485179044467029.MzU4ZDE3NmQtMTA0Mi00YWY2LTkzZGItMDM3NmZlNmNlMjVhYzgwMjU5MDktOWY5Ny00NDkzLWJjNjItNTJhNTNhM2I2ZTM3",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485179044467029.MzU4ZDE3NmQtMTA0Mi00YWY2LTkzZGItMDM3NmZlNmNlMjVhYzgwMjU5MDktOWY5Ny00NDkzLWJjNjItNTJhNTNhM2I2ZTM3",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcThsZtjzo_jaT4U68XNGMyIXTTzs8qHkJ9m3S-jhs6s2Z2D1_cJylW8s-Z6X_vywfNB_2UFhOlvz3IbCEv2o8RMNE92vKA1R3Yp5IRpyp_kYsA8rUndC_8Ne_FYIl1uYTVkUEYVXRYG7VnIUaHVE_m0mcYNanxjRtx-Z-IC6PlHLGX0bqWpjs64yz7Rk5BzZBtrSe_BWQ-y8YpBmheoNFAy5XJvkXi7BhNqMFaK2gUNdcgD-IlbwTZEnbfqTDz2QTpspO5fLXO4PqFTrzTaqmk6ltBnG8SE5MMGeXh9FkykQuN8T5Vr61GWHcVKRH95k4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:51:44.645 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:51:44.654 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:51:44.654 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:51:44.668 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:51:44.670 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:51:45.054 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:51:45.055 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:51:45.055 +01:00 [DBG] No PKCE used.
2017-12-10 16:51:45.055 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:51:50.479 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:51:50.479 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:51:50.480 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:51:50.611 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:51:50.611 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:51:50.611 +01:00 [DBG] No PKCE used.
2017-12-10 16:51:50.611 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:51:50.646 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:51:50.648 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:51:50.650 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:51:50.651 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:51:50.651 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:51:50.658 +01:00 [DBG] Start authorize callback request
2017-12-10 16:51:50.685 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:51:50.685 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:51:50.685 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:51:50.685 +01:00 [DBG] No PKCE used.
2017-12-10 16:51:50.685 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:51:50.686 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcThsZtjzo_jaT4U68XNGMyIXTTzs8qHkJ9m3S-jhs6s2Z2D1_cJylW8s-Z6X_vywfNB_2UFhOlvz3IbCEv2o8RMNE92vKA1R3Yp5IRpyp_kYsA8rUndC_8Ne_FYIl1uYTVkUEYVXRYG7VnIUaHVE_m0mcYNanxjRtx-Z-IC6PlHLGX0bqWpjs64yz7Rk5BzZBtrSe_BWQ-y8YpBmheoNFAy5XJvkXi7BhNqMFaK2gUNdcgD-IlbwTZEnbfqTDz2QTpspO5fLXO4PqFTrzTaqmk6ltBnG8SE5MMGeXh9FkykQuN8T5Vr61GWHcVKRH95k4",
  "Nonce": "636485179044467029.MzU4ZDE3NmQtMTA0Mi00YWY2LTkzZGItMDM3NmZlNmNlMjVhYzgwMjU5MDktOWY5Ny00NDkzLWJjNjItNTJhNTNhM2I2ZTM3",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485179044467029.MzU4ZDE3NmQtMTA0Mi00YWY2LTkzZGItMDM3NmZlNmNlMjVhYzgwMjU5MDktOWY5Ny00NDkzLWJjNjItNTJhNTNhM2I2ZTM3",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcThsZtjzo_jaT4U68XNGMyIXTTzs8qHkJ9m3S-jhs6s2Z2D1_cJylW8s-Z6X_vywfNB_2UFhOlvz3IbCEv2o8RMNE92vKA1R3Yp5IRpyp_kYsA8rUndC_8Ne_FYIl1uYTVkUEYVXRYG7VnIUaHVE_m0mcYNanxjRtx-Z-IC6PlHLGX0bqWpjs64yz7Rk5BzZBtrSe_BWQ-y8YpBmheoNFAy5XJvkXi7BhNqMFaK2gUNdcgD-IlbwTZEnbfqTDz2QTpspO5fLXO4PqFTrzTaqmk6ltBnG8SE5MMGeXh9FkykQuN8T5Vr61GWHcVKRH95k4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:51:50.689 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:51:50.689 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:51:50.700 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:51:50.711 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:51:50.714 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:51:50.733 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:51:50.763 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:51:50.773 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:51:50.776 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:51:50.875 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****yrtg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****0229"
    }
  ],
  "ActivityId": "0HL9VSNFLUA98:00000006",
  "TimeStamp": "2017-12-10T15:51:50Z",
  "ProcessId": 10420,
  "LocalIpAddress": "127.0.0.1:17700",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:51:50.881 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqcThsZtjzo_jaT4U68XNGMyIXTTzs8qHkJ9m3S-jhs6s2Z2D1_cJylW8s-Z6X_vywfNB_2UFhOlvz3IbCEv2o8RMNE92vKA1R3Yp5IRpyp_kYsA8rUndC_8Ne_FYIl1uYTVkUEYVXRYG7VnIUaHVE_m0mcYNanxjRtx-Z-IC6PlHLGX0bqWpjs64yz7Rk5BzZBtrSe_BWQ-y8YpBmheoNFAy5XJvkXi7BhNqMFaK2gUNdcgD-IlbwTZEnbfqTDz2QTpspO5fLXO4PqFTrzTaqmk6ltBnG8SE5MMGeXh9FkykQuN8T5Vr61GWHcVKRH95k4",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:51:51.108 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:51:51.111 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:51:51.111 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:51:51.120 +01:00 [DBG] Start token request.
2017-12-10 16:51:51.125 +01:00 [DBG] Start client validation
2017-12-10 16:51:51.130 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:51:51.133 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:51:51.133 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:51:51.133 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:51:51.142 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:51:51.142 +01:00 [DBG] Client validation success
2017-12-10 16:51:51.147 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VSNFLUA98:00000007",
  "TimeStamp": "2017-12-10T15:51:51Z",
  "ProcessId": 10420,
  "LocalIpAddress": "127.0.0.1:17700",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:51:51.154 +01:00 [DBG] Start token request validation
2017-12-10 16:51:51.164 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:51:51.193 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:51:51.193 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:51:51.200 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "4936551d447a1ecc139e56e706c80ed07cf4ae4010559beb95281f7e1bd70229",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "4936551d447a1ecc139e56e706c80ed07cf4ae4010559beb95281f7e1bd70229",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:51:51.223 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:51:51.224 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:51:51.226 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:51:51.227 +01:00 [DBG] Issued claims: []
2017-12-10 16:51:51.235 +01:00 [DBG] Creating refresh token
2017-12-10 16:51:51.235 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:51:51.250 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:51:51.250 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:51:51.255 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****FJcw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****1a03"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****_B1g"
    }
  ],
  "ActivityId": "0HL9VSNFLUA98:00000007",
  "TimeStamp": "2017-12-10T15:51:51Z",
  "ProcessId": 10420,
  "LocalIpAddress": "127.0.0.1:17700",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:51:51.258 +01:00 [DBG] Token request success.
2017-12-10 16:51:51.291 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:51:51.293 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:51:51.293 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:51:51.300 +01:00 [DBG] Start userinfo request
2017-12-10 16:51:51.304 +01:00 [DBG] Bearer token found in header
2017-12-10 16:51:51.361 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:51:51.365 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512921111,
    "exp": 1512922911,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:51:51.367 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:51:51.372 +01:00 [DBG] Creating userinfo response
2017-12-10 16:51:51.376 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:51:51.379 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:51:51.379 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:51:51.380 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:51:51.380 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:51:51.382 +01:00 [DBG] End userinfo request
2017-12-10 16:52:34.603 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 16:52:34.660 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 16:52:34.664 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 16:52:34.664 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 16:52:34.665 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 16:52:34.665 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 16:52:51.078 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 16:52:51.087 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 16:52:51.088 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 16:52:51.093 +01:00 [DBG] Start discovery request
2017-12-10 16:52:51.437 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 16:52:51.439 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 16:52:51.442 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 16:52:51.451 +01:00 [DBG] Start key discovery request
2017-12-10 16:52:51.574 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:52:51.577 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:52:51.591 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 16:52:51.596 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 16:52:51.596 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 16:52:51.601 +01:00 [DBG] Start authorize request
2017-12-10 16:52:51.615 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:52:51.620 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:52:51.632 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:52:51.633 +01:00 [DBG] No PKCE used.
2017-12-10 16:52:51.667 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:52:51.682 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdPFh0XGH8VII5g1FFhslzQprIY5LVe2m5Ye0jPD2FNy5oDK4VW3C2AEsrFuwsUDh7hIF24Ig2cUppoM0WWS9kqfikYr5luvum9pHcUKnUQoUy8WOK4NnSyd0hrzEdAfa8CPBK_d8y2Yf2oLPmGN0RYNfj7SzOzOnvxlgEuVPcH6EDC-Am1mWWN514oOYjlR6Nuv-hus8PueFeFvTZGOgx6fvLqzT76raW62E8z6nLpTdQFkiIqcg9DZUIfxzHEvq3CDyAPzc0y_lgSiPK8iML1cTlScqLLNfbObv7pMnVwjL4KSSGDNV1-d1m9DoEFjho",
  "Nonce": "636485179715085630.YTQ1YWVkOGItYjY5YS00MTM2LTgxZGYtMzE5MGM2MzA5NjQ4NDRiYzRjOTctZTYxMC00NGFkLTkyMzQtZjVhZjAxOGIxOWZk",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485179715085630.YTQ1YWVkOGItYjY5YS00MTM2LTgxZGYtMzE5MGM2MzA5NjQ4NDRiYzRjOTctZTYxMC00NGFkLTkyMzQtZjVhZjAxOGIxOWZk",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdPFh0XGH8VII5g1FFhslzQprIY5LVe2m5Ye0jPD2FNy5oDK4VW3C2AEsrFuwsUDh7hIF24Ig2cUppoM0WWS9kqfikYr5luvum9pHcUKnUQoUy8WOK4NnSyd0hrzEdAfa8CPBK_d8y2Yf2oLPmGN0RYNfj7SzOzOnvxlgEuVPcH6EDC-Am1mWWN514oOYjlR6Nuv-hus8PueFeFvTZGOgx6fvLqzT76raW62E8z6nLpTdQFkiIqcg9DZUIfxzHEvq3CDyAPzc0y_lgSiPK8iML1cTlScqLLNfbObv7pMnVwjL4KSSGDNV1-d1m9DoEFjho",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:52:51.696 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:52:51.703 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:52:51.704 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 16:52:51.717 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:52:51.718 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:52:52.116 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:52:52.117 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:52:52.117 +01:00 [DBG] No PKCE used.
2017-12-10 16:52:52.117 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:52:57.509 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 16:52:57.510 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:52:57.512 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:52:57.644 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:52:57.644 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:52:57.644 +01:00 [DBG] No PKCE used.
2017-12-10 16:52:57.644 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:52:57.680 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:52:57.681 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 16:52:57.683 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 16:52:57.684 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 16:52:57.684 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 16:52:57.691 +01:00 [DBG] Start authorize callback request
2017-12-10 16:52:57.721 +01:00 [DBG] User in authorize request: 818727
2017-12-10 16:52:57.721 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 16:52:57.721 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 16:52:57.721 +01:00 [DBG] No PKCE used.
2017-12-10 16:52:57.721 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 16:52:57.722 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdPFh0XGH8VII5g1FFhslzQprIY5LVe2m5Ye0jPD2FNy5oDK4VW3C2AEsrFuwsUDh7hIF24Ig2cUppoM0WWS9kqfikYr5luvum9pHcUKnUQoUy8WOK4NnSyd0hrzEdAfa8CPBK_d8y2Yf2oLPmGN0RYNfj7SzOzOnvxlgEuVPcH6EDC-Am1mWWN514oOYjlR6Nuv-hus8PueFeFvTZGOgx6fvLqzT76raW62E8z6nLpTdQFkiIqcg9DZUIfxzHEvq3CDyAPzc0y_lgSiPK8iML1cTlScqLLNfbObv7pMnVwjL4KSSGDNV1-d1m9DoEFjho",
  "Nonce": "636485179715085630.YTQ1YWVkOGItYjY5YS00MTM2LTgxZGYtMzE5MGM2MzA5NjQ4NDRiYzRjOTctZTYxMC00NGFkLTkyMzQtZjVhZjAxOGIxOWZk",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485179715085630.YTQ1YWVkOGItYjY5YS00MTM2LTgxZGYtMzE5MGM2MzA5NjQ4NDRiYzRjOTctZTYxMC00NGFkLTkyMzQtZjVhZjAxOGIxOWZk",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdPFh0XGH8VII5g1FFhslzQprIY5LVe2m5Ye0jPD2FNy5oDK4VW3C2AEsrFuwsUDh7hIF24Ig2cUppoM0WWS9kqfikYr5luvum9pHcUKnUQoUy8WOK4NnSyd0hrzEdAfa8CPBK_d8y2Yf2oLPmGN0RYNfj7SzOzOnvxlgEuVPcH6EDC-Am1mWWN514oOYjlR6Nuv-hus8PueFeFvTZGOgx6fvLqzT76raW62E8z6nLpTdQFkiIqcg9DZUIfxzHEvq3CDyAPzc0y_lgSiPK8iML1cTlScqLLNfbObv7pMnVwjL4KSSGDNV1-d1m9DoEFjho",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 16:52:57.725 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 16:52:57.725 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 16:52:57.735 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:52:57.747 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 16:52:57.750 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 16:52:57.769 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 16:52:57.797 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 16:52:57.806 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:52:57.808 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:52:57.913 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****wbRw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****cd30"
    }
  ],
  "ActivityId": "0HL9VSO40DNP1:00000006",
  "TimeStamp": "2017-12-10T15:52:57Z",
  "ProcessId": 11400,
  "LocalIpAddress": "127.0.0.1:11915",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:52:57.919 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqdPFh0XGH8VII5g1FFhslzQprIY5LVe2m5Ye0jPD2FNy5oDK4VW3C2AEsrFuwsUDh7hIF24Ig2cUppoM0WWS9kqfikYr5luvum9pHcUKnUQoUy8WOK4NnSyd0hrzEdAfa8CPBK_d8y2Yf2oLPmGN0RYNfj7SzOzOnvxlgEuVPcH6EDC-Am1mWWN514oOYjlR6Nuv-hus8PueFeFvTZGOgx6fvLqzT76raW62E8z6nLpTdQFkiIqcg9DZUIfxzHEvq3CDyAPzc0y_lgSiPK8iML1cTlScqLLNfbObv7pMnVwjL4KSSGDNV1-d1m9DoEFjho",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 16:52:58.146 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 16:52:58.151 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 16:52:58.152 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 16:52:58.160 +01:00 [DBG] Start token request.
2017-12-10 16:52:58.169 +01:00 [DBG] Start client validation
2017-12-10 16:52:58.174 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 16:52:58.178 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 16:52:58.179 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 16:52:58.179 +01:00 [DBG] Secret id found: legacy
2017-12-10 16:52:58.192 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 16:52:58.192 +01:00 [DBG] Client validation success
2017-12-10 16:52:58.199 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VSO40DNP1:00000007",
  "TimeStamp": "2017-12-10T15:52:58Z",
  "ProcessId": 11400,
  "LocalIpAddress": "127.0.0.1:11915",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:52:58.207 +01:00 [DBG] Start token request validation
2017-12-10 16:52:58.221 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 16:52:58.249 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 16:52:58.249 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 16:52:58.256 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "37b38d1053c0245194ed0e7addf6bb4e151ae2d75ce740eeb77e83e8e236cd30",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "37b38d1053c0245194ed0e7addf6bb4e151ae2d75ce740eeb77e83e8e236cd30",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 16:52:58.281 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 16:52:58.282 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 16:52:58.284 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 16:52:58.286 +01:00 [DBG] Issued claims: []
2017-12-10 16:52:58.294 +01:00 [DBG] Creating refresh token
2017-12-10 16:52:58.294 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 16:52:58.308 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 16:52:58.309 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 16:52:58.313 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****LbNw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****fbe0"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****nrOA"
    }
  ],
  "ActivityId": "0HL9VSO40DNP1:00000007",
  "TimeStamp": "2017-12-10T15:52:58Z",
  "ProcessId": 11400,
  "LocalIpAddress": "127.0.0.1:11915",
  "RemoteIpAddress": "::1"
}
2017-12-10 16:52:58.316 +01:00 [DBG] Token request success.
2017-12-10 16:52:58.345 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 16:52:58.346 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 16:52:58.346 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 16:52:58.354 +01:00 [DBG] Start userinfo request
2017-12-10 16:52:58.358 +01:00 [DBG] Bearer token found in header
2017-12-10 16:52:58.415 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 16:52:58.419 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512921178,
    "exp": 1512922978,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 16:52:58.420 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 16:52:58.426 +01:00 [DBG] Creating userinfo response
2017-12-10 16:52:58.430 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 16:52:58.433 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 16:52:58.434 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 16:52:58.434 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 16:52:58.435 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 16:52:58.436 +01:00 [DBG] End userinfo request
2017-12-10 17:04:03.235 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 17:04:03.284 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 17:04:03.287 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 17:04:03.287 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 17:04:03.288 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 17:04:03.288 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 17:04:17.914 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 17:04:17.922 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 17:04:17.922 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 17:04:17.927 +01:00 [DBG] Start discovery request
2017-12-10 17:04:18.262 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 17:04:18.265 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 17:04:18.267 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 17:04:18.274 +01:00 [DBG] Start key discovery request
2017-12-10 17:04:18.402 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:04:18.405 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:04:18.418 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 17:04:18.423 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 17:04:18.423 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 17:04:18.428 +01:00 [DBG] Start authorize request
2017-12-10 17:04:18.444 +01:00 [DBG] User in authorize request: 818727
2017-12-10 17:04:18.450 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:04:18.464 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:04:18.465 +01:00 [DBG] No PKCE used.
2017-12-10 17:04:18.503 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:04:18.517 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeDZsuvNCzMnXEAMDexTvIvs3Cxr4hNPcdwcnWwNMZ2nhw1o5DhbK-pxnYUSFe0CrE3DGI0bjV5joM4VWlahSNvxDi3zRo6rveLUV4eD_Ajh0ryMluab1npsFrpd_rnfRLLibEhlptdY_b9DAbLYg1HgNPt6LwGxvOMlKLERbbDKiW2hKBkUDE30gacMeESEbJ-k1-GlTIlJBeaizWwkU_L4rXxSwEPYOWK0kNfxRbLMmKB2d15vJD7QpLwJxchfBFn4qVvpUndiQtGtgfvVfMk2YqUpQGv8aaLAHeZ6q-7qUvE2SQb54eGo6aBwhYyQvE",
  "Nonce": "636485186583336093.MDI3MWI5YzEtZjE1NC00ODU2LWJlODktM2NkZTc2NDUyMWRlMzMyOWYzNmQtYmI1Ny00MjRkLWE2YmUtMjkyZWMxNGZjZDg5",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485186583336093.MDI3MWI5YzEtZjE1NC00ODU2LWJlODktM2NkZTc2NDUyMWRlMzMyOWYzNmQtYmI1Ny00MjRkLWE2YmUtMjkyZWMxNGZjZDg5",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeDZsuvNCzMnXEAMDexTvIvs3Cxr4hNPcdwcnWwNMZ2nhw1o5DhbK-pxnYUSFe0CrE3DGI0bjV5joM4VWlahSNvxDi3zRo6rveLUV4eD_Ajh0ryMluab1npsFrpd_rnfRLLibEhlptdY_b9DAbLYg1HgNPt6LwGxvOMlKLERbbDKiW2hKBkUDE30gacMeESEbJ-k1-GlTIlJBeaizWwkU_L4rXxSwEPYOWK0kNfxRbLMmKB2d15vJD7QpLwJxchfBFn4qVvpUndiQtGtgfvVfMk2YqUpQGv8aaLAHeZ6q-7qUvE2SQb54eGo6aBwhYyQvE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 17:04:18.529 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 17:04:18.536 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 17:04:18.537 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 17:04:18.550 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:04:18.551 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:04:18.930 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:04:18.931 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:04:18.931 +01:00 [DBG] No PKCE used.
2017-12-10 17:04:18.932 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:04:25.972 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 17:04:25.972 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:04:25.974 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:04:26.097 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:04:26.097 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:04:26.097 +01:00 [DBG] No PKCE used.
2017-12-10 17:04:26.097 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:04:26.133 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:04:26.134 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:04:26.136 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 17:04:26.136 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 17:04:26.136 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 17:04:26.143 +01:00 [DBG] Start authorize callback request
2017-12-10 17:04:26.170 +01:00 [DBG] User in authorize request: 818727
2017-12-10 17:04:26.170 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:04:26.170 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:04:26.170 +01:00 [DBG] No PKCE used.
2017-12-10 17:04:26.170 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:04:26.170 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeDZsuvNCzMnXEAMDexTvIvs3Cxr4hNPcdwcnWwNMZ2nhw1o5DhbK-pxnYUSFe0CrE3DGI0bjV5joM4VWlahSNvxDi3zRo6rveLUV4eD_Ajh0ryMluab1npsFrpd_rnfRLLibEhlptdY_b9DAbLYg1HgNPt6LwGxvOMlKLERbbDKiW2hKBkUDE30gacMeESEbJ-k1-GlTIlJBeaizWwkU_L4rXxSwEPYOWK0kNfxRbLMmKB2d15vJD7QpLwJxchfBFn4qVvpUndiQtGtgfvVfMk2YqUpQGv8aaLAHeZ6q-7qUvE2SQb54eGo6aBwhYyQvE",
  "Nonce": "636485186583336093.MDI3MWI5YzEtZjE1NC00ODU2LWJlODktM2NkZTc2NDUyMWRlMzMyOWYzNmQtYmI1Ny00MjRkLWE2YmUtMjkyZWMxNGZjZDg5",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485186583336093.MDI3MWI5YzEtZjE1NC00ODU2LWJlODktM2NkZTc2NDUyMWRlMzMyOWYzNmQtYmI1Ny00MjRkLWE2YmUtMjkyZWMxNGZjZDg5",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeDZsuvNCzMnXEAMDexTvIvs3Cxr4hNPcdwcnWwNMZ2nhw1o5DhbK-pxnYUSFe0CrE3DGI0bjV5joM4VWlahSNvxDi3zRo6rveLUV4eD_Ajh0ryMluab1npsFrpd_rnfRLLibEhlptdY_b9DAbLYg1HgNPt6LwGxvOMlKLERbbDKiW2hKBkUDE30gacMeESEbJ-k1-GlTIlJBeaizWwkU_L4rXxSwEPYOWK0kNfxRbLMmKB2d15vJD7QpLwJxchfBFn4qVvpUndiQtGtgfvVfMk2YqUpQGv8aaLAHeZ6q-7qUvE2SQb54eGo6aBwhYyQvE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 17:04:26.173 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 17:04:26.174 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 17:04:26.185 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 17:04:26.196 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 17:04:26.199 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 17:04:26.217 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 17:04:26.247 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 17:04:26.256 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 17:04:26.258 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 17:04:26.357 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****CfqA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****200c"
    }
  ],
  "ActivityId": "0HL9VSUH68G7C:00000006",
  "TimeStamp": "2017-12-10T16:04:26Z",
  "ProcessId": 15372,
  "LocalIpAddress": "127.0.0.1:32754",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:04:26.365 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeDZsuvNCzMnXEAMDexTvIvs3Cxr4hNPcdwcnWwNMZ2nhw1o5DhbK-pxnYUSFe0CrE3DGI0bjV5joM4VWlahSNvxDi3zRo6rveLUV4eD_Ajh0ryMluab1npsFrpd_rnfRLLibEhlptdY_b9DAbLYg1HgNPt6LwGxvOMlKLERbbDKiW2hKBkUDE30gacMeESEbJ-k1-GlTIlJBeaizWwkU_L4rXxSwEPYOWK0kNfxRbLMmKB2d15vJD7QpLwJxchfBFn4qVvpUndiQtGtgfvVfMk2YqUpQGv8aaLAHeZ6q-7qUvE2SQb54eGo6aBwhYyQvE",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 17:04:26.581 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 17:04:26.585 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 17:04:26.585 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 17:04:26.594 +01:00 [DBG] Start token request.
2017-12-10 17:04:26.600 +01:00 [DBG] Start client validation
2017-12-10 17:04:26.604 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 17:04:26.607 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 17:04:26.608 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 17:04:26.608 +01:00 [DBG] Secret id found: legacy
2017-12-10 17:04:26.616 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 17:04:26.616 +01:00 [DBG] Client validation success
2017-12-10 17:04:26.621 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VSUH68G7C:00000007",
  "TimeStamp": "2017-12-10T16:04:26Z",
  "ProcessId": 15372,
  "LocalIpAddress": "127.0.0.1:32754",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:04:26.628 +01:00 [DBG] Start token request validation
2017-12-10 17:04:26.637 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 17:04:26.664 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 17:04:26.664 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 17:04:26.669 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "edf74a9fc8798c13d39751b57dc81340bd3844af47c4fa5c1ddf80a54b18200c",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "edf74a9fc8798c13d39751b57dc81340bd3844af47c4fa5c1ddf80a54b18200c",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 17:04:26.692 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 17:04:26.693 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 17:04:26.695 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 17:04:26.696 +01:00 [DBG] Issued claims: []
2017-12-10 17:04:26.704 +01:00 [DBG] Creating refresh token
2017-12-10 17:04:26.704 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 17:04:26.718 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 17:04:26.718 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 17:04:26.724 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****QsyQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****dda1"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****UpOA"
    }
  ],
  "ActivityId": "0HL9VSUH68G7C:00000007",
  "TimeStamp": "2017-12-10T16:04:26Z",
  "ProcessId": 15372,
  "LocalIpAddress": "127.0.0.1:32754",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:04:26.727 +01:00 [DBG] Token request success.
2017-12-10 17:04:26.754 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 17:04:26.756 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 17:04:26.756 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 17:04:26.763 +01:00 [DBG] Start userinfo request
2017-12-10 17:04:26.766 +01:00 [DBG] Bearer token found in header
2017-12-10 17:04:26.824 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 17:04:26.827 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512921866,
    "exp": 1512923666,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 17:04:26.829 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 17:04:26.835 +01:00 [DBG] Creating userinfo response
2017-12-10 17:04:26.840 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 17:04:26.843 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 17:04:26.843 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 17:04:26.844 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 17:04:26.845 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 17:04:26.847 +01:00 [DBG] End userinfo request
2017-12-10 17:09:07.400 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 17:09:07.455 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 17:09:07.459 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 17:09:07.459 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 17:09:07.460 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 17:09:07.460 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 17:09:26.397 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 17:09:26.405 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 17:09:26.405 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 17:09:26.412 +01:00 [DBG] Start discovery request
2017-12-10 17:09:26.747 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 17:09:26.752 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 17:09:26.752 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 17:09:26.758 +01:00 [DBG] Start key discovery request
2017-12-10 17:09:26.877 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:09:26.880 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:09:26.895 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 17:09:26.900 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 17:09:26.900 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 17:09:26.905 +01:00 [DBG] Start authorize request
2017-12-10 17:09:26.919 +01:00 [DBG] User in authorize request: 818727
2017-12-10 17:09:26.924 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:09:26.936 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:09:26.938 +01:00 [DBG] No PKCE used.
2017-12-10 17:09:26.970 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:09:26.983 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqe0IMZazMyTCCZN9OMAIlwv59qFS-nkr7tRa7D6BEwv038B3j3MbBOYoLhrSaXDil8RQTjJlR1QCUmnTmTj0FvMElXfkloVgvI5LNxw2gd1qOjcBE7GrB7sfldfj4Fr9qweqdKWzd96MF5-ZuIqJpNlCcpD_9ama86nkfrYptZsLQaqfe_0s_WWjHhWthyq-3SPMjkQ1gyOlcIDwHhmi33tBxV1-ysf4BHd7X6Z9sJIwkqVORzZQqIf23yA4EWQraRM38OyHqgB-0lbkfYymXf73Cz9ZyQpQtBxUpiSPuwuD_w7kcNo-3KCOcyEKiUhU0s",
  "Nonce": "636485189668177783.YzIzMWE2YWItY2JhNy00ZTQ0LTlkZDctMDUyNzRhOGY2MTRkMTEwZmU1YWQtNWMzYy00ZGMyLTg4YzktMThmOWMzZWE4OTQ1",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485189668177783.YzIzMWE2YWItY2JhNy00ZTQ0LTlkZDctMDUyNzRhOGY2MTRkMTEwZmU1YWQtNWMzYy00ZGMyLTg4YzktMThmOWMzZWE4OTQ1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqe0IMZazMyTCCZN9OMAIlwv59qFS-nkr7tRa7D6BEwv038B3j3MbBOYoLhrSaXDil8RQTjJlR1QCUmnTmTj0FvMElXfkloVgvI5LNxw2gd1qOjcBE7GrB7sfldfj4Fr9qweqdKWzd96MF5-ZuIqJpNlCcpD_9ama86nkfrYptZsLQaqfe_0s_WWjHhWthyq-3SPMjkQ1gyOlcIDwHhmi33tBxV1-ysf4BHd7X6Z9sJIwkqVORzZQqIf23yA4EWQraRM38OyHqgB-0lbkfYymXf73Cz9ZyQpQtBxUpiSPuwuD_w7kcNo-3KCOcyEKiUhU0s",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 17:09:26.996 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 17:09:27.007 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 17:09:27.007 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 17:09:27.021 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:09:27.024 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:09:27.403 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:09:27.405 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:09:27.405 +01:00 [DBG] No PKCE used.
2017-12-10 17:09:27.405 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:10:26.065 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 17:10:26.065 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:10:26.066 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:10:26.201 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:10:26.201 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:10:26.201 +01:00 [DBG] No PKCE used.
2017-12-10 17:10:26.201 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:10:26.236 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:10:26.237 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:10:26.238 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 17:10:26.239 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 17:10:26.239 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 17:10:26.246 +01:00 [DBG] Start authorize callback request
2017-12-10 17:10:26.272 +01:00 [DBG] User in authorize request: 818727
2017-12-10 17:10:26.272 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:10:26.272 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:10:26.272 +01:00 [DBG] No PKCE used.
2017-12-10 17:10:26.272 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:10:26.272 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqe0IMZazMyTCCZN9OMAIlwv59qFS-nkr7tRa7D6BEwv038B3j3MbBOYoLhrSaXDil8RQTjJlR1QCUmnTmTj0FvMElXfkloVgvI5LNxw2gd1qOjcBE7GrB7sfldfj4Fr9qweqdKWzd96MF5-ZuIqJpNlCcpD_9ama86nkfrYptZsLQaqfe_0s_WWjHhWthyq-3SPMjkQ1gyOlcIDwHhmi33tBxV1-ysf4BHd7X6Z9sJIwkqVORzZQqIf23yA4EWQraRM38OyHqgB-0lbkfYymXf73Cz9ZyQpQtBxUpiSPuwuD_w7kcNo-3KCOcyEKiUhU0s",
  "Nonce": "636485189668177783.YzIzMWE2YWItY2JhNy00ZTQ0LTlkZDctMDUyNzRhOGY2MTRkMTEwZmU1YWQtNWMzYy00ZGMyLTg4YzktMThmOWMzZWE4OTQ1",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485189668177783.YzIzMWE2YWItY2JhNy00ZTQ0LTlkZDctMDUyNzRhOGY2MTRkMTEwZmU1YWQtNWMzYy00ZGMyLTg4YzktMThmOWMzZWE4OTQ1",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqe0IMZazMyTCCZN9OMAIlwv59qFS-nkr7tRa7D6BEwv038B3j3MbBOYoLhrSaXDil8RQTjJlR1QCUmnTmTj0FvMElXfkloVgvI5LNxw2gd1qOjcBE7GrB7sfldfj4Fr9qweqdKWzd96MF5-ZuIqJpNlCcpD_9ama86nkfrYptZsLQaqfe_0s_WWjHhWthyq-3SPMjkQ1gyOlcIDwHhmi33tBxV1-ysf4BHd7X6Z9sJIwkqVORzZQqIf23yA4EWQraRM38OyHqgB-0lbkfYymXf73Cz9ZyQpQtBxUpiSPuwuD_w7kcNo-3KCOcyEKiUhU0s",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 17:10:26.275 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 17:10:26.275 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 17:10:26.286 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 17:10:26.297 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 17:10:26.300 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 17:10:26.322 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 17:10:26.353 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 17:10:26.362 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 17:10:26.364 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 17:10:26.458 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****45kw"
    },
    {
      "TokenType": "code",
      "TokenValue": "****1a08"
    }
  ],
  "ActivityId": "0HL9VT1BRTG29:00000006",
  "TimeStamp": "2017-12-10T16:10:26Z",
  "ProcessId": 16288,
  "LocalIpAddress": "127.0.0.1:9735",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:10:26.465 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6Cqe0IMZazMyTCCZN9OMAIlwv59qFS-nkr7tRa7D6BEwv038B3j3MbBOYoLhrSaXDil8RQTjJlR1QCUmnTmTj0FvMElXfkloVgvI5LNxw2gd1qOjcBE7GrB7sfldfj4Fr9qweqdKWzd96MF5-ZuIqJpNlCcpD_9ama86nkfrYptZsLQaqfe_0s_WWjHhWthyq-3SPMjkQ1gyOlcIDwHhmi33tBxV1-ysf4BHd7X6Z9sJIwkqVORzZQqIf23yA4EWQraRM38OyHqgB-0lbkfYymXf73Cz9ZyQpQtBxUpiSPuwuD_w7kcNo-3KCOcyEKiUhU0s",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 17:10:26.687 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 17:10:26.691 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 17:10:26.691 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 17:10:26.699 +01:00 [DBG] Start token request.
2017-12-10 17:10:26.705 +01:00 [DBG] Start client validation
2017-12-10 17:10:26.709 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 17:10:26.713 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 17:10:26.713 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 17:10:26.713 +01:00 [DBG] Secret id found: legacy
2017-12-10 17:10:26.723 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 17:10:26.723 +01:00 [DBG] Client validation success
2017-12-10 17:10:26.729 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VT1BRTG29:00000007",
  "TimeStamp": "2017-12-10T16:10:26Z",
  "ProcessId": 16288,
  "LocalIpAddress": "127.0.0.1:9735",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:10:26.737 +01:00 [DBG] Start token request validation
2017-12-10 17:10:26.746 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 17:10:26.774 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 17:10:26.774 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 17:10:26.779 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "417ff823687eeb2d8ec20e86da62df1f853085ec75209a846d045943c19a1a08",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "417ff823687eeb2d8ec20e86da62df1f853085ec75209a846d045943c19a1a08",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 17:10:26.802 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 17:10:26.802 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 17:10:26.804 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 17:10:26.806 +01:00 [DBG] Issued claims: []
2017-12-10 17:10:26.813 +01:00 [DBG] Creating refresh token
2017-12-10 17:10:26.813 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 17:10:26.827 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 17:10:26.827 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 17:10:26.833 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****4zTQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****ca4f"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****G6iQ"
    }
  ],
  "ActivityId": "0HL9VT1BRTG29:00000007",
  "TimeStamp": "2017-12-10T16:10:26Z",
  "ProcessId": 16288,
  "LocalIpAddress": "127.0.0.1:9735",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:10:26.836 +01:00 [DBG] Token request success.
2017-12-10 17:10:26.862 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 17:10:26.863 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 17:10:26.863 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 17:10:26.870 +01:00 [DBG] Start userinfo request
2017-12-10 17:10:26.873 +01:00 [DBG] Bearer token found in header
2017-12-10 17:10:26.928 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 17:10:26.932 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512922226,
    "exp": 1512924026,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 17:10:26.934 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 17:10:26.939 +01:00 [DBG] Creating userinfo response
2017-12-10 17:10:26.943 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 17:10:26.946 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 17:10:26.946 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 17:10:26.947 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 17:10:26.947 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 17:10:26.949 +01:00 [DBG] End userinfo request
2017-12-10 17:11:31.326 +01:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2017-12-10 17:11:31.376 +01:00 [DBG] Using idsrv as default scheme for authentication
2017-12-10 17:11:31.379 +01:00 [DBG] Using idsrv as default scheme for sign-in
2017-12-10 17:11:31.380 +01:00 [DBG] Using idsrv as default scheme for sign-out
2017-12-10 17:11:31.380 +01:00 [DBG] Using idsrv as default scheme for challenge
2017-12-10 17:11:31.380 +01:00 [DBG] Using idsrv as default scheme for forbid
2017-12-10 17:12:05.031 +01:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-12-10 17:12:05.039 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-12-10 17:12:05.039 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-12-10 17:12:05.045 +01:00 [DBG] Start discovery request
2017-12-10 17:12:05.386 +01:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-12-10 17:12:05.392 +01:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-12-10 17:12:05.392 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-12-10 17:12:05.397 +01:00 [DBG] Start key discovery request
2017-12-10 17:12:05.517 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:12:05.520 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:12:05.532 +01:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-12-10 17:12:05.537 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-12-10 17:12:05.537 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-12-10 17:12:05.542 +01:00 [DBG] Start authorize request
2017-12-10 17:12:05.557 +01:00 [DBG] User in authorize request: 818727
2017-12-10 17:12:05.561 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:12:05.573 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:12:05.574 +01:00 [DBG] No PKCE used.
2017-12-10 17:12:05.606 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:12:05.620 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeRkcPHsXbk-Bo8verXJrCNiBHtroehCOtlTE8UFxp13gZOLzAkJXO7QjWhOTlbRKKWb1bmyir1pAX3oeskwdcntUm2OxBdM5rv8tPVCjruhd6lGWBIz_9CA1i1vqfGUskGga__ozP8p4Bs4-SN8RLPKD-hEzYGAVBW2QZ6KZi19blr218jKBHlUhwRiwhgFEC4tanIn5uN6OrkR7YdLY7iHW3JCzqqicmY9fNNmj4uVYS2BWXHKdRc0pAw84LfuEgdY6P1zuYGykFHw8fPewELRjijVfbMVSmrK1ZxovzQGWAKz36MbJgN8JLgt99xXM8",
  "Nonce": "636485191254579086.M2E1NDhhODUtZmZmZS00YWEzLWI0MDUtYmVhOTU1ZjhiMDRiZDdkODM1YmUtMzI5NC00ZDQ0LTliNzAtMTljODViMTYxZWNm",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485191254579086.M2E1NDhhODUtZmZmZS00YWEzLWI0MDUtYmVhOTU1ZjhiMDRiZDdkODM1YmUtMzI5NC00ZDQ0LTliNzAtMTljODViMTYxZWNm",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeRkcPHsXbk-Bo8verXJrCNiBHtroehCOtlTE8UFxp13gZOLzAkJXO7QjWhOTlbRKKWb1bmyir1pAX3oeskwdcntUm2OxBdM5rv8tPVCjruhd6lGWBIz_9CA1i1vqfGUskGga__ozP8p4Bs4-SN8RLPKD-hEzYGAVBW2QZ6KZi19blr218jKBHlUhwRiwhgFEC4tanIn5uN6OrkR7YdLY7iHW3JCzqqicmY9fNNmj4uVYS2BWXHKdRc0pAw84LfuEgdY6P1zuYGykFHw8fPewELRjijVfbMVSmrK1ZxovzQGWAKz36MbJgN8JLgt99xXM8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 17:12:05.633 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 17:12:05.642 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 17:12:05.642 +01:00 [INF] Showing consent: User has not yet consented
2017-12-10 17:12:05.656 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:12:05.658 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:12:06.043 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:12:06.044 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:12:06.044 +01:00 [DBG] No PKCE used.
2017-12-10 17:12:06.044 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:12:12.067 +01:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2017-12-10 17:12:12.067 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:12:12.071 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:12:12.197 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:12:12.197 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:12:12.197 +01:00 [DBG] No PKCE used.
2017-12-10 17:12:12.197 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:12:12.232 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:12:12.234 +01:00 [INF] AuthenticationScheme: idsrv was successfully authenticated.
2017-12-10 17:12:12.235 +01:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-12-10 17:12:12.236 +01:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-12-10 17:12:12.236 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-12-10 17:12:12.243 +01:00 [DBG] Start authorize callback request
2017-12-10 17:12:12.276 +01:00 [DBG] User in authorize request: 818727
2017-12-10 17:12:12.276 +01:00 [DBG] Start authorize request protocol validation
2017-12-10 17:12:12.276 +01:00 [DBG] Checking for PKCE parameters
2017-12-10 17:12:12.277 +01:00 [DBG] No PKCE used.
2017-12-10 17:12:12.277 +01:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-12-10 17:12:12.277 +01:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5001/signin-oidc"
  ],
  "SubjectId": "818727",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeRkcPHsXbk-Bo8verXJrCNiBHtroehCOtlTE8UFxp13gZOLzAkJXO7QjWhOTlbRKKWb1bmyir1pAX3oeskwdcntUm2OxBdM5rv8tPVCjruhd6lGWBIz_9CA1i1vqfGUskGga__ozP8p4Bs4-SN8RLPKD-hEzYGAVBW2QZ6KZi19blr218jKBHlUhwRiwhgFEC4tanIn5uN6OrkR7YdLY7iHW3JCzqqicmY9fNNmj4uVYS2BWXHKdRc0pAw84LfuEgdY6P1zuYGykFHw8fPewELRjijVfbMVSmrK1ZxovzQGWAKz36MbJgN8JLgt99xXM8",
  "Nonce": "636485191254579086.M2E1NDhhODUtZmZmZS00YWEzLWI0MDUtYmVhOTU1ZjhiMDRiZDdkODM1YmUtMzI5NC00ZDQ0LTliNzAtMTljODViMTYxZWNm",
  "SessionId": "2217ea26e4173459356ea9a906b75700",
  "Raw": {
    "client_id": "legacy",
    "redirect_uri": "http://localhost:5001/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636485191254579086.M2E1NDhhODUtZmZmZS00YWEzLWI0MDUtYmVhOTU1ZjhiMDRiZDdkODM1YmUtMzI5NC00ZDQ0LTliNzAtMTljODViMTYxZWNm",
    "state": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeRkcPHsXbk-Bo8verXJrCNiBHtroehCOtlTE8UFxp13gZOLzAkJXO7QjWhOTlbRKKWb1bmyir1pAX3oeskwdcntUm2OxBdM5rv8tPVCjruhd6lGWBIz_9CA1i1vqfGUskGga__ozP8p4Bs4-SN8RLPKD-hEzYGAVBW2QZ6KZi19blr218jKBHlUhwRiwhgFEC4tanIn5uN6OrkR7YdLY7iHW3JCzqqicmY9fNNmj4uVYS2BWXHKdRc0pAw84LfuEgdY6P1zuYGykFHw8fPewELRjijVfbMVSmrK1ZxovzQGWAKz36MbJgN8JLgt99xXM8",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-12-10 17:12:12.280 +01:00 [DBG] IsActive called from: AuthorizeEndpoint
2017-12-10 17:12:12.280 +01:00 [DBG] Scopes contains offline_access, consent is required
2017-12-10 17:12:12.292 +01:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2017-12-10 17:12:12.307 +01:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2017-12-10 17:12:12.310 +01:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 818727
2017-12-10 17:12:12.330 +01:00 [DBG] Creating Hybrid Flow response.
2017-12-10 17:12:12.359 +01:00 [DBG] Creating Implicit Flow response.
2017-12-10 17:12:12.368 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 17:12:12.370 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 17:12:12.464 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "818727",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****CutQ"
    },
    {
      "TokenType": "code",
      "TokenValue": "****bb90"
    }
  ],
  "ActivityId": "0HL9VT2MO9AKN:00000006",
  "TimeStamp": "2017-12-10T16:12:12Z",
  "ProcessId": 17756,
  "LocalIpAddress": "127.0.0.1:20919",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:12:12.471 +01:00 [INF] Authorize endpoint response
{
  "SubjectId": "818727",
  "ClientId": "legacy",
  "RedirectUri": "http://localhost:5001/signin-oidc",
  "State": "CfDJ8N7GEVHWsVFBrUZ8ubS6CqeRkcPHsXbk-Bo8verXJrCNiBHtroehCOtlTE8UFxp13gZOLzAkJXO7QjWhOTlbRKKWb1bmyir1pAX3oeskwdcntUm2OxBdM5rv8tPVCjruhd6lGWBIz_9CA1i1vqfGUskGga__ozP8p4Bs4-SN8RLPKD-hEzYGAVBW2QZ6KZi19blr218jKBHlUhwRiwhgFEC4tanIn5uN6OrkR7YdLY7iHW3JCzqqicmY9fNNmj4uVYS2BWXHKdRc0pAw84LfuEgdY6P1zuYGykFHw8fPewELRjijVfbMVSmrK1ZxovzQGWAKz36MbJgN8JLgt99xXM8",
  "Scope": "openid profile api1 offline_access"
}
2017-12-10 17:12:12.691 +01:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-12-10 17:12:12.696 +01:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-12-10 17:12:12.696 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-12-10 17:12:12.704 +01:00 [DBG] Start token request.
2017-12-10 17:12:12.711 +01:00 [DBG] Start client validation
2017-12-10 17:12:12.715 +01:00 [DBG] Start parsing Basic Authentication secret
2017-12-10 17:12:12.719 +01:00 [DBG] Start parsing for secret in post body
2017-12-10 17:12:12.719 +01:00 [DBG] Parser found secret: PostBodySecretParser
2017-12-10 17:12:12.719 +01:00 [DBG] Secret id found: legacy
2017-12-10 17:12:12.727 +01:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-12-10 17:12:12.728 +01:00 [DBG] Client validation success
2017-12-10 17:12:12.733 +01:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "legacy",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HL9VT2MO9AKN:00000007",
  "TimeStamp": "2017-12-10T16:12:12Z",
  "ProcessId": 17756,
  "LocalIpAddress": "127.0.0.1:20919",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:12:12.740 +01:00 [DBG] Start token request validation
2017-12-10 17:12:12.754 +01:00 [DBG] Start validation of authorization code token request
2017-12-10 17:12:12.781 +01:00 [DBG] IsActive called from: AuthorizationCodeValidation
2017-12-10 17:12:12.781 +01:00 [DBG] Validation of authorization code token request success
2017-12-10 17:12:12.787 +01:00 [INF] Token request validation success
{
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "GrantType": "authorization_code",
  "AuthorizationCode": "7740a472b5715ac973a35fa597b90df82dec5cf189fdaf204ad5c3def819bb90",
  "Raw": {
    "client_id": "legacy",
    "client_secret": "***REDACTED***",
    "code": "7740a472b5715ac973a35fa597b90df82dec5cf189fdaf204ad5c3def819bb90",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5001/signin-oidc"
  }
}
2017-12-10 17:12:12.811 +01:00 [DBG] Getting claims for access token for client: legacy
2017-12-10 17:12:12.811 +01:00 [DBG] Getting claims for access token for subject: 818727
2017-12-10 17:12:12.813 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types [] via ClaimsProviderAccessToken
2017-12-10 17:12:12.814 +01:00 [DBG] Issued claims: []
2017-12-10 17:12:12.822 +01:00 [DBG] Creating refresh token
2017-12-10 17:12:12.822 +01:00 [DBG] Setting an absolute lifetime: 28800
2017-12-10 17:12:12.837 +01:00 [DBG] Getting claims for identity token for subject: 818727 and client: legacy
2017-12-10 17:12:12.837 +01:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-12-10 17:12:12.842 +01:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "legacy",
  "ClientName": "Legacy MVC Client (Angular 1.X)",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****mAUw"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****6290"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****7CNQ"
    }
  ],
  "ActivityId": "0HL9VT2MO9AKN:00000007",
  "TimeStamp": "2017-12-10T16:12:12Z",
  "ProcessId": 17756,
  "LocalIpAddress": "127.0.0.1:20919",
  "RemoteIpAddress": "::1"
}
2017-12-10 17:12:12.844 +01:00 [DBG] Token request success.
2017-12-10 17:12:12.874 +01:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-12-10 17:12:12.876 +01:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-12-10 17:12:12.877 +01:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-12-10 17:12:12.885 +01:00 [DBG] Start userinfo request
2017-12-10 17:12:12.889 +01:00 [DBG] Bearer token found in header
2017-12-10 17:12:12.947 +01:00 [DBG] IsActive called from: AccessTokenValidation
2017-12-10 17:12:12.951 +01:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1512922332,
    "exp": 1512924132,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "legacy",
    "sub": "818727",
    "auth_time": 1512918331,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2017-12-10 17:12:12.953 +01:00 [DBG] IsActive called from: UserInfoRequestValidation
2017-12-10 17:12:12.959 +01:00 [DBG] Creating userinfo response
2017-12-10 17:12:12.963 +01:00 [DBG] Scopes in access token: openid profile api1 offline_access
2017-12-10 17:12:12.967 +01:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2017-12-10 17:12:12.967 +01:00 [DBG] Get profile called for subject 818727 from client Legacy MVC Client (Angular 1.X) with claim types ["sub","name","family_name","given_name","middle_name","nickname","preferred_username","profile","picture","website","gender","birthdate","zoneinfo","locale","updated_at"] via UserInfoEndpoint
2017-12-10 17:12:12.968 +01:00 [DBG] Issued claims: ["sub"]
2017-12-10 17:12:12.968 +01:00 [INF] Profile service returned to the following claim types: sub
2017-12-10 17:12:12.970 +01:00 [DBG] End userinfo request
